2026-01-22T15:32:57.568+09:00  INFO 25872 --- [main] c.i.backend.BackendApplication           : Starting BackendApplication using Java 17.0.17 with PID 25872 (C:\InnerSignature\backend\target\classes started by owner in C:\InnerSignature\backend)
2026-01-22T15:32:57.769+09:00 DEBUG 25872 --- [main] c.i.backend.BackendApplication           : Running with Spring Boot v3.5.8, Spring v6.2.14
2026-01-22T15:32:57.813+09:00  INFO 25872 --- [main] c.i.backend.BackendApplication           : The following 1 profile is active: "dev"
2026-01-22T15:33:01.675+09:00 DEBUG 25872 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Searching for mappers annotated with @Mapper
2026-01-22T15:33:01.732+09:00 DEBUG 25872 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Using auto-configuration base package 'com.innersignature.backend'
2026-01-22T15:33:02.459+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AccountCodeMappingMapper.class]
2026-01-22T15:33:02.478+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AuditLogMapper.class]
2026-01-22T15:33:02.500+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AuditRuleMapper.class]
2026-01-22T15:33:02.563+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\BudgetMapper.class]
2026-01-22T15:33:02.631+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CompanyCardMapper.class]
2026-01-22T15:33:02.675+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CompanyMapper.class]
2026-01-22T15:33:02.765+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CreditMapper.class]
2026-01-22T15:33:02.801+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\ExpenseCategoryMapper.class]
2026-01-22T15:33:02.823+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\ExpenseMapper.class]
2026-01-22T15:33:02.840+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\MonthlyClosingMapper.class]
2026-01-22T15:33:02.880+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\PasswordResetTokenMapper.class]
2026-01-22T15:33:02.917+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\PaymentMapper.class]
2026-01-22T15:33:02.979+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\SubscriptionMapper.class]
2026-01-22T15:33:03.013+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\SubscriptionPlanMapper.class]
2026-01-22T15:33:03.044+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserApproverMapper.class]
2026-01-22T15:33:03.084+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserCardMapper.class]
2026-01-22T15:33:03.111+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserMapper.class]
2026-01-22T15:33:03.135+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserSignatureMapper.class]
2026-01-22T15:33:03.202+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'accountCodeMappingMapper' and 'com.innersignature.backend.mapper.AccountCodeMappingMapper' mapperInterface
2026-01-22T15:33:03.218+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'auditLogMapper' and 'com.innersignature.backend.mapper.AuditLogMapper' mapperInterface
2026-01-22T15:33:03.235+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'auditRuleMapper' and 'com.innersignature.backend.mapper.AuditRuleMapper' mapperInterface
2026-01-22T15:33:03.248+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'budgetMapper' and 'com.innersignature.backend.mapper.BudgetMapper' mapperInterface
2026-01-22T15:33:03.265+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'companyCardMapper' and 'com.innersignature.backend.mapper.CompanyCardMapper' mapperInterface
2026-01-22T15:33:03.350+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'companyMapper' and 'com.innersignature.backend.mapper.CompanyMapper' mapperInterface
2026-01-22T15:33:03.368+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'creditMapper' and 'com.innersignature.backend.mapper.CreditMapper' mapperInterface
2026-01-22T15:33:03.382+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'expenseCategoryMapper' and 'com.innersignature.backend.mapper.ExpenseCategoryMapper' mapperInterface
2026-01-22T15:33:03.465+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'expenseMapper' and 'com.innersignature.backend.mapper.ExpenseMapper' mapperInterface
2026-01-22T15:33:03.558+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'monthlyClosingMapper' and 'com.innersignature.backend.mapper.MonthlyClosingMapper' mapperInterface
2026-01-22T15:33:03.619+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'passwordResetTokenMapper' and 'com.innersignature.backend.mapper.PasswordResetTokenMapper' mapperInterface
2026-01-22T15:33:03.658+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'paymentMapper' and 'com.innersignature.backend.mapper.PaymentMapper' mapperInterface
2026-01-22T15:33:03.707+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'subscriptionMapper' and 'com.innersignature.backend.mapper.SubscriptionMapper' mapperInterface
2026-01-22T15:33:03.794+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'subscriptionPlanMapper' and 'com.innersignature.backend.mapper.SubscriptionPlanMapper' mapperInterface
2026-01-22T15:33:03.846+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userApproverMapper' and 'com.innersignature.backend.mapper.UserApproverMapper' mapperInterface
2026-01-22T15:33:03.891+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userCardMapper' and 'com.innersignature.backend.mapper.UserCardMapper' mapperInterface
2026-01-22T15:33:03.950+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userMapper' and 'com.innersignature.backend.mapper.UserMapper' mapperInterface
2026-01-22T15:33:03.992+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userSignatureMapper' and 'com.innersignature.backend.mapper.UserSignatureMapper' mapperInterface
2026-01-22T15:33:05.610+09:00  INFO 25872 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-22T15:33:05.704+09:00  INFO 25872 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-22T15:33:05.784+09:00  INFO 25872 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.49]
2026-01-22T15:33:06.073+09:00  INFO 25872 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-22T15:33:06.132+09:00  INFO 25872 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 8122 ms
2026-01-22T15:33:06.411+09:00 DEBUG 25872 --- [main] c.i.b.security.JwtAuthenticationFilter   : Filter 'jwtAuthenticationFilter' configured for use
2026-01-22T15:33:06.496+09:00 DEBUG 25872 --- [main] c.i.backend.security.RateLimitFilter     : Filter 'rateLimitFilter' configured for use
2026-01-22T15:33:17.314+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AccountCodeMappingMapper.xml]'
2026-01-22T15:33:17.443+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AuditLogMapper.xml]'
2026-01-22T15:33:17.486+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AuditRuleMapper.xml]'
2026-01-22T15:33:17.545+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\BudgetMapper.xml]'
2026-01-22T15:33:17.587+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CompanyCardMapper.xml]'
2026-01-22T15:33:17.667+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CompanyMapper.xml]'
2026-01-22T15:33:17.855+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CreditMapper.xml]'
2026-01-22T15:33:17.900+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\ExpenseCategoryMapper.xml]'
2026-01-22T15:33:18.068+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\ExpenseMapper.xml]'
2026-01-22T15:33:18.177+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\MonthlyClosingMapper.xml]'
2026-01-22T15:33:18.199+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\PasswordResetTokenMapper.xml]'
2026-01-22T15:33:18.280+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\PaymentMapper.xml]'
2026-01-22T15:33:18.316+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\SubscriptionMapper.xml]'
2026-01-22T15:33:18.380+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\SubscriptionPlanMapper.xml]'
2026-01-22T15:33:18.439+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserApproverMapper.xml]'
2026-01-22T15:33:18.505+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserCardMapper.xml]'
2026-01-22T15:33:18.551+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserMappeer.xml]'
2026-01-22T15:33:18.567+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserSignatureMapper.xml]'
2026-01-22T15:33:21.086+09:00 DEBUG 25872 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 162 mappings in 'requestMappingHandlerMapping'
2026-01-22T15:33:21.474+09:00 DEBUG 25872 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**, /api/uploads/**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2026-01-22T15:33:21.596+09:00  WARN 25872 --- [main] .s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: 9bf87a73-0722-45a8-8c6d-852a727f853e

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-01-22T15:33:21.815+09:00  INFO 25872 --- [main] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2026-01-22T15:33:22.227+09:00 DEBUG 25872 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RateLimitFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-22T15:33:22.737+09:00 DEBUG 25872 --- [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2026-01-22T15:33:22.928+09:00 DEBUG 25872 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2026-01-22T15:33:22.976+09:00 DEBUG 25872 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2026-01-22T15:33:23.756+09:00  INFO 25872 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-22T15:33:23.776+09:00  INFO 25872 --- [main] c.i.backend.BackendApplication           : Started BackendApplication in 28.383 seconds (process running for 29.471)
2026-01-22T15:34:02.660+09:00  INFO 25872 --- [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-22T15:34:02.662+09:00  INFO 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-22T15:34:02.663+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected StandardServletMultipartResolver
2026-01-22T15:34:02.663+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected AcceptHeaderLocaleResolver
2026-01-22T15:34:02.663+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected FixedThemeResolver
2026-01-22T15:34:02.665+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@3ea84e01
2026-01-22T15:34:02.665+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.support.SessionFlashMapManager@51f34185
2026-01-22T15:34:02.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2026-01-22T15:34:02.679+09:00  INFO 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 16 ms
2026-01-22T15:34:02.708+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/login
2026-01-22T15:34:02.761+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing POST /api/login
2026-01-22T15:34:02.768+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-22T15:34:02.780+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured POST /api/login
2026-01-22T15:34:02.783+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : POST "/api/login", parameters={}
2026-01-22T15:34:02.786+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#login(LoginRequest)
2026-01-22T15:34:02.883+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [UserController.LoginRequest(username=test_tax, password=1234)]
2026-01-22T15:34:02.916+09:00  INFO 25872 --- [http-nio-8080-exec-2] c.i.backend.controller.UserController    : 로그인 시도 - username: test_tax
2026-01-22T15:34:02.930+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:02.939+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35207340] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:02.973+09:00  INFO 25872 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-22T15:34:03.459+09:00  INFO 25872 --- [http-nio-8080-exec-2] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@64472107
2026-01-22T15:34:03.473+09:00  INFO 25872 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-22T15:34:03.481+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1264106381 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:03.499+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.findByUsername   : ==>  Preparing: SELECT * FROM user_tb WHERE username = ?
2026-01-22T15:34:03.543+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.findByUsername   : ==> Parameters: test_tax(String)
2026-01-22T15:34:03.656+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.findByUsername   : <==      Total: 1
2026-01-22T15:34:03.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35207340]
2026-01-22T15:34:03.794+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:03.795+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64f017d5] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:03.796+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@724818959 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:03.796+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:03.799+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:03.844+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:03.845+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64f017d5]
2026-01-22T15:34:04.010+09:00  INFO 25872 --- [http-nio-8080-exec-2] c.i.backend.controller.UserController    : 로그인 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1
2026-01-22T15:34:04.014+09:00  INFO 25872 --- [http-nio-8080-exec-2] SECURITY                                 : LOGIN_SUCCESS userId=12 username=test_tax role=TAX_ACCOUNTANT
2026-01-22T15:34:04.032+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:04.060+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=로그인 성공, data={user=UserDto(userId=12, username=test_tax, password= (truncated)...]
2026-01-22T15:34:04.091+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:04.813+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/companies
2026-01-22T15:34:04.827+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/companies
2026-01-22T15:34:04.932+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/companies
2026-01-22T15:34:04.961+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/companies
2026-01-22T15:34:04.962+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/companies", parameters={}
2026-01-22T15:34:05.031+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.CompanyController#getMyCompanies()
2026-01-22T15:34:05.120+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:05.128+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ee2e7c9] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:05.134+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1716332981 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:05.137+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.U.findCompaniesByUserId          : ==>  Preparing: SELECT c.company_id AS companyId, c.company_code AS companyCode, c.company_name AS companyName, c.business_reg_no AS businessRegNo, c.representative_name AS representativeName, c.created_by AS createdBy, c.is_active AS isActive, c.created_at AS createdAt, c.updated_at AS updatedAt FROM company_tb c INNER JOIN user_company_tb uc ON c.company_id = uc.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' AND c.is_active = 1 ORDER BY uc.is_primary DESC, c.created_at DESC
2026-01-22T15:34:05.140+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.U.findCompaniesByUserId          : ==> Parameters: 12(Long)
2026-01-22T15:34:05.227+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.U.findCompaniesByUserId          : <==      Total: 2
2026-01-22T15:34:05.234+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ee2e7c9]
2026-01-22T15:34:05.256+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:05.262+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ApiResponse(success=true, message=조회 성공, data=[CompanyDto(companyId=1, companyCode=2C4PSB, companyNa (truncated)...]
2026-01-22T15:34:05.323+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:07.177+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:34:07.184+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:34:07.191+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.194+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.197+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:07.205+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.279+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.347+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:34:07.410+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.427+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.444+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:07.490+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.499+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.499+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:34:07.567+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.569+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:07.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:34:07.602+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:07.608+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.609+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.622+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.625+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:07.699+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:34:07.799+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:07.834+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:07.847+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:34:07.860+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:07.864+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.865+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:34:07.884+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:07.884+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.885+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.885+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:07.888+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:07.916+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:34:07.917+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:07.929+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:07.930+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:07.932+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:07.934+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:07.934+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.935+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:07.942+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:07.962+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.950+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:34:07.951+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b8480c2] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:07.951+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.959+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.968+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.968+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.968+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.067+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@976996010 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:08.078+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:08.098+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:08.100+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.101+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.112+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21fdae06] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.247+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:34:08.344+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43c17308] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51b9d4e1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.401+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@119ffe1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.426+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:34:08.474+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@457ffcca] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.482+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1425764538 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:08.530+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1057382628 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:08.545+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:08.545+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:08.548+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@974037527 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:08.548+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@876148982 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:08.566+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:08.578+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:08.578+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:08.579+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:08.592+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:08.604+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:08.622+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:08.668+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:08.684+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21fdae06]
2026-01-22T15:34:08.747+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@119ffe1]
2026-01-22T15:34:08.693+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1932789747 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:08.731+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:34:08.732+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:08.748+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.748+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:08.749+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.749+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b8480c2]
2026-01-22T15:34:08.749+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43c17308]
2026-01-22T15:34:08.750+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@719dbeef] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.755+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:08.755+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@602ca72] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.778+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:08.778+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:08.779+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1779977217 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:08.783+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:34:08.785+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:08.791+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:08.793+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:08.794+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:08.809+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:08.814+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:08.822+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1098411971 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:08.829+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:34:08.833+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:08.852+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:08.977+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@719dbeef]
2026-01-22T15:34:08.857+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:08.860+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51b9d4e1]
2026-01-22T15:34:08.861+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:08.941+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:34:08.964+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:08.979+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.981+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@457ffcca]
2026-01-22T15:34:08.982+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:08.983+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:08.983+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:34:08.984+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:08.985+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e55f5d9] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.988+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:08.988+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:08.989+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:34:08.989+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:08.992+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@849566778 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:08.997+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.019+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:34:09.025+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:09.028+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:09.116+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:09.150+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:09.158+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.162+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.168+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.168+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:09.172+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@602ca72]
2026-01-22T15:34:09.174+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d7caa43] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.177+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.183+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:09.198+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.199+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:09.200+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@867914652 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:09.201+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.210+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:09.212+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:09.213+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:09.217+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:34:09.218+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@272e7170] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.232+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.248+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:09.285+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:09.264+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:09.281+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:34:09.283+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:09.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:09.313+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:09.347+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@931238584 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:09.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:09.378+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:09.381+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:34:09.382+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:09.382+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.382+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:09.383+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e55f5d9]
2026-01-22T15:34:09.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:09.385+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d7caa43]
2026-01-22T15:34:09.392+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.392+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.394+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.394+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:09.394+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:09.394+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.395+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.398+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.401+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@12cf536e] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.402+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:09.402+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:34:09.428+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.432+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31506555] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.432+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@516097703 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:09.434+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:09.443+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.478+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.483+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a763417] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.518+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1420939561 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:09.485+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1394101839 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:09.496+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:09.513+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@272e7170]
2026-01-22T15:34:09.514+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.516+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:34:09.529+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:09.530+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:09.531+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:09.531+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.531+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.535+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:34:09.549+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:09.555+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:09.564+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:09.564+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b7d3ab5] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.567+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:34:09.569+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:34:09.573+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:34:09.582+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43bec729] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.599+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1904562629 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:09.600+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:09.601+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:09.601+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:09.621+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1520372575 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:09.633+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:09.634+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31506555]
2026-01-22T15:34:09.639+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@12cf536e]
2026-01-22T15:34:09.646+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a763417]
2026-01-22T15:34:09.649+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:34:09.697+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:09.697+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.698+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.699+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.759+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:34:09.826+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:09.818+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:09.823+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@516b18f1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.827+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.848+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.850+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1152076206 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:09.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:09.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:34:09.981+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b7d3ab5]
2026-01-22T15:34:09.977+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:09.981+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43bec729]
2026-01-22T15:34:09.981+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.984+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:09.992+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.998+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@263ded26] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.026+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:34:10.035+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:10.044+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@100206016 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:10.046+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:10.049+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@516b18f1]
2026-01-22T15:34:10.062+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:10.074+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.090+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:10.090+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@418ae2d1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.110+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@521215156 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:10.139+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:10.148+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:10.167+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:10.184+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@263ded26]
2026-01-22T15:34:10.193+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:10.218+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:10.230+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:10.233+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@418ae2d1]
2026-01-22T15:34:10.235+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.252+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20e2cba4] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.235+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:10.260+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@921188611 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:10.275+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:10.283+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:10.314+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:10.315+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20e2cba4]
2026-01-22T15:34:10.321+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:10.367+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:34:10.428+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:10.460+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.534+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.534+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.535+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:10.540+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.550+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:34:10.581+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:10.562+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:10.563+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:10.580+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:10.581+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.582+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.584+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.585+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.585+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:10.591+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:10.594+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:10.592+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:10.593+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:10.593+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:10.594+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:34:10.594+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:10.647+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:10.677+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:10.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:10.676+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.678+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.678+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.679+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.696+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.697+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a6a6e42] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.697+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.697+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.698+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.698+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.718+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.718+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@728659a7] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.724+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.764+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@714954686 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:10.781+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.791+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@28a616ca] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.791+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5857cb4d] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.809+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:10.810+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5dcdb237] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.812+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:10.818+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@313108200 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:10.830+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:10.831+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@165927091 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:10.832+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1826458914 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:10.841+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:10.843+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:10.845+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:10.848+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1335373489 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:10.848+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:10.853+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:10.900+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:10.899+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:10.900+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a6a6e42]
2026-01-22T15:34:10.902+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:10.906+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:11.034+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:11.111+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@728659a7]
2026-01-22T15:34:11.034+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:11.098+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.112+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@28a616ca]
2026-01-22T15:34:11.111+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5857cb4d]
2026-01-22T15:34:11.112+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.111+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.112+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@647d0261] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.113+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.113+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:11.114+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f71ef90] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.180+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@853749031 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:11.181+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:11.182+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:11.193+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.193+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1227274706 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:11.194+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:11.195+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5dcdb237]
2026-01-22T15:34:11.197+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.199+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:11.201+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:11.232+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.234+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.234+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.262+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:11.277+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:11.311+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:11.315+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:11.316+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:11.318+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.331+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@647d0261]
2026-01-22T15:34:11.332+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.334+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.335+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:11.343+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:11.346+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:11.346+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cae682b] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.347+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:11.347+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1884029909 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:11.349+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.349+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.349+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:11.350+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.350+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.353+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:11.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b540310] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.367+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.368+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b8ac664] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.368+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1901397639 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:11.389+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:11.432+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.444+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:11.475+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cae682b]
2026-01-22T15:34:11.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:11.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f71ef90]
2026-01-22T15:34:11.476+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.477+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:11.477+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:11.477+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.495+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@337577346 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:11.512+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3462c54d] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.549+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.564+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:11.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:11.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@998378714 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:11.571+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:11.566+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:11.567+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.569+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:11.572+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:11.574+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:11.575+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.576+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.576+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.577+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c33b767] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.577+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@427928135 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:11.577+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:11.579+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:11.583+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:11.584+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b540310]
2026-01-22T15:34:11.584+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.585+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:11.587+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.650+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:11.650+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:11.653+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:11.692+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c33b767]
2026-01-22T15:34:11.692+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3462c54d]
2026-01-22T15:34:11.693+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b8ac664]
2026-01-22T15:34:11.693+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.700+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:11.702+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.751+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.835+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c0defa0] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.784+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.816+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:11.833+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:11.834+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:11.841+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1055332801 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:11.842+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:11.843+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.849+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:11.868+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.874+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.879+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:11.900+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.907+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:11.934+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.968+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:12.010+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:12.050+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:12.054+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:12.088+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:12.117+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:12.181+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:12.326+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.329+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:12.343+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:12.344+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:12.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c0defa0]
2026-01-22T15:34:12.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:12.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:12.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:12.413+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.429+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.431+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50af6cd3] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.432+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39d22038] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.479+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.480+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3e8cb0ec] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.482+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.483+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1169002106 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:12.485+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.534+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.549+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1283365335 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:12.550+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1088578084 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:12.551+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:12.555+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.556+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32aa3fe5] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.579+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:12.580+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:12.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:12.599+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2445ac7e] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.616+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:12.617+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:12.629+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1931740202 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:12.629+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:12.630+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1141923156 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:12.630+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:12.631+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:12.634+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:12.635+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39d22038]
2026-01-22T15:34:12.648+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:12.649+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3e8cb0ec]
2026-01-22T15:34:12.650+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50af6cd3]
2026-01-22T15:34:12.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:12.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.667+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:12.668+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:12.679+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.680+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@30c9d663] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.683+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:12.683+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@608e795e] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.684+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1084034211 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:12.685+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:12.685+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1265391720 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:12.729+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:12.732+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:12.733+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:12.760+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:12.761+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:12.762+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2445ac7e]
2026-01-22T15:34:12.763+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32aa3fe5]
2026-01-22T15:34:12.835+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:12.843+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:12.843+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:12.860+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:12.862+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:12.862+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:12.864+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:12.864+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@30c9d663]
2026-01-22T15:34:12.865+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:12.868+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:12.895+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:12.898+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@608e795e]
2026-01-22T15:34:12.900+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:34:12.930+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:12.945+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:12.962+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:13.014+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:13.016+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:13.054+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:13.065+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:13.069+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:13.072+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:13.079+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:13.081+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:13.082+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:13.082+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b5a01c4] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:13.084+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1245647075 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:13.088+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:13.090+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:13.097+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:13.097+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b5a01c4]
2026-01-22T15:34:13.099+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:13.099+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@186b8e8a] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:13.100+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1040900435 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:13.101+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:13.112+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:13.150+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:13.152+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@186b8e8a]
2026-01-22T15:34:13.154+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:13.157+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:13.159+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:15.868+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:15.938+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:34:15.949+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:16.106+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:16.163+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:34:16.243+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.266+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78f36d5c] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.312+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@159747706 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.317+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:16.326+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:16.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:16.376+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78f36d5c]
2026-01-22T15:34:16.380+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.383+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a8129a1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@798547068 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:16.412+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:16.448+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:16.458+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a8129a1]
2026-01-22T15:34:16.464+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.467+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a82bf7b] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.479+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@968711083 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.495+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:16.512+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:16.539+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:16.550+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a82bf7b]
2026-01-22T15:34:16.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.568+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@138ee5b] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.575+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1579081824 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.595+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:16.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:16.627+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:16.632+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@138ee5b]
2026-01-22T15:34:16.639+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.641+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25749399] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.646+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1668868954 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.667+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:16.682+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:16.776+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:16.793+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25749399]
2026-01-22T15:34:16.817+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.862+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@eaf84b9] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.908+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@605863531 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.934+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:16.966+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:17.032+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:17.036+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@eaf84b9]
2026-01-22T15:34:17.042+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.044+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@688c0174] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.047+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@452250256 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:17.048+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:17.051+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:17.105+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:17.139+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@688c0174]
2026-01-22T15:34:17.140+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:17.198+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:34:17.260+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:17.266+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.275+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:34:17.328+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.330+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.330+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:17.330+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.333+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.359+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:17.361+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:17.361+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:17.362+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:17.362+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.363+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.363+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:17.363+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:17.379+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:34:17.379+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:17.379+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:17.380+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.380+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:17.382+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.382+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:17.398+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:17.398+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:17.401+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:17.410+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f0d2d7a] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.413+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.414+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.414+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:17.415+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.417+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.427+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.427+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.428+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.428+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.433+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.434+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@485651547 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:17.437+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.445+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.445+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2940248f] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.445+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5fa60209] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.451+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:17.455+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@459812c2] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.463+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:17.464+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d2a11c1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.465+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@432941738 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:17.480+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:17.482+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2132145234 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:17.482+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@213804165 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:17.494+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:17.496+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@700013907 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:17.497+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:17.499+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:17.499+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:17.516+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:17.517+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f0d2d7a]
2026-01-22T15:34:17.518+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:17.519+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:17.526+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:17.531+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.534+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:17.551+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79a3524] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.553+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@459812c2]
2026-01-22T15:34:17.555+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:17.560+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5fa60209]
2026-01-22T15:34:17.558+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@969374500 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:17.560+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.561+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:17.561+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:17.562+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@122f7a6d] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.563+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:17.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@388261096 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:17.564+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:17.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:17.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:17.602+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:17.603+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:17.605+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:17.627+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.627+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2940248f]
2026-01-22T15:34:17.628+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d2a11c1]
2026-01-22T15:34:17.630+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:17.678+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:17.679+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:17.684+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:17.694+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:17.696+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79a3524]
2026-01-22T15:34:17.699+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:17.704+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.842+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:17.898+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@122f7a6d]
2026-01-22T15:34:17.910+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.912+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:17.912+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:17.914+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:17.949+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.962+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:17.976+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62c246ea] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.976+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:18.096+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:18.182+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:18.232+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:18.330+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:18.331+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:18.271+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@874998915 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:18.323+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.329+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:18.331+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:18.332+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:18.383+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.390+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:18.392+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:18.395+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:18.398+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:18.415+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:18.417+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:18.417+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:18.425+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:18.443+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@296886ce] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:18.444+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.444+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:18.445+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.474+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.474+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:18.475+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.476+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:18.476+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:18.492+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@138632451 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:18.493+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:18.524+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:18.540+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21048e82] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:18.540+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.541+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:18.541+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62c246ea]
2026-01-22T15:34:18.613+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62f7343] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:18.775+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.811+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1791328297 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:18.848+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:18.897+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:19.083+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1023286174 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:19.100+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:19.165+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:19.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:19.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44d6ee8c] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:19.427+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:19.525+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8f8bce1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:19.622+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:19.732+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@296886ce]
2026-01-22T15:34:19.895+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1000289431 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:19.896+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:20.077+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@625609748 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:20.162+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:20.221+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:20.294+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:20.616+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:20.630+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:20.797+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:20.930+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21048e82]
2026-01-22T15:34:21.173+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:21.294+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:21.424+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62f7343]
2026-01-22T15:34:21.523+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:21.604+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:21.606+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:21.785+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:21.814+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:21.817+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:21.997+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:22.084+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:22.150+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44d6ee8c]
2026-01-22T15:34:22.232+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:22.296+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8f8bce1]
2026-01-22T15:34:22.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:22.442+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:22.444+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:22.508+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:22.591+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:22.608+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:22.632+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:22.634+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2761bae7] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:22.640+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:22.643+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@18a35230] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:22.644+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:22.644+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@196183988 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:22.645+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:22.646+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1845026856 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:22.646+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:22.649+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:22.718+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:22.848+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:23.076+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:23.077+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:22.975+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:23.041+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:23.074+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:23.075+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:23.079+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:23.080+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:23.149+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:23.217+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:23.431+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:23.507+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:23.652+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:23.654+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b6149db] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:23.665+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:23.678+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2761bae7]
2026-01-22T15:34:23.732+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@65eda7e5] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:23.753+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@18a35230]
2026-01-22T15:34:23.754+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:23.763+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:23.776+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@917211896 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:23.781+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@889342034 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:23.792+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:23.799+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:23.810+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@34dce5b2] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:23.810+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:23.810+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:23.811+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:23.812+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:23.812+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1016220681 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:23.831+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:23.832+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:23.833+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:23.845+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:23.880+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59acbd3] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:23.846+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:23.859+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:23.891+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:23.894+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:23.896+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:23.898+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:23.912+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:23.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b6149db]
2026-01-22T15:34:23.938+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:23.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:23.914+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1289372475 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:23.914+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:23.914+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:23.939+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:23.948+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:23.978+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:23.978+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@65eda7e5]
2026-01-22T15:34:23.993+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@34dce5b2]
2026-01-22T15:34:24.001+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:24.001+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:24.004+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:24.018+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:24.018+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:24.032+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:24.032+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:24.048+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77ffb5dc] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:24.049+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d697c43] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:24.050+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@610086884 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:24.050+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:24.057+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:24.064+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:24.067+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59acbd3]
2026-01-22T15:34:24.077+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2113425489 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:24.080+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:24.099+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:24.118+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:24.163+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:24.167+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:24.167+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:24.167+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:24.195+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77ffb5dc]
2026-01-22T15:34:24.212+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:24.229+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:24.229+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d697c43]
2026-01-22T15:34:24.246+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:34:24.246+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:24.247+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1a052d59] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:24.249+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:24.250+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1277588585 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:24.258+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:24.290+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:24.313+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:24.317+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1a052d59]
2026-01-22T15:34:24.327+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:24.334+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:24.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:06.029+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:06.122+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:35:06.233+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:06.362+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:06.450+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:35:06.520+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:06.606+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@41c011e3] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:06.868+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@476235122 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:06.933+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:07.060+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:07.190+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:07.200+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@41c011e3]
2026-01-22T15:35:07.203+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.237+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e460556] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:07.238+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@422160877 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:07.281+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:07.339+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:07.446+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:07.473+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e460556]
2026-01-22T15:35:07.478+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.478+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e7dce27] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:07.529+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@549393931 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:07.573+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:35:07.610+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:35:07.774+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:35:07.813+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e7dce27]
2026-01-22T15:35:07.816+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.823+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32962880] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:07.849+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1383777283 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:07.860+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:07.873+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:07.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:07.916+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32962880]
2026-01-22T15:35:07.925+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.928+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13108f59] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:07.930+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@281114515 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:07.933+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:35:07.938+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:35:07.959+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:35:07.965+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13108f59]
2026-01-22T15:35:07.977+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.977+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@722c7319] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:07.984+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1708212290 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:07.985+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:07.990+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:07.996+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:07.997+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@722c7319]
2026-01-22T15:35:07.998+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.999+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15590755] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.001+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@75237980 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:08.022+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:08.036+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:08.059+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:08.061+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15590755]
2026-01-22T15:35:08.064+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.072+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:35:08.076+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.103+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.144+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.145+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.145+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:08.146+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.148+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:35:08.160+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:35:08.160+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:35:08.180+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:35:08.199+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:35:08.243+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.249+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.249+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.264+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:08.264+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.264+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.274+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.274+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.277+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:35:08.280+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:35:08.293+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:35:08.295+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:35:08.295+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:35:08.296+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:35:08.296+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.296+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.297+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.311+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.311+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.311+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@597922b8] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.311+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.312+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.326+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.332+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.339+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.340+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.341+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.354+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.357+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@941490277 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:08.362+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1cda211d] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.366+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d9809cb] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.366+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10faa162] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.367+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e41f6df] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.369+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:08.370+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1962939854 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:08.372+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:08.376+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:35:08.381+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1630336722 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:35:08.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@787319525 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:35:08.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1990348787 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:35:08.390+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:35:08.393+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:08.394+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:35:08.395+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:35:08.397+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@597922b8]
2026-01-22T15:35:08.397+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.398+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.399+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:35:08.399+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.400+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:35:08.439+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:35:08.446+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48a86c7b] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.447+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1cda211d]
2026-01-22T15:35:08.447+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d9809cb]
2026-01-22T15:35:08.448+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1564592714 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:08.448+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.451+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:35:08.451+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:35:08.458+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:08.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:35:08.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10faa162]
2026-01-22T15:35:08.465+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e41f6df]
2026-01-22T15:35:08.466+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:08.467+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:35:08.479+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.479+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.492+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.493+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.495+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:35:08.495+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.498+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7500e1ca] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.500+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.503+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:35:08.506+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@558552106 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:35:08.510+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.511+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:35:08.512+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.513+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:35:08.513+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:35:08.514+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.519+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.521+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.526+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.532+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:35:08.545+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:35:08.545+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:08.548+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:35:08.559+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.559+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.564+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7500e1ca]
2026-01-22T15:35:08.566+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48a86c7b]
2026-01-22T15:35:08.572+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.579+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2316d5d2] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.581+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.581+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.581+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.582+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.588+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@726437082 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:35:08.590+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:35:08.591+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:35:08.591+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6af64a17] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.609+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:35:08.609+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:35:08.623+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.624+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.625+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1630943366 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:08.630+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.631+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:08.674+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.677+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.679+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:35:08.685+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.689+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:35:08.690+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.691+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:35:08.692+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.692+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:08.693+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1da29319] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.719+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@493748421 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:08.694+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69ff261e] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.711+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:35:08.744+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1671708584 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:35:08.730+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:35:08.733+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:35:08.734+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:35:08.744+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:35:08.745+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:35:08.746+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2316d5d2]
2026-01-22T15:35:08.775+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.746+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.746+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6af64a17]
2026-01-22T15:35:08.774+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.775+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.777+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.776+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.777+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:35:08.778+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.780+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75061d] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.781+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@198e49ee] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.781+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.782+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1477137142 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:08.782+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:08.839+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:08.840+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1428716652 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:35:08.840+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:35:08.841+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:35:08.865+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.905+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:35:08.911+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69ff261e]
2026-01-22T15:35:08.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:08.919+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1da29319]
2026-01-22T15:35:08.922+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:35:08.924+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:35:08.925+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.941+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75061d]
2026-01-22T15:35:08.944+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.997+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:09.009+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:35:09.010+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:35:09.011+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.013+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:35:09.014+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:09.028+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@198e49ee]
2026-01-22T15:35:09.030+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.030+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f331231] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.031+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.033+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:35:09.033+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.039+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@668903460 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:09.039+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.039+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5377ee9e] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.040+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:35:09.072+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.074+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:09.075+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:09.107+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1864035659 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:35:09.229+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:35:09.281+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.290+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:35:09.290+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:35:09.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:09.291+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:35:09.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2bc329d3] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:09.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:09.293+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:35:09.294+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1987965009 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:09.294+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:09.294+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:35:09.295+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:35:09.303+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:35:09.316+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.317+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:09.317+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.317+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.318+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:35:09.320+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:35:09.327+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.331+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5377ee9e]
2026-01-22T15:35:09.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:35:09.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f331231]
2026-01-22T15:35:09.346+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@542ba327] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2bc329d3]
2026-01-22T15:35:09.454+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.491+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5aae91e3] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.524+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:35:09.525+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.533+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1827633899 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:35:09.538+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@60370f71] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.568+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.583+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:35:09.585+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:35:09.592+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1612462623 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:35:09.596+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2005019612 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:09.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.609+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:09.609+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:35:09.612+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:09.656+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:09.626+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:09.659+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:09.659+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:35:09.739+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:35:09.739+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:35:09.743+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:09.743+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@542ba327]
2026-01-22T15:35:09.744+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5aae91e3]
2026-01-22T15:35:09.745+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:35:09.759+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.760+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.760+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:35:09.761+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:35:09.761+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:35:09.762+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.762+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.763+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.764+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.767+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:09.775+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.777+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@60370f71]
2026-01-22T15:35:09.778+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a842d52] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.779+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.783+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@398755134 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:35:09.786+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63afa78] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.788+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:35:09.789+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1580081481 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:09.794+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:35:09.794+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:09.796+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:09.826+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:35:09.889+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a842d52]
2026-01-22T15:35:09.890+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:09.909+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.912+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63afa78]
2026-01-22T15:35:09.912+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19635a1d] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.920+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.924+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@841353950 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:35:09.925+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:35:09.925+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:35:09.927+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.927+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:35:09.979+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:35:09.983+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19635a1d]
2026-01-22T15:35:09.989+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.997+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:35:10.005+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
