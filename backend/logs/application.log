2026-01-22T15:32:57.568+09:00  INFO 25872 --- [main] c.i.backend.BackendApplication           : Starting BackendApplication using Java 17.0.17 with PID 25872 (C:\InnerSignature\backend\target\classes started by owner in C:\InnerSignature\backend)
2026-01-22T15:32:57.769+09:00 DEBUG 25872 --- [main] c.i.backend.BackendApplication           : Running with Spring Boot v3.5.8, Spring v6.2.14
2026-01-22T15:32:57.813+09:00  INFO 25872 --- [main] c.i.backend.BackendApplication           : The following 1 profile is active: "dev"
2026-01-22T15:33:01.675+09:00 DEBUG 25872 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Searching for mappers annotated with @Mapper
2026-01-22T15:33:01.732+09:00 DEBUG 25872 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Using auto-configuration base package 'com.innersignature.backend'
2026-01-22T15:33:02.459+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AccountCodeMappingMapper.class]
2026-01-22T15:33:02.478+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AuditLogMapper.class]
2026-01-22T15:33:02.500+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AuditRuleMapper.class]
2026-01-22T15:33:02.563+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\BudgetMapper.class]
2026-01-22T15:33:02.631+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CompanyCardMapper.class]
2026-01-22T15:33:02.675+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CompanyMapper.class]
2026-01-22T15:33:02.765+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CreditMapper.class]
2026-01-22T15:33:02.801+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\ExpenseCategoryMapper.class]
2026-01-22T15:33:02.823+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\ExpenseMapper.class]
2026-01-22T15:33:02.840+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\MonthlyClosingMapper.class]
2026-01-22T15:33:02.880+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\PasswordResetTokenMapper.class]
2026-01-22T15:33:02.917+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\PaymentMapper.class]
2026-01-22T15:33:02.979+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\SubscriptionMapper.class]
2026-01-22T15:33:03.013+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\SubscriptionPlanMapper.class]
2026-01-22T15:33:03.044+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserApproverMapper.class]
2026-01-22T15:33:03.084+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserCardMapper.class]
2026-01-22T15:33:03.111+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserMapper.class]
2026-01-22T15:33:03.135+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserSignatureMapper.class]
2026-01-22T15:33:03.202+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'accountCodeMappingMapper' and 'com.innersignature.backend.mapper.AccountCodeMappingMapper' mapperInterface
2026-01-22T15:33:03.218+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'auditLogMapper' and 'com.innersignature.backend.mapper.AuditLogMapper' mapperInterface
2026-01-22T15:33:03.235+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'auditRuleMapper' and 'com.innersignature.backend.mapper.AuditRuleMapper' mapperInterface
2026-01-22T15:33:03.248+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'budgetMapper' and 'com.innersignature.backend.mapper.BudgetMapper' mapperInterface
2026-01-22T15:33:03.265+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'companyCardMapper' and 'com.innersignature.backend.mapper.CompanyCardMapper' mapperInterface
2026-01-22T15:33:03.350+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'companyMapper' and 'com.innersignature.backend.mapper.CompanyMapper' mapperInterface
2026-01-22T15:33:03.368+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'creditMapper' and 'com.innersignature.backend.mapper.CreditMapper' mapperInterface
2026-01-22T15:33:03.382+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'expenseCategoryMapper' and 'com.innersignature.backend.mapper.ExpenseCategoryMapper' mapperInterface
2026-01-22T15:33:03.465+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'expenseMapper' and 'com.innersignature.backend.mapper.ExpenseMapper' mapperInterface
2026-01-22T15:33:03.558+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'monthlyClosingMapper' and 'com.innersignature.backend.mapper.MonthlyClosingMapper' mapperInterface
2026-01-22T15:33:03.619+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'passwordResetTokenMapper' and 'com.innersignature.backend.mapper.PasswordResetTokenMapper' mapperInterface
2026-01-22T15:33:03.658+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'paymentMapper' and 'com.innersignature.backend.mapper.PaymentMapper' mapperInterface
2026-01-22T15:33:03.707+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'subscriptionMapper' and 'com.innersignature.backend.mapper.SubscriptionMapper' mapperInterface
2026-01-22T15:33:03.794+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'subscriptionPlanMapper' and 'com.innersignature.backend.mapper.SubscriptionPlanMapper' mapperInterface
2026-01-22T15:33:03.846+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userApproverMapper' and 'com.innersignature.backend.mapper.UserApproverMapper' mapperInterface
2026-01-22T15:33:03.891+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userCardMapper' and 'com.innersignature.backend.mapper.UserCardMapper' mapperInterface
2026-01-22T15:33:03.950+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userMapper' and 'com.innersignature.backend.mapper.UserMapper' mapperInterface
2026-01-22T15:33:03.992+09:00 DEBUG 25872 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userSignatureMapper' and 'com.innersignature.backend.mapper.UserSignatureMapper' mapperInterface
2026-01-22T15:33:05.610+09:00  INFO 25872 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-22T15:33:05.704+09:00  INFO 25872 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-22T15:33:05.784+09:00  INFO 25872 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.49]
2026-01-22T15:33:06.073+09:00  INFO 25872 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-22T15:33:06.132+09:00  INFO 25872 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 8122 ms
2026-01-22T15:33:06.411+09:00 DEBUG 25872 --- [main] c.i.b.security.JwtAuthenticationFilter   : Filter 'jwtAuthenticationFilter' configured for use
2026-01-22T15:33:06.496+09:00 DEBUG 25872 --- [main] c.i.backend.security.RateLimitFilter     : Filter 'rateLimitFilter' configured for use
2026-01-22T15:33:17.314+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AccountCodeMappingMapper.xml]'
2026-01-22T15:33:17.443+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AuditLogMapper.xml]'
2026-01-22T15:33:17.486+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AuditRuleMapper.xml]'
2026-01-22T15:33:17.545+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\BudgetMapper.xml]'
2026-01-22T15:33:17.587+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CompanyCardMapper.xml]'
2026-01-22T15:33:17.667+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CompanyMapper.xml]'
2026-01-22T15:33:17.855+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CreditMapper.xml]'
2026-01-22T15:33:17.900+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\ExpenseCategoryMapper.xml]'
2026-01-22T15:33:18.068+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\ExpenseMapper.xml]'
2026-01-22T15:33:18.177+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\MonthlyClosingMapper.xml]'
2026-01-22T15:33:18.199+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\PasswordResetTokenMapper.xml]'
2026-01-22T15:33:18.280+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\PaymentMapper.xml]'
2026-01-22T15:33:18.316+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\SubscriptionMapper.xml]'
2026-01-22T15:33:18.380+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\SubscriptionPlanMapper.xml]'
2026-01-22T15:33:18.439+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserApproverMapper.xml]'
2026-01-22T15:33:18.505+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserCardMapper.xml]'
2026-01-22T15:33:18.551+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserMappeer.xml]'
2026-01-22T15:33:18.567+09:00 DEBUG 25872 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserSignatureMapper.xml]'
2026-01-22T15:33:21.086+09:00 DEBUG 25872 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 162 mappings in 'requestMappingHandlerMapping'
2026-01-22T15:33:21.474+09:00 DEBUG 25872 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**, /api/uploads/**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2026-01-22T15:33:21.596+09:00  WARN 25872 --- [main] .s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: 9bf87a73-0722-45a8-8c6d-852a727f853e

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-01-22T15:33:21.815+09:00  INFO 25872 --- [main] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2026-01-22T15:33:22.227+09:00 DEBUG 25872 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RateLimitFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-22T15:33:22.737+09:00 DEBUG 25872 --- [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2026-01-22T15:33:22.928+09:00 DEBUG 25872 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2026-01-22T15:33:22.976+09:00 DEBUG 25872 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2026-01-22T15:33:23.756+09:00  INFO 25872 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-22T15:33:23.776+09:00  INFO 25872 --- [main] c.i.backend.BackendApplication           : Started BackendApplication in 28.383 seconds (process running for 29.471)
2026-01-22T15:34:02.660+09:00  INFO 25872 --- [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-22T15:34:02.662+09:00  INFO 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-22T15:34:02.663+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected StandardServletMultipartResolver
2026-01-22T15:34:02.663+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected AcceptHeaderLocaleResolver
2026-01-22T15:34:02.663+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected FixedThemeResolver
2026-01-22T15:34:02.665+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@3ea84e01
2026-01-22T15:34:02.665+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.support.SessionFlashMapManager@51f34185
2026-01-22T15:34:02.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2026-01-22T15:34:02.679+09:00  INFO 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 16 ms
2026-01-22T15:34:02.708+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/login
2026-01-22T15:34:02.761+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing POST /api/login
2026-01-22T15:34:02.768+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-22T15:34:02.780+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured POST /api/login
2026-01-22T15:34:02.783+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : POST "/api/login", parameters={}
2026-01-22T15:34:02.786+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#login(LoginRequest)
2026-01-22T15:34:02.883+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [UserController.LoginRequest(username=test_tax, password=1234)]
2026-01-22T15:34:02.916+09:00  INFO 25872 --- [http-nio-8080-exec-2] c.i.backend.controller.UserController    : 로그인 시도 - username: test_tax
2026-01-22T15:34:02.930+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:02.939+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35207340] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:02.973+09:00  INFO 25872 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-22T15:34:03.459+09:00  INFO 25872 --- [http-nio-8080-exec-2] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@64472107
2026-01-22T15:34:03.473+09:00  INFO 25872 --- [http-nio-8080-exec-2] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-22T15:34:03.481+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1264106381 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:03.499+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.findByUsername   : ==>  Preparing: SELECT * FROM user_tb WHERE username = ?
2026-01-22T15:34:03.543+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.findByUsername   : ==> Parameters: test_tax(String)
2026-01-22T15:34:03.656+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.findByUsername   : <==      Total: 1
2026-01-22T15:34:03.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35207340]
2026-01-22T15:34:03.794+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:03.795+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64f017d5] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:03.796+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@724818959 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:03.796+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:03.799+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:03.844+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:03.845+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64f017d5]
2026-01-22T15:34:04.010+09:00  INFO 25872 --- [http-nio-8080-exec-2] c.i.backend.controller.UserController    : 로그인 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1
2026-01-22T15:34:04.014+09:00  INFO 25872 --- [http-nio-8080-exec-2] SECURITY                                 : LOGIN_SUCCESS userId=12 username=test_tax role=TAX_ACCOUNTANT
2026-01-22T15:34:04.032+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:04.060+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=로그인 성공, data={user=UserDto(userId=12, username=test_tax, password= (truncated)...]
2026-01-22T15:34:04.091+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:04.813+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/companies
2026-01-22T15:34:04.827+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/companies
2026-01-22T15:34:04.932+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/companies
2026-01-22T15:34:04.961+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/companies
2026-01-22T15:34:04.962+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/companies", parameters={}
2026-01-22T15:34:05.031+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.CompanyController#getMyCompanies()
2026-01-22T15:34:05.120+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:05.128+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ee2e7c9] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:05.134+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1716332981 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:05.137+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.U.findCompaniesByUserId          : ==>  Preparing: SELECT c.company_id AS companyId, c.company_code AS companyCode, c.company_name AS companyName, c.business_reg_no AS businessRegNo, c.representative_name AS representativeName, c.created_by AS createdBy, c.is_active AS isActive, c.created_at AS createdAt, c.updated_at AS updatedAt FROM company_tb c INNER JOIN user_company_tb uc ON c.company_id = uc.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' AND c.is_active = 1 ORDER BY uc.is_primary DESC, c.created_at DESC
2026-01-22T15:34:05.140+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.U.findCompaniesByUserId          : ==> Parameters: 12(Long)
2026-01-22T15:34:05.227+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.U.findCompaniesByUserId          : <==      Total: 2
2026-01-22T15:34:05.234+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ee2e7c9]
2026-01-22T15:34:05.256+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:05.262+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ApiResponse(success=true, message=조회 성공, data=[CompanyDto(companyId=1, companyCode=2C4PSB, companyNa (truncated)...]
2026-01-22T15:34:05.323+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:07.177+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:34:07.184+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:34:07.191+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.194+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.197+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:07.205+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.279+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.347+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:34:07.410+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.427+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.444+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:07.490+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.499+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.499+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:34:07.567+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.569+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:07.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:34:07.602+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:07.608+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.609+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.622+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.625+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:07.699+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:34:07.799+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:07.834+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:07.847+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:34:07.860+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:07.864+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.865+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:34:07.884+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:07.884+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.885+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:07.885+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:07.888+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:07.916+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:34:07.917+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:07.929+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:07.930+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:07.932+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:07.934+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:07.934+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.935+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:07.942+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:07.962+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.950+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:34:07.951+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b8480c2] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:07.951+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.959+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.968+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.968+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:07.968+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.067+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@976996010 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:08.078+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:08.098+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:08.100+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.101+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.112+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21fdae06] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.247+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:34:08.344+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43c17308] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51b9d4e1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.401+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@119ffe1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.426+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:34:08.474+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@457ffcca] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.482+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1425764538 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:08.530+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1057382628 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:08.545+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:08.545+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:08.548+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@974037527 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:08.548+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@876148982 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:08.566+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:08.578+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:08.578+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:08.579+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:08.592+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:08.604+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:08.622+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:08.668+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:08.684+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21fdae06]
2026-01-22T15:34:08.747+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@119ffe1]
2026-01-22T15:34:08.693+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1932789747 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:08.731+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:34:08.732+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:08.748+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.748+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:08.749+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.749+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b8480c2]
2026-01-22T15:34:08.749+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43c17308]
2026-01-22T15:34:08.750+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@719dbeef] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.755+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:08.755+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@602ca72] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.778+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:08.778+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:08.779+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1779977217 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:08.783+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:34:08.785+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:08.791+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:08.793+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:08.794+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:08.809+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:08.814+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:08.822+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1098411971 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:08.829+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:34:08.833+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:08.852+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:08.977+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@719dbeef]
2026-01-22T15:34:08.857+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:08.860+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51b9d4e1]
2026-01-22T15:34:08.861+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:08.941+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:34:08.964+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:08.979+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:08.981+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@457ffcca]
2026-01-22T15:34:08.982+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:08.983+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:08.983+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:34:08.984+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:08.985+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e55f5d9] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:08.988+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:08.988+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:08.989+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:34:08.989+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:08.992+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@849566778 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:08.997+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.019+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:34:09.025+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:09.028+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:09.116+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:09.150+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:09.158+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.162+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.168+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.168+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:09.172+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@602ca72]
2026-01-22T15:34:09.174+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d7caa43] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.177+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.183+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:09.198+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.199+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:09.200+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@867914652 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:09.201+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.210+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:09.212+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:09.213+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:09.217+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:34:09.218+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@272e7170] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.232+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.248+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:09.285+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:09.264+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:09.281+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:34:09.283+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:09.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:09.313+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:09.347+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@931238584 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:09.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:09.378+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:09.381+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:34:09.382+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:09.382+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.382+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:09.383+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e55f5d9]
2026-01-22T15:34:09.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:09.385+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d7caa43]
2026-01-22T15:34:09.392+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.392+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.394+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.394+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:09.394+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:09.394+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.395+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.398+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.401+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@12cf536e] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.402+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:09.402+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:34:09.428+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.432+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31506555] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.432+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@516097703 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:09.434+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:09.443+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.478+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.483+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a763417] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.518+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1420939561 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:09.485+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1394101839 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:09.496+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:09.513+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@272e7170]
2026-01-22T15:34:09.514+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:09.516+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:34:09.529+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:09.530+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:09.531+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:09.531+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.531+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.535+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:34:09.549+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:09.555+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:09.564+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:09.564+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b7d3ab5] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.567+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:34:09.569+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:34:09.573+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:34:09.582+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43bec729] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.599+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1904562629 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:09.600+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:09.601+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:09.601+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:09.621+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1520372575 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:09.633+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:09.634+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31506555]
2026-01-22T15:34:09.639+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@12cf536e]
2026-01-22T15:34:09.646+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a763417]
2026-01-22T15:34:09.649+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:34:09.697+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:09.697+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.698+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.699+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.759+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:34:09.826+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:09.818+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:09.823+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@516b18f1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:09.827+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.848+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:09.850+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1152076206 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:09.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:09.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:34:09.981+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b7d3ab5]
2026-01-22T15:34:09.977+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:09.981+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43bec729]
2026-01-22T15:34:09.981+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:09.984+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:09.992+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:09.998+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@263ded26] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.026+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:34:10.035+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:10.044+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@100206016 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:10.046+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:10.049+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@516b18f1]
2026-01-22T15:34:10.062+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:10.074+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.090+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:10.090+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@418ae2d1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.110+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@521215156 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:10.139+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:10.148+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:10.167+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:10.184+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@263ded26]
2026-01-22T15:34:10.193+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:10.218+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:10.230+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:10.233+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@418ae2d1]
2026-01-22T15:34:10.235+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.252+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20e2cba4] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.235+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:10.260+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@921188611 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:10.275+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:10.283+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:10.314+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:10.315+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20e2cba4]
2026-01-22T15:34:10.321+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:10.367+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:34:10.428+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:10.460+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.534+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.534+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.535+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:10.540+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.550+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:34:10.581+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:10.562+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:10.563+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:10.580+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:10.581+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.582+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.584+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.585+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:10.585+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:10.591+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:10.594+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:10.592+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:10.593+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:10.593+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:10.594+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:34:10.594+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:10.647+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:10.677+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:10.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:10.676+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.678+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.678+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.679+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.696+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.697+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a6a6e42] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.697+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.697+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.698+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.698+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:10.718+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.718+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@728659a7] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.724+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.764+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@714954686 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:10.781+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:10.791+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@28a616ca] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.791+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5857cb4d] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.809+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:10.810+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5dcdb237] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:10.812+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:10.818+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@313108200 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:10.830+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:10.831+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@165927091 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:10.832+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1826458914 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:10.841+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:10.843+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:10.845+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:10.848+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1335373489 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:10.848+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:10.853+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:10.900+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:10.899+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:10.900+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a6a6e42]
2026-01-22T15:34:10.902+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:10.906+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:11.034+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:11.111+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@728659a7]
2026-01-22T15:34:11.034+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:11.098+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.112+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@28a616ca]
2026-01-22T15:34:11.111+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5857cb4d]
2026-01-22T15:34:11.112+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.111+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.112+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@647d0261] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.113+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.113+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:11.114+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f71ef90] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.180+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@853749031 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:11.181+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:11.182+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:11.193+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.193+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1227274706 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:11.194+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:11.195+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5dcdb237]
2026-01-22T15:34:11.197+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.199+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:11.201+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:11.232+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.234+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.234+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.262+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:11.277+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:11.311+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:11.315+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:11.316+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:11.318+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.331+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@647d0261]
2026-01-22T15:34:11.332+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.334+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.335+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:11.343+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:11.346+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:11.346+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cae682b] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.347+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:11.347+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1884029909 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:11.349+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.349+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.349+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:11.350+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.350+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.353+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:11.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b540310] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.367+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.368+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b8ac664] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.368+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1901397639 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:11.389+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:11.432+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.444+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:11.475+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cae682b]
2026-01-22T15:34:11.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:11.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f71ef90]
2026-01-22T15:34:11.476+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.477+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:11.477+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:11.477+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.495+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@337577346 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:11.512+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3462c54d] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.549+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.564+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:11.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:11.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@998378714 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:11.571+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:11.566+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:11.567+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.569+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:11.572+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:11.574+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:11.575+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.576+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:11.576+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.577+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c33b767] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.577+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@427928135 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:11.577+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:11.579+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:11.583+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:11.584+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b540310]
2026-01-22T15:34:11.584+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.585+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:11.587+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.650+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:11.650+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:11.653+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:11.692+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c33b767]
2026-01-22T15:34:11.692+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3462c54d]
2026-01-22T15:34:11.693+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b8ac664]
2026-01-22T15:34:11.693+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.700+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:11.702+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.751+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:11.835+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c0defa0] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:11.784+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:11.816+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:11.833+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:11.834+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:11.841+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1055332801 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:11.842+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:11.843+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.849+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:11.868+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.874+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.879+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:11.900+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:11.907+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:11.934+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:11.968+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:12.010+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:12.050+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:12.054+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:12.088+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:12.117+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:12.181+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:12.326+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.329+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:12.343+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:12.344+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:12.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c0defa0]
2026-01-22T15:34:12.348+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:12.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:12.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:12.413+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.429+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.431+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50af6cd3] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.432+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39d22038] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.479+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.480+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3e8cb0ec] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.482+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.483+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1169002106 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:12.485+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:12.534+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.549+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1283365335 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:12.550+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1088578084 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:12.551+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:12.555+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.556+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32aa3fe5] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.579+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:12.580+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:12.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:12.599+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2445ac7e] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.616+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:12.617+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:12.629+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1931740202 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:12.629+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:12.630+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1141923156 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:12.630+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:12.631+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:12.634+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:12.635+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39d22038]
2026-01-22T15:34:12.648+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:12.649+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3e8cb0ec]
2026-01-22T15:34:12.650+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50af6cd3]
2026-01-22T15:34:12.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:12.666+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.667+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:12.668+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:12.679+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:12.680+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@30c9d663] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.683+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:12.683+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@608e795e] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:12.684+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1084034211 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:12.685+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:12.685+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1265391720 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:12.729+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:12.732+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:12.733+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:12.760+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:12.761+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:12.762+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2445ac7e]
2026-01-22T15:34:12.763+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32aa3fe5]
2026-01-22T15:34:12.835+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:12.843+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:12.843+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:12.860+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:12.862+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:12.862+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:12.864+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:12.864+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@30c9d663]
2026-01-22T15:34:12.865+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:12.868+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:12.895+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:12.898+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@608e795e]
2026-01-22T15:34:12.900+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:34:12.930+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:12.945+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:12.962+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:13.014+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:13.016+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:13.054+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:13.065+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:13.069+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:13.072+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:13.079+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:13.081+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:13.082+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:13.082+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b5a01c4] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:13.084+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1245647075 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:13.088+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:13.090+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:13.097+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:13.097+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b5a01c4]
2026-01-22T15:34:13.099+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:13.099+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@186b8e8a] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:13.100+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1040900435 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:13.101+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:13.112+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:13.150+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:13.152+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@186b8e8a]
2026-01-22T15:34:13.154+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:13.157+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:13.159+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:15.868+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:15.938+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:34:15.949+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:16.106+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:16.163+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:34:16.243+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.266+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78f36d5c] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.312+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@159747706 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.317+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:16.326+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:16.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:16.376+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78f36d5c]
2026-01-22T15:34:16.380+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.383+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a8129a1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@798547068 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:16.412+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:16.448+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:16.458+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a8129a1]
2026-01-22T15:34:16.464+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.467+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a82bf7b] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.479+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@968711083 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.495+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:16.512+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:16.539+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:16.550+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a82bf7b]
2026-01-22T15:34:16.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.568+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@138ee5b] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.575+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1579081824 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.595+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:16.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:16.627+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:16.632+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@138ee5b]
2026-01-22T15:34:16.639+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.641+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25749399] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.646+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1668868954 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.667+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:16.682+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:16.776+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:16.793+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25749399]
2026-01-22T15:34:16.817+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:16.862+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@eaf84b9] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:16.908+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@605863531 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:16.934+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:16.966+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:17.032+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:17.036+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@eaf84b9]
2026-01-22T15:34:17.042+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.044+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@688c0174] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.047+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@452250256 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:17.048+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:17.051+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:17.105+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:17.139+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@688c0174]
2026-01-22T15:34:17.140+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:17.198+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:34:17.260+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:17.266+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.275+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:34:17.328+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.330+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.330+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:17.330+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.333+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.359+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:17.361+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:17.361+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:17.362+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:17.362+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.363+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.363+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:17.363+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:17.379+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:34:17.379+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:17.379+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:17.380+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.380+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:17.382+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.382+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:17.398+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:17.398+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:17.401+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:17.410+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f0d2d7a] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.413+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.414+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.414+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:17.415+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.417+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.427+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.427+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.428+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.428+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.433+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.434+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@485651547 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:17.437+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:17.445+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.445+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2940248f] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.445+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5fa60209] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.451+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:17.455+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@459812c2] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.463+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:17.464+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d2a11c1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.465+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@432941738 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:17.480+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:17.482+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2132145234 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:17.482+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@213804165 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:17.494+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:17.496+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@700013907 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:17.497+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:17.499+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:17.499+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:17.516+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:17.517+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f0d2d7a]
2026-01-22T15:34:17.518+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:17.519+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:17.526+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:17.531+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.534+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:17.551+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79a3524] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.553+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@459812c2]
2026-01-22T15:34:17.555+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:17.560+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5fa60209]
2026-01-22T15:34:17.558+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@969374500 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:17.560+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.561+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:17.561+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:17.562+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@122f7a6d] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.563+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:17.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@388261096 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:17.564+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:17.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:17.565+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:17.602+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:17.603+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:17.605+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:17.627+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.627+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2940248f]
2026-01-22T15:34:17.628+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d2a11c1]
2026-01-22T15:34:17.630+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:17.678+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:17.679+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:17.684+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:17.694+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:17.696+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79a3524]
2026-01-22T15:34:17.699+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:17.704+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.842+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:17.898+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@122f7a6d]
2026-01-22T15:34:17.910+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:17.912+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:17.912+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:17.914+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:17.949+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:17.962+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:17.976+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62c246ea] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:17.976+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:18.096+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:18.182+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:18.232+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:18.330+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:18.331+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:18.271+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@874998915 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:18.323+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.329+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:18.331+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:18.332+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:18.383+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.390+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:18.392+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:18.395+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:18.398+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:18.415+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:18.417+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:18.417+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:18.425+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:18.443+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@296886ce] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:18.444+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.444+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:18.445+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.474+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.474+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:18.475+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.476+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:18.476+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:18.492+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@138632451 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:18.493+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:18.524+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:18.540+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21048e82] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:18.540+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.541+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:18.541+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62c246ea]
2026-01-22T15:34:18.613+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62f7343] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:18.775+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:18.811+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1791328297 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:18.848+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:18.897+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:19.083+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1023286174 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:34:19.100+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:19.165+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:19.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:19.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44d6ee8c] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:19.427+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:19.525+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8f8bce1] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:19.622+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:19.732+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@296886ce]
2026-01-22T15:34:19.895+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1000289431 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:19.896+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:20.077+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@625609748 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:20.162+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:20.221+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:20.294+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:20.616+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:20.630+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:20.797+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:20.930+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21048e82]
2026-01-22T15:34:21.173+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:21.294+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:21.424+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62f7343]
2026-01-22T15:34:21.523+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:21.604+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:21.606+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:21.785+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:21.814+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:21.817+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:21.997+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:22.084+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:34:22.150+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44d6ee8c]
2026-01-22T15:34:22.232+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:22.296+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8f8bce1]
2026-01-22T15:34:22.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:22.442+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:22.444+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:22.508+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:22.591+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:22.608+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:22.632+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:22.634+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2761bae7] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:22.640+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:34:22.643+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@18a35230] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:22.644+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:34:22.644+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@196183988 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:22.645+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:22.646+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1845026856 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:22.646+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:22.649+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:22.718+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:34:22.848+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:23.076+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:34:23.077+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:22.975+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:23.041+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:23.074+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:34:23.075+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:34:23.079+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:23.080+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:23.149+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:23.217+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:34:23.431+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:34:23.507+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:23.652+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:23.654+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b6149db] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:23.665+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:34:23.678+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2761bae7]
2026-01-22T15:34:23.732+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@65eda7e5] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:23.753+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@18a35230]
2026-01-22T15:34:23.754+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:34:23.763+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:23.776+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@917211896 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:34:23.781+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@889342034 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:34:23.792+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:23.799+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:23.810+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@34dce5b2] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:23.810+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:34:23.810+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:34:23.811+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:23.812+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:23.812+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1016220681 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:23.831+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:23.832+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:23.833+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:23.845+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:23.880+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59acbd3] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:23.846+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:23.859+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:23.891+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:34:23.894+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:23.896+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:34:23.898+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:34:23.912+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:34:23.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b6149db]
2026-01-22T15:34:23.938+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:23.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:34:23.914+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1289372475 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:34:23.914+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:34:23.914+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:23.939+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:34:23.948+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:23.978+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:34:23.978+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@65eda7e5]
2026-01-22T15:34:23.993+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@34dce5b2]
2026-01-22T15:34:24.001+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:24.001+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:34:24.004+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:34:24.018+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:24.018+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:24.032+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:24.032+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:34:24.048+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77ffb5dc] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:24.049+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d697c43] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:24.050+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@610086884 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:34:24.050+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:24.057+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:34:24.064+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:34:24.067+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59acbd3]
2026-01-22T15:34:24.077+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2113425489 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:24.080+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:34:24.099+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:24.118+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:34:24.163+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:34:24.167+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:34:24.167+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:24.167+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:34:24.195+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77ffb5dc]
2026-01-22T15:34:24.212+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:34:24.229+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:24.229+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d697c43]
2026-01-22T15:34:24.246+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:34:24.246+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:34:24.247+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1a052d59] was not registered for synchronization because synchronization is not active
2026-01-22T15:34:24.249+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:34:24.250+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1277588585 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:34:24.258+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:34:24.290+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:34:24.313+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:34:24.317+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1a052d59]
2026-01-22T15:34:24.327+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:34:24.334+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:34:24.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:06.029+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:06.122+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:35:06.233+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:06.362+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:06.450+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:35:06.520+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:06.606+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@41c011e3] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:06.868+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@476235122 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:06.933+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:07.060+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:07.190+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:07.200+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@41c011e3]
2026-01-22T15:35:07.203+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.237+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e460556] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:07.238+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@422160877 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:07.281+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:07.339+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:07.446+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:07.473+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e460556]
2026-01-22T15:35:07.478+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.478+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e7dce27] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:07.529+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@549393931 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:07.573+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:35:07.610+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:35:07.774+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:35:07.813+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e7dce27]
2026-01-22T15:35:07.816+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.823+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32962880] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:07.849+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1383777283 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:07.860+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:07.873+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:07.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:07.916+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32962880]
2026-01-22T15:35:07.925+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.928+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13108f59] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:07.930+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@281114515 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:07.933+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:35:07.938+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:35:07.959+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:35:07.965+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13108f59]
2026-01-22T15:35:07.977+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.977+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@722c7319] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:07.984+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1708212290 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:07.985+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:07.990+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:07.996+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:07.997+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@722c7319]
2026-01-22T15:35:07.998+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:07.999+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15590755] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.001+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@75237980 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:08.022+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:08.036+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:08.059+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:08.061+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15590755]
2026-01-22T15:35:08.064+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.072+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:35:08.076+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.103+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.144+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.145+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.145+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:08.146+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.148+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-22T15:35:08.160+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:35:08.160+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:35:08.180+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:35:08.199+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:35:08.243+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.249+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.249+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.264+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:08.264+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.264+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.274+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.274+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.277+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:35:08.280+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-22T15:35:08.293+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:35:08.295+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:35:08.295+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:35:08.296+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:35:08.296+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.296+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.297+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.311+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.311+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.311+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@597922b8] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.311+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.312+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.326+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.332+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.339+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.340+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.341+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.354+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.357+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@941490277 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:08.362+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1cda211d] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.366+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d9809cb] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.366+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10faa162] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.367+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e41f6df] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.369+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:08.370+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1962939854 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:08.372+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:08.376+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:35:08.381+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1630336722 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:35:08.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@787319525 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:35:08.384+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1990348787 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:35:08.390+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:35:08.393+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:08.394+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:35:08.395+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:35:08.397+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@597922b8]
2026-01-22T15:35:08.397+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.398+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.399+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:35:08.399+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.400+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:35:08.439+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:35:08.446+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48a86c7b] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.447+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1cda211d]
2026-01-22T15:35:08.447+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d9809cb]
2026-01-22T15:35:08.448+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1564592714 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:08.448+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.451+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:35:08.451+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:35:08.458+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:08.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:35:08.459+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10faa162]
2026-01-22T15:35:08.465+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e41f6df]
2026-01-22T15:35:08.466+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:08.467+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:35:08.479+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.479+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.492+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.493+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.495+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:35:08.495+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.498+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7500e1ca] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.500+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.503+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:35:08.506+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@558552106 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:35:08.510+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.511+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:35:08.512+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.513+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:35:08.513+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:35:08.514+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.519+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.521+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.526+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.532+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:35:08.545+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:35:08.545+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:08.548+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:35:08.559+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.559+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.564+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7500e1ca]
2026-01-22T15:35:08.566+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48a86c7b]
2026-01-22T15:35:08.572+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.579+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2316d5d2] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.581+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.581+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.581+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.582+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:08.588+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@726437082 wrapping com.mysql.cj.jdbc.ConnectionImpl@4024f5da] will not be managed by Spring
2026-01-22T15:35:08.590+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:35:08.591+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:35:08.591+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6af64a17] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.609+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:35:08.609+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:35:08.623+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.624+09:00 DEBUG 25872 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.625+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1630943366 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:08.630+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.631+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:08.674+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.677+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.679+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:35:08.685+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.689+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:35:08.690+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.691+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:35:08.692+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.692+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:08.693+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1da29319] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.719+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@493748421 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:08.694+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69ff261e] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.711+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:35:08.744+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1671708584 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:35:08.730+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:35:08.733+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:35:08.734+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:35:08.744+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:35:08.745+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:35:08.746+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2316d5d2]
2026-01-22T15:35:08.775+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.746+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:08.746+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6af64a17]
2026-01-22T15:35:08.774+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.775+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.777+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:08.776+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.777+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:35:08.778+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:08.780+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75061d] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.781+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@198e49ee] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:08.781+09:00 DEBUG 25872 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:08.782+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1477137142 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:08.782+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:08.839+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:08.840+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1428716652 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:35:08.840+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:35:08.841+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:35:08.865+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:08.905+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:35:08.911+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69ff261e]
2026-01-22T15:35:08.913+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:08.919+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1da29319]
2026-01-22T15:35:08.922+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:35:08.924+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:35:08.925+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.941+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75061d]
2026-01-22T15:35:08.944+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:08.997+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:09.009+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:35:09.010+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:35:09.011+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.013+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:35:09.014+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:09.028+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@198e49ee]
2026-01-22T15:35:09.030+09:00 DEBUG 25872 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.030+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f331231] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.031+09:00 DEBUG 25872 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.033+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:35:09.033+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.039+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@668903460 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:09.039+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.039+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5377ee9e] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.040+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-22T15:35:09.072+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.074+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:09.075+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:09.107+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1864035659 wrapping com.mysql.cj.jdbc.ConnectionImpl@7d6a01] will not be managed by Spring
2026-01-22T15:35:09.229+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), 2147483647(Integer), 0(Integer)
2026-01-22T15:35:09.281+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.290+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:35:09.290+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:35:09.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:09.291+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:35:09.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2bc329d3] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:35:09.292+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:09.293+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:35:09.294+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1987965009 wrapping com.mysql.cj.jdbc.ConnectionImpl@64472107] will not be managed by Spring
2026-01-22T15:35:09.294+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:35:09.294+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:35:09.295+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:35:09.303+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-22T15:35:09.316+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.317+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:09.317+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.317+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.318+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:35:09.320+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 25
2026-01-22T15:35:09.327+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.331+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5377ee9e]
2026-01-22T15:35:09.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:35:09.345+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f331231]
2026-01-22T15:35:09.346+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@542ba327] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.364+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.365+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2bc329d3]
2026-01-22T15:35:09.454+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.491+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5aae91e3] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.524+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:35:09.525+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.533+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1827633899 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:35:09.538+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@60370f71] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.568+09:00 DEBUG 25872 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.583+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:35:09.585+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:35:09.592+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1612462623 wrapping com.mysql.cj.jdbc.ConnectionImpl@520a3e4b] will not be managed by Spring
2026-01-22T15:35:09.596+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2005019612 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:09.598+09:00 DEBUG 25872 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.609+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:09.609+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.tax_collected_at IS NULL AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:35:09.612+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:09.656+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:35:09.626+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:09.659+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:09.659+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:35:09.739+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:35:09.739+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:35:09.743+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:35:09.743+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@542ba327]
2026-01-22T15:35:09.744+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5aae91e3]
2026-01-22T15:35:09.745+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:35:09.759+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.760+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.760+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:35:09.761+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:35:09.761+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:35:09.762+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.762+09:00 DEBUG 25872 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.763+09:00 DEBUG 25872 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.764+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:35:09.767+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:09.775+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.777+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@60370f71]
2026-01-22T15:35:09.778+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a842d52] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.779+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.783+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@398755134 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:35:09.786+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63afa78] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.788+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:35:09.789+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1580081481 wrapping com.mysql.cj.jdbc.ConnectionImpl@5944bde6] will not be managed by Spring
2026-01-22T15:35:09.794+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:35:09.794+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:35:09.796+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:35:09.826+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:35:09.889+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a842d52]
2026-01-22T15:35:09.890+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:35:09.909+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:35:09.912+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63afa78]
2026-01-22T15:35:09.912+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19635a1d] was not registered for synchronization because synchronization is not active
2026-01-22T15:35:09.920+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.924+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@841353950 wrapping com.mysql.cj.jdbc.ConnectionImpl@63cf1a3f] will not be managed by Spring
2026-01-22T15:35:09.925+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-22T15:35:09.925+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:35:09.927+09:00 DEBUG 25872 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:35:09.927+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:35:09.979+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:35:09.983+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19635a1d]
2026-01-22T15:35:09.989+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:35:09.997+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:35:10.005+09:00 DEBUG 25872 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:10.451+09:00  INFO 56396 --- [main] c.i.backend.BackendApplication           : Starting BackendApplication using Java 17.0.17 with PID 56396 (C:\InnerSignature\backend\target\classes started by owner in C:\InnerSignature\backend)
2026-01-22T15:37:10.458+09:00 DEBUG 56396 --- [main] c.i.backend.BackendApplication           : Running with Spring Boot v3.5.8, Spring v6.2.14
2026-01-22T15:37:10.477+09:00  INFO 56396 --- [main] c.i.backend.BackendApplication           : The following 1 profile is active: "dev"
2026-01-22T15:37:12.844+09:00 DEBUG 56396 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Searching for mappers annotated with @Mapper
2026-01-22T15:37:12.895+09:00 DEBUG 56396 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Using auto-configuration base package 'com.innersignature.backend'
2026-01-22T15:37:13.285+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AccountCodeMappingMapper.class]
2026-01-22T15:37:13.297+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AuditLogMapper.class]
2026-01-22T15:37:13.300+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AuditRuleMapper.class]
2026-01-22T15:37:13.303+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\BudgetMapper.class]
2026-01-22T15:37:13.308+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CompanyCardMapper.class]
2026-01-22T15:37:13.333+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CompanyMapper.class]
2026-01-22T15:37:13.339+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CreditMapper.class]
2026-01-22T15:37:13.366+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\ExpenseCategoryMapper.class]
2026-01-22T15:37:13.379+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\ExpenseMapper.class]
2026-01-22T15:37:13.387+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\MonthlyClosingMapper.class]
2026-01-22T15:37:13.393+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\PasswordResetTokenMapper.class]
2026-01-22T15:37:13.399+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\PaymentMapper.class]
2026-01-22T15:37:13.410+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\SubscriptionMapper.class]
2026-01-22T15:37:13.427+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\SubscriptionPlanMapper.class]
2026-01-22T15:37:13.459+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserApproverMapper.class]
2026-01-22T15:37:13.463+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserCardMapper.class]
2026-01-22T15:37:13.469+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserMapper.class]
2026-01-22T15:37:13.473+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserSignatureMapper.class]
2026-01-22T15:37:13.489+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'accountCodeMappingMapper' and 'com.innersignature.backend.mapper.AccountCodeMappingMapper' mapperInterface
2026-01-22T15:37:13.497+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'auditLogMapper' and 'com.innersignature.backend.mapper.AuditLogMapper' mapperInterface
2026-01-22T15:37:13.540+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'auditRuleMapper' and 'com.innersignature.backend.mapper.AuditRuleMapper' mapperInterface
2026-01-22T15:37:13.580+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'budgetMapper' and 'com.innersignature.backend.mapper.BudgetMapper' mapperInterface
2026-01-22T15:37:13.599+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'companyCardMapper' and 'com.innersignature.backend.mapper.CompanyCardMapper' mapperInterface
2026-01-22T15:37:13.626+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'companyMapper' and 'com.innersignature.backend.mapper.CompanyMapper' mapperInterface
2026-01-22T15:37:13.682+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'creditMapper' and 'com.innersignature.backend.mapper.CreditMapper' mapperInterface
2026-01-22T15:37:13.734+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'expenseCategoryMapper' and 'com.innersignature.backend.mapper.ExpenseCategoryMapper' mapperInterface
2026-01-22T15:37:13.754+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'expenseMapper' and 'com.innersignature.backend.mapper.ExpenseMapper' mapperInterface
2026-01-22T15:37:13.796+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'monthlyClosingMapper' and 'com.innersignature.backend.mapper.MonthlyClosingMapper' mapperInterface
2026-01-22T15:37:13.836+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'passwordResetTokenMapper' and 'com.innersignature.backend.mapper.PasswordResetTokenMapper' mapperInterface
2026-01-22T15:37:13.855+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'paymentMapper' and 'com.innersignature.backend.mapper.PaymentMapper' mapperInterface
2026-01-22T15:37:13.885+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'subscriptionMapper' and 'com.innersignature.backend.mapper.SubscriptionMapper' mapperInterface
2026-01-22T15:37:13.899+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'subscriptionPlanMapper' and 'com.innersignature.backend.mapper.SubscriptionPlanMapper' mapperInterface
2026-01-22T15:37:13.934+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userApproverMapper' and 'com.innersignature.backend.mapper.UserApproverMapper' mapperInterface
2026-01-22T15:37:14.037+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userCardMapper' and 'com.innersignature.backend.mapper.UserCardMapper' mapperInterface
2026-01-22T15:37:14.112+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userMapper' and 'com.innersignature.backend.mapper.UserMapper' mapperInterface
2026-01-22T15:37:14.134+09:00 DEBUG 56396 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userSignatureMapper' and 'com.innersignature.backend.mapper.UserSignatureMapper' mapperInterface
2026-01-22T15:37:15.517+09:00  INFO 56396 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-22T15:37:15.552+09:00  INFO 56396 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-22T15:37:15.578+09:00  INFO 56396 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.49]
2026-01-22T15:37:15.726+09:00  INFO 56396 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-22T15:37:15.777+09:00  INFO 56396 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 5168 ms
2026-01-22T15:37:16.024+09:00 DEBUG 56396 --- [main] c.i.b.security.JwtAuthenticationFilter   : Filter 'jwtAuthenticationFilter' configured for use
2026-01-22T15:37:16.070+09:00 DEBUG 56396 --- [main] c.i.backend.security.RateLimitFilter     : Filter 'rateLimitFilter' configured for use
2026-01-22T15:37:19.323+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AccountCodeMappingMapper.xml]'
2026-01-22T15:37:19.347+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AuditLogMapper.xml]'
2026-01-22T15:37:19.376+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AuditRuleMapper.xml]'
2026-01-22T15:37:19.467+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\BudgetMapper.xml]'
2026-01-22T15:37:19.496+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CompanyCardMapper.xml]'
2026-01-22T15:37:19.524+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CompanyMapper.xml]'
2026-01-22T15:37:19.542+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CreditMapper.xml]'
2026-01-22T15:37:19.578+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\ExpenseCategoryMapper.xml]'
2026-01-22T15:37:19.697+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\ExpenseMapper.xml]'
2026-01-22T15:37:19.771+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\MonthlyClosingMapper.xml]'
2026-01-22T15:37:19.806+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\PasswordResetTokenMapper.xml]'
2026-01-22T15:37:19.823+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\PaymentMapper.xml]'
2026-01-22T15:37:19.859+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\SubscriptionMapper.xml]'
2026-01-22T15:37:19.877+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\SubscriptionPlanMapper.xml]'
2026-01-22T15:37:19.894+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserApproverMapper.xml]'
2026-01-22T15:37:19.919+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserCardMapper.xml]'
2026-01-22T15:37:19.958+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserMappeer.xml]'
2026-01-22T15:37:19.987+09:00 DEBUG 56396 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserSignatureMapper.xml]'
2026-01-22T15:37:21.440+09:00 DEBUG 56396 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 162 mappings in 'requestMappingHandlerMapping'
2026-01-22T15:37:21.673+09:00 DEBUG 56396 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**, /api/uploads/**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2026-01-22T15:37:21.839+09:00  WARN 56396 --- [main] .s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: 30ef435b-cfa4-45a6-b4c7-0617c6d78e4c

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-01-22T15:37:21.950+09:00  INFO 56396 --- [main] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2026-01-22T15:37:22.305+09:00 DEBUG 56396 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RateLimitFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-22T15:37:22.617+09:00 DEBUG 56396 --- [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2026-01-22T15:37:22.777+09:00 DEBUG 56396 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2026-01-22T15:37:22.881+09:00 DEBUG 56396 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2026-01-22T15:37:23.765+09:00  INFO 56396 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-22T15:37:23.812+09:00  INFO 56396 --- [main] c.i.backend.BackendApplication           : Started BackendApplication in 14.185 seconds (process running for 15.063)
2026-01-22T15:37:25.415+09:00  INFO 56396 --- [http-nio-8080-exec-3] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-22T15:37:25.449+09:00  INFO 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-22T15:37:25.476+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Detected StandardServletMultipartResolver
2026-01-22T15:37:25.491+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Detected AcceptHeaderLocaleResolver
2026-01-22T15:37:25.524+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Detected FixedThemeResolver
2026-01-22T15:37:25.537+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@71b3ba5a
2026-01-22T15:37:25.552+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.support.SessionFlashMapManager@376498da
2026-01-22T15:37:25.558+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2026-01-22T15:37:25.578+09:00  INFO 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed initialization in 102 ms
2026-01-22T15:37:25.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:37:25.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:37:25.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:37:25.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:37:25.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:25.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:37:25.682+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:37:25.682+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:25.683+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:37:25.686+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:37:25.688+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:25.688+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:37:25.713+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:37:25.715+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:37:25.719+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:37:25.719+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:25.719+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:37:25.721+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:25.744+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:25.746+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:25.773+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:26.035+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:26.035+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:26.035+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:26.035+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:26.035+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:37:26.072+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:26.080+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:26.104+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:26.116+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:26.116+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:37:26.134+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:26.137+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:26.138+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:26.144+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:26.145+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:37:26.153+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:26.152+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:26.155+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:26.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:26.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:37:26.227+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:26.282+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:26.292+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:26.311+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:26.326+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:26.328+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:26.328+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:26.363+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:26.379+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:26.393+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:26.396+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16ac9ea] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:26.396+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:26.399+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:26.399+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:26.406+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c8474b5] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:26.418+09:00  INFO 56396 --- [http-nio-8080-exec-7] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-22T15:37:26.459+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@692b66bd] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:26.478+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@234d27d8] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:26.478+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6af7ddc8] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:27.056+09:00  INFO 56396 --- [http-nio-8080-exec-7] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@79498ad4
2026-01-22T15:37:27.074+09:00  INFO 56396 --- [http-nio-8080-exec-7] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-22T15:37:27.106+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1145205744 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:27.126+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:37:27.211+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:37:27.339+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:37:27.367+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16ac9ea]
2026-01-22T15:37:27.390+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1361864612 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:27.453+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:27.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:27.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:27.477+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:37:27.510+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@29873476 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:27.599+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:27.601+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:27.651+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:27.668+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6af7ddc8]
2026-01-22T15:37:27.670+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:27.671+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1862529132 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:27.671+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:27.695+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:27.699+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:27.702+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:27.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:27.726+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:27.768+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:27.786+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:27.811+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@234d27d8]
2026-01-22T15:37:27.820+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@692b66bd]
2026-01-22T15:37:27.823+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:27.824+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:27.824+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@928371541 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:27.826+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5644ede] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:27.826+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:27.826+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:27.853+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:27.837+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:27.876+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:27.897+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1273076025 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:27.913+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:27.974+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:28.035+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:28.065+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:28.092+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:28.108+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:28.192+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:28.252+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:28.272+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:28.310+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:28.434+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c8474b5]
2026-01-22T15:37:28.536+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:28.591+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:28.597+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:28.599+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:28.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@58b1894f] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:28.609+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:28.619+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:28.622+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:28.622+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@278449161 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:28.644+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5644ede]
2026-01-22T15:37:28.645+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:28.657+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:28.660+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:28.663+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:28.661+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:28.661+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:28.663+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:28.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:28.725+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@58b1894f]
2026-01-22T15:37:28.712+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:28.714+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:28.727+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:28.728+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:28.735+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:28.727+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:28.727+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d4f2775] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:28.735+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:28.740+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2115918672 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:28.740+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:28.757+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:28.758+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:28.760+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:28.761+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:28.790+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:28.793+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:28.793+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:28.807+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:28.826+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:28.843+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:28.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:28.845+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d4f2775]
2026-01-22T15:37:28.845+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:28.846+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:28.859+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b1bbbb1] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:28.860+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:28.877+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:28.881+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:28.883+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1028101361 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:28.888+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:28.898+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:28.906+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:28.911+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:28.909+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:28.911+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:28.912+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:28.929+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:28.912+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:28.929+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:28.943+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:28.982+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:29.013+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.034+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62fd6ed9] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:29.054+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:29.056+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:29.058+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70fa1e0d] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:29.058+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1966822542 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:29.059+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:29.102+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:29.110+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:29.113+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1169416226 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:29.123+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:29.124+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b1bbbb1]
2026-01-22T15:37:29.142+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:29.154+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:29.162+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:29.162+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:29.166+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:29.172+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.173+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:29.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:29.177+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.179+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:29.179+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:29.189+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62fd6ed9]
2026-01-22T15:37:29.190+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:29.195+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70fa1e0d]
2026-01-22T15:37:29.196+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:29.206+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:29.209+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@215bc45b] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:29.209+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@116243c8] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:29.209+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:29.216+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1302637741 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:29.217+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:29.222+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@417361051 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:29.226+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:29.227+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:29.237+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:29.227+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:29.228+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:29.239+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:29.240+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:29.243+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:29.267+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:29.292+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:29.299+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:29.304+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@215bc45b]
2026-01-22T15:37:29.303+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.306+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:29.308+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:29.325+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.326+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:29.327+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:29.327+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:29.328+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:29.330+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:29.334+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:29.368+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4bcad982] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:29.370+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:29.372+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:29.384+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@116243c8]
2026-01-22T15:37:29.393+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@177900389 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:29.402+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:29.422+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.425+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:29.429+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:29.430+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:29.433+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.435+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:29.472+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:29.437+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:29.467+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:29.473+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@b514839] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:29.473+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:29.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:29.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1347302196 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:29.477+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.486+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.482+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:29.616+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:29.671+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:29.730+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:29.733+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:29.748+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@268410ca] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:29.748+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:29.752+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4bcad982]
2026-01-22T15:37:29.759+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:29.759+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:29.760+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:29.761+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:29.761+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:29.818+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:29.818+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.820+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1821013091 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:29.820+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:29.853+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:29.851+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:29.852+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:29.853+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@b514839]
2026-01-22T15:37:29.855+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:29.855+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:29.857+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:29.858+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:29.892+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5830ac95] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:29.899+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:29.921+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@203406637 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:29.910+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:29.912+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:29.921+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:29.927+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:29.941+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@268410ca]
2026-01-22T15:37:29.953+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:29.954+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:29.956+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:29.974+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:29.975+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:29.977+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.015+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:30.027+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:30.036+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.042+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:30.042+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:30.043+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:30.044+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:30.046+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@133efeba] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:30.054+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@654516413 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:30.052+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:30.055+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:30.059+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:30.064+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:30.069+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.151+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.153+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:30.131+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:30.143+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5830ac95]
2026-01-22T15:37:30.146+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:30.157+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4524d922] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:30.158+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:30.159+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:30.163+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:30.160+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@146359874 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:30.161+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f00e516] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:30.170+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:30.174+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.172+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:30.174+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2003493188 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:30.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.216+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:30.220+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:30.222+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:30.222+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:30.225+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@133efeba]
2026-01-22T15:37:30.226+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:30.228+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16c4361e] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:30.254+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:30.255+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@807719236 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:30.256+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:30.258+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:30.262+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:30.275+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:30.279+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4524d922]
2026-01-22T15:37:30.284+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:30.290+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:30.296+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:30.297+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f00e516]
2026-01-22T15:37:30.298+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:30.299+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:30.301+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:30.309+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:30.312+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:30.325+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:30.338+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:30.354+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:30.355+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:30.385+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16c4361e]
2026-01-22T15:37:30.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:30.388+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:30.389+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:30.393+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:30.395+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:30.395+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:30.398+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:30.470+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:30.502+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:30.507+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:30.507+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.508+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.541+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.549+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.550+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:30.551+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:30.551+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e95870d] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:30.551+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@144f0c2] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:30.552+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@537013500 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:30.552+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1364669780 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:30.552+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:30.601+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:30.611+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:30.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:30.641+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:30.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:30.651+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@144f0c2]
2026-01-22T15:37:30.651+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e95870d]
2026-01-22T15:37:30.651+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:30.652+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:30.653+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d2131b2] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:30.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:30.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@994377780 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:30.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:30.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:30.657+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:30.694+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:30.703+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d2131b2]
2026-01-22T15:37:30.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:30.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:30.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:30.737+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:30.797+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:30.809+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:30.814+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:30.825+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:30.836+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.837+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:30.838+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:30.841+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b3eb357] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:30.859+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1675558108 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:30.871+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:30.873+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:30.896+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:30.909+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b3eb357]
2026-01-22T15:37:30.914+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:30.915+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cb40839] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:30.918+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@714884687 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:30.923+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:30.940+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:30.978+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:30.987+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cb40839]
2026-01-22T15:37:30.988+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:31.016+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:31.018+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:34.114+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/1
2026-01-22T15:37:34.114+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/users/me/signatures
2026-01-22T15:37:34.120+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/1
2026-01-22T15:37:34.120+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/users/me/signatures
2026-01-22T15:37:34.129+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:37:34.210+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/users/me/signatures
2026-01-22T15:37:34.211+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/1
2026-01-22T15:37:34.304+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:37:34.304+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/users/me/signatures
2026-01-22T15:37:34.308+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/1
2026-01-22T15:37:34.335+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:37:34.337+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/users/me/signatures
2026-01-22T15:37:34.338+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/1
2026-01-22T15:37:34.338+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:37:34.339+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/users/me/signatures", parameters={}
2026-01-22T15:37:34.339+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/1", parameters={}
2026-01-22T15:37:34.346+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:37:34.346+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#getMySignatures()
2026-01-22T15:37:34.358+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:34.358+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseDetail(Long)
2026-01-22T15:37:34.359+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@576b85af] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:34.360+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:34.359+09:00  INFO 56396 --- [http-nio-8080-exec-1] c.i.backend.controller.UserController    : 내 서명/도장 목록 조회 요청 - userId: 12, companyId: 1
2026-01-22T15:37:34.361+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@629df77e] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:34.361+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:34.378+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71a74d97] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:34.378+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1882764212 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:34.388+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:37:34.389+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@207704482 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:34.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:37:34.392+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1348253186 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:34.392+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseReportById        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ?
2026-01-22T15:37:34.394+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.U.findByUserId                   : ==>  Preparing: SELECT * FROM user_signature_tb WHERE user_id = ? AND company_id = ? ORDER BY is_default DESC, created_at DESC
2026-01-22T15:37:34.395+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseReportById        : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:34.395+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.U.findByUserId                   : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:37:34.397+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:37:34.400+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@576b85af]
2026-01-22T15:37:34.402+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseReportById        : <==      Total: 1
2026-01-22T15:37:34.406+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:34.409+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@629df77e]
2026-01-22T15:37:34.420+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:37:34.420+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:34.442+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@679cf84c] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:34.442+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:34.443+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@437377645 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:34.444+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : ==>  Preparing: SELECT expense_detail_id, expense_report_id, category, merchant_name, description, amount, actual_paid_amount, payment_method, payment_req_date, card_number, is_pre_approval, note, is_tax_deductible, non_deductible_reason, company_id FROM expense_detail_tb WHERE expense_report_id = ? AND company_id = ?
2026-01-22T15:37:34.488+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:34.492+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.U.findByUserId                   : <==      Total: 0
2026-01-22T15:37:34.508+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71a74d97]
2026-01-22T15:37:34.523+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : <==      Total: 1
2026-01-22T15:37:34.534+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:34.541+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@679cf84c]
2026-01-22T15:37:34.555+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=서명/도장 목록 조회 성공, data=[])]
2026-01-22T15:37:34.562+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:34.602+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/users/me/signatures
2026-01-22T15:37:34.629+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/users/me/signatures
2026-01-22T15:37:34.675+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/users/me/signatures
2026-01-22T15:37:34.704+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/users/me/signatures", parameters={}
2026-01-22T15:37:34.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:34.712+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#getMySignatures()
2026-01-22T15:37:34.721+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5]
2026-01-22T15:37:34.721+09:00  INFO 56396 --- [http-nio-8080-exec-6] c.i.backend.controller.UserController    : 내 서명/도장 목록 조회 요청 - userId: 12, companyId: 1
2026-01-22T15:37:34.728+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1115182413 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will be managed by Spring
2026-01-22T15:37:34.729+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:34.729+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectExpenseList  : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:37:34.730+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@537da760] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:34.734+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectExpenseList  : ==> Parameters: 1(Long)
2026-01-22T15:37:34.735+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1911746541 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:34.740+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.U.findByUserId                   : ==>  Preparing: SELECT * FROM user_signature_tb WHERE user_id = ? AND company_id = ? ORDER BY is_default DESC, created_at DESC
2026-01-22T15:37:34.745+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.U.findByUserId                   : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:37:34.759+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectExpenseList  : <==      Total: 41
2026-01-22T15:37:34.802+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5]
2026-01-22T15:37:34.804+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.U.findByUserId                   : <==      Total: 0
2026-01-22T15:37:34.841+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5] from current transaction
2026-01-22T15:37:34.876+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@537da760]
2026-01-22T15:37:34.926+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : ==>  Preparing: SELECT expense_detail_id, expense_report_id, category, merchant_name, description, amount, actual_paid_amount, payment_method, payment_req_date, card_number, is_pre_approval, note, is_tax_deductible, non_deductible_reason, company_id FROM expense_detail_tb WHERE expense_report_id = ? AND company_id = ?
2026-01-22T15:37:34.936+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:34.936+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=서명/도장 목록 조회 성공, data=[])]
2026-01-22T15:37:34.936+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:34.941+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:34.987+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : <==      Total: 1
2026-01-22T15:37:34.991+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5]
2026-01-22T15:37:34.995+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5] from current transaction
2026-01-22T15:37:34.996+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-22T15:37:35.010+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.088+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : <==      Total: 3
2026-01-22T15:37:35.096+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5]
2026-01-22T15:37:35.112+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5] from current transaction
2026-01-22T15:37:35.119+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:37:35.121+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:37:35.144+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:37:35.156+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5]
2026-01-22T15:37:35.169+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5] from current transaction
2026-01-22T15:37:35.172+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseDetailId : ==>  Preparing: SELECT r.*, u.korean_name AS uploadedByName FROM receipt_tb r JOIN user_tb u ON r.uploaded_by = u.user_id WHERE r.expense_detail_id = ? AND r.company_id = ? ORDER BY r.uploaded_at DESC
2026-01-22T15:37:35.175+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseDetailId : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.219+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseDetailId : <==      Total: 0
2026-01-22T15:37:35.228+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5]
2026-01-22T15:37:35.234+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5]
2026-01-22T15:37:35.240+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5]
2026-01-22T15:37:35.251+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@535c43f5]
2026-01-22T15:37:35.269+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:35.270+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d46f99f] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:35.270+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2046527162 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:35.272+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-22T15:37:35.274+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.277+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : <==      Total: 3
2026-01-22T15:37:35.278+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d46f99f]
2026-01-22T15:37:35.279+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:35.280+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77fc907e] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:35.283+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@488379679 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:35.284+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseReportId : ==>  Preparing: SELECT r.*, u.korean_name AS uploadedByName FROM receipt_tb r JOIN user_tb u ON r.uploaded_by = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ? ORDER BY r.uploaded_at DESC
2026-01-22T15:37:35.285+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseReportId : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.289+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseReportId : <==      Total: 1
2026-01-22T15:37:35.290+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77fc907e]
2026-01-22T15:37:35.294+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:35.299+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c741ebf] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:35.300+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1335368239 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:35.303+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:37:35.303+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:37:35.306+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:37:35.309+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c741ebf]
2026-01-22T15:37:35.310+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:35.330+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=상세 조회 성공, data=ExpenseReportDto(expenseReportId=1, drafterId=2, re (truncated)...]
2026-01-22T15:37:35.354+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:35.395+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/1
2026-01-22T15:37:35.440+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/1
2026-01-22T15:37:35.453+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/1
2026-01-22T15:37:35.470+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/1", parameters={}
2026-01-22T15:37:35.471+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseDetail(Long)
2026-01-22T15:37:35.472+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:35.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3aabdc41] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:35.509+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1036265281 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:35.525+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseReportById        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ?
2026-01-22T15:37:35.533+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseReportById        : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.563+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseReportById        : <==      Total: 1
2026-01-22T15:37:35.567+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3aabdc41]
2026-01-22T15:37:35.569+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:35.572+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@9158bc1] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:35.575+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@956749594 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:35.576+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetails           : ==>  Preparing: SELECT expense_detail_id, expense_report_id, category, merchant_name, description, amount, actual_paid_amount, payment_method, payment_req_date, card_number, is_pre_approval, note, is_tax_deductible, non_deductible_reason, company_id FROM expense_detail_tb WHERE expense_report_id = ? AND company_id = ?
2026-01-22T15:37:35.578+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetails           : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.590+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetails           : <==      Total: 1
2026-01-22T15:37:35.592+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@9158bc1]
2026-01-22T15:37:35.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:35.620+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118]
2026-01-22T15:37:35.621+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@586257658 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will be managed by Spring
2026-01-22T15:37:35.623+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectExpenseList  : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:37:35.626+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectExpenseList  : ==> Parameters: 1(Long)
2026-01-22T15:37:35.657+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectExpenseList  : <==      Total: 41
2026-01-22T15:37:35.661+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118]
2026-01-22T15:37:35.662+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118] from current transaction
2026-01-22T15:37:35.663+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetails           : ==>  Preparing: SELECT expense_detail_id, expense_report_id, category, merchant_name, description, amount, actual_paid_amount, payment_method, payment_req_date, card_number, is_pre_approval, note, is_tax_deductible, non_deductible_reason, company_id FROM expense_detail_tb WHERE expense_report_id = ? AND company_id = ?
2026-01-22T15:37:35.669+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetails           : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.688+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetails           : <==      Total: 1
2026-01-22T15:37:35.690+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118]
2026-01-22T15:37:35.693+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118] from current transaction
2026-01-22T15:37:35.696+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-22T15:37:35.709+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectApprovalLines            : <==      Total: 3
2026-01-22T15:37:35.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118]
2026-01-22T15:37:35.726+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118] from current transaction
2026-01-22T15:37:35.726+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:37:35.729+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:37:35.762+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:37:35.776+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118]
2026-01-22T15:37:35.776+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118] from current transaction
2026-01-22T15:37:35.777+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] .i.b.m.E.selectReceiptsByExpenseDetailId : ==>  Preparing: SELECT r.*, u.korean_name AS uploadedByName FROM receipt_tb r JOIN user_tb u ON r.uploaded_by = u.user_id WHERE r.expense_detail_id = ? AND r.company_id = ? ORDER BY r.uploaded_at DESC
2026-01-22T15:37:35.778+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] .i.b.m.E.selectReceiptsByExpenseDetailId : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.791+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] .i.b.m.E.selectReceiptsByExpenseDetailId : <==      Total: 0
2026-01-22T15:37:35.794+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118]
2026-01-22T15:37:35.802+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118]
2026-01-22T15:37:35.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118]
2026-01-22T15:37:35.813+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@82ef118]
2026-01-22T15:37:35.892+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:35.893+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69619384] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:35.896+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1899802177 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:35.898+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-22T15:37:35.909+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.922+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectApprovalLines            : <==      Total: 3
2026-01-22T15:37:35.925+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69619384]
2026-01-22T15:37:35.926+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:35.926+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@29135b5c] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:35.928+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1275793481 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:35.936+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] .i.b.m.E.selectReceiptsByExpenseReportId : ==>  Preparing: SELECT r.*, u.korean_name AS uploadedByName FROM receipt_tb r JOIN user_tb u ON r.uploaded_by = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ? ORDER BY r.uploaded_at DESC
2026-01-22T15:37:35.944+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] .i.b.m.E.selectReceiptsByExpenseReportId : ==> Parameters: 1(Long), 1(Long)
2026-01-22T15:37:35.951+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] .i.b.m.E.selectReceiptsByExpenseReportId : <==      Total: 1
2026-01-22T15:37:35.953+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@29135b5c]
2026-01-22T15:37:35.954+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:35.955+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b995cc0] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:35.956+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1491284820 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:35.957+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-22T15:37:35.958+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-22T15:37:35.973+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-22T15:37:35.977+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b995cc0]
2026-01-22T15:37:35.978+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:35.986+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=상세 조회 성공, data=ExpenseReportDto(expenseReportId=1, drafterId=2, re (truncated)...]
2026-01-22T15:37:35.990+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:36.545+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:37:36.548+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:36.549+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:36.549+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:36.551+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:36.553+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:37:36.557+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:37:36.554+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:36.556+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:36.556+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:36.558+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:37:36.558+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:36.558+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:36.558+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:36.559+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:36.559+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:37:36.559+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:36.559+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:36.560+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:36.560+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:36.561+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:36.562+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:36.562+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:36.563+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:36.563+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:36.563+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19600a21] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:36.563+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.564+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.564+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:36.566+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.568+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.579+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.587+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.588+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@756002856 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:36.589+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.590+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:36.591+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:36.592+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.592+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:37:36.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:36.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7089ad0] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:36.595+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63c32f22] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:36.595+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:36.602+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:37:36.603+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20848a2e] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:36.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4eab30d9] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:36.619+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1150035182 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:36.620+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1886712268 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:36.621+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:36.622+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:36.623+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@330111724 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:37:36.623+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@394759460 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:37:36.623+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:37:36.624+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:36.625+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:36.625+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:36.625+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:36.625+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19600a21]
2026-01-22T15:37:36.626+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:36.628+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:36.629+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:36.634+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:37:36.638+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:36.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:36.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:36.643+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7089ad0]
2026-01-22T15:37:36.643+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63c32f22]
2026-01-22T15:37:36.644+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:36.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:36.657+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:36.658+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:36.659+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:36.660+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:36.663+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:36.701+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20848a2e]
2026-01-22T15:37:36.666+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:36.680+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:36.685+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:36.701+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:36.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a5586a5] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:36.703+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4eab30d9]
2026-01-22T15:37:36.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:36.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:36.711+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@911442441 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:37:36.712+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:36.720+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:36.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:36.728+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:36.741+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:36.744+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:36.745+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:36.746+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:36.752+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:36.754+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:36.755+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:36.757+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.758+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.759+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.760+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.761+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:36.762+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:36.777+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:36.777+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62cd7501] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:36.784+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1172930712 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:36.778+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3dcd08e] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:36.783+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:36.786+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1657968311 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:36.785+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:36.786+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:36.786+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:36.807+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:36.808+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:36.841+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:36.853+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:36.858+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a5586a5]
2026-01-22T15:37:36.863+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:36.878+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:36.878+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.882+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:36.889+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:36.890+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:36.891+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62cd7501]
2026-01-22T15:37:36.892+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:36.893+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:36.901+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:36.911+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:36.912+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:36.923+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69b461c3] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:36.924+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3dcd08e]
2026-01-22T15:37:36.925+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:36.927+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1464634674 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:36.928+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:36.929+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:36.929+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:36.930+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:36.930+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:36.933+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:36.935+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:36.936+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:36.939+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:36.979+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:36.980+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:37.005+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:36.996+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:37.006+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:37.007+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:37.046+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:37.047+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.070+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:37.070+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:37.073+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69b461c3]
2026-01-22T15:37:37.073+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.079+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:37.085+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:37.086+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:37.096+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:37.094+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:37.096+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.097+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:37.100+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.100+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@11ed9eec] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:37.104+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.104+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:37.105+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.107+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@273274245 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:37.107+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:37.108+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:37.121+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:37.122+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:37.123+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b977c00] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:37.123+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75e8f4d2] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:37.124+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:37.128+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1075373578 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:37.129+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@79891457 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:37.129+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:37.140+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:37.140+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:37.140+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:37.157+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:37.142+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:37.157+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:37.158+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:37.166+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:37.172+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.172+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@11ed9eec]
2026-01-22T15:37:37.172+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.177+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:37.235+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b977c00]
2026-01-22T15:37:37.237+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:37.179+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:37.190+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:37.244+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75e8f4d2]
2026-01-22T15:37:37.191+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:37.243+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:37.244+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@37da7dcf] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:37.244+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:37.253+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@52ad75bc] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:37.255+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:37.280+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1253936934 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:37.290+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:37.282+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:37.287+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:37.290+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1367671176 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:37.305+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:37.293+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:37.299+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:37.304+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:37.307+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:37.307+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:37.312+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:37.318+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:37.323+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:37.325+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:37.326+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:37.333+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:37.334+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@37da7dcf]
2026-01-22T15:37:37.334+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.338+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:37.340+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:37.340+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:37.342+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.343+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@52ad75bc]
2026-01-22T15:37:37.344+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:37.363+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:37.382+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:37.458+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:37.465+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.468+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@cfc94c8] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:37.468+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:37.470+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:37.481+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:37.492+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:37.494+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:37.482+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.502+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:37.486+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2126610745 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:37.496+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:37.504+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c512666] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:37.517+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:37.518+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:37.519+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:37.524+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:37.522+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:37.524+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:37.525+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:37.526+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.559+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:37.571+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1407255843 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:37:37.571+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:37.572+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.613+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:37.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:37.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@cfc94c8]
2026-01-22T15:37:37.619+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:37.619+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.620+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:37.623+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:37.624+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@17edc3f9] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:37.644+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:37.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:37.657+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:37.662+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c512666]
2026-01-22T15:37:37.659+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:37.662+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:37.663+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:37.673+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1f8de025] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:37.674+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1630420404 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:37:37.692+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:37.701+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@375520168 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:37.701+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:37.702+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:37.703+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:37.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:37.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:37.751+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:37.771+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:37.772+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@17edc3f9]
2026-01-22T15:37:37.788+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1f8de025]
2026-01-22T15:37:37.789+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:37.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:37.822+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@27e82b63] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:37.823+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:37.824+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@74174034 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:37:37.825+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:37.825+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:37.827+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:37.839+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:37.843+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@27e82b63]
2026-01-22T15:37:37.846+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:37.852+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:37.854+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:37.858+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:37.879+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:37.953+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:38.005+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:38.027+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:38.029+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:38.035+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:38.040+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:38.054+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78476600] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:38.059+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1802230544 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:38.060+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:38.061+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:38.068+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:38.071+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78476600]
2026-01-22T15:37:38.084+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:38.087+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21df5a87] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:38.091+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1759845435 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:38.098+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:38.099+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:38.109+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:38.113+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21df5a87]
2026-01-22T15:37:38.117+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:38.120+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:38.122+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:40.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:40.656+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:40.658+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:40.660+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:40.666+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:40.668+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:40.669+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:40.686+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:40.691+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:40.692+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:40.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:40.722+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:40.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:40.738+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:40.746+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:40.752+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:40.753+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:40.753+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:40.753+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:40.754+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:40.753+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:40.754+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:40.755+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:40.755+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:40.755+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:40.756+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:40.756+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:40.756+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:40.757+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:40.758+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:40.758+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:40.759+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10919d05] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:40.759+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:40.760+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43b4aa26] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:40.760+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3cc3f2b2] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:40.762+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@203385a2] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:40.773+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@302016862 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:40.773+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1360456029 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:40.773+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1652671355 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:37:40.773+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1468600531 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:40.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:40.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:40.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:40.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:40.777+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:40.778+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:40.780+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:40.787+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:40.796+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:40.796+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:40.796+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:40.802+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@203385a2]
2026-01-22T15:37:40.802+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43b4aa26]
2026-01-22T15:37:40.804+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:40.805+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3cc3f2b2]
2026-01-22T15:37:40.826+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:40.826+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:40.827+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10919d05]
2026-01-22T15:37:40.827+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:40.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:40.845+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:40.846+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:40.846+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1615c46a] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:40.859+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:40.882+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:40.884+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:40.954+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1722202651 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:40.984+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:40.987+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:40.988+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:41.003+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:41.006+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1615c46a]
2026-01-22T15:37:41.008+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:41.010+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:41.012+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:42.636+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:42.636+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:42.636+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:42.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:42.649+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:42.649+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:42.651+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:42.652+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:42.652+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:42.653+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:42.653+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:42.662+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:42.664+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:42.665+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:42.665+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:42.670+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:42.671+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:42.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:42.678+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:42.679+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:42.696+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:42.696+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:42.696+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:42.704+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:42.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:42.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:42.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:42.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:42.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:42.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:42.720+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:42.722+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:42.722+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f3e2b9c] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:42.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6117a3c5] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:42.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c867414] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:42.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@263174e0] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:42.730+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@632699366 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:42.730+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1464563175 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:42.731+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1025964667 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:37:42.731+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1340619009 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:42.736+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:42.737+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:42.737+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:42.737+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:42.738+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:42.739+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:42.743+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:42.745+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:42.762+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:42.762+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:42.762+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:42.771+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6117a3c5]
2026-01-22T15:37:42.772+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c867414]
2026-01-22T15:37:42.772+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:42.772+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f3e2b9c]
2026-01-22T15:37:42.773+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:42.773+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:42.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@263174e0]
2026-01-22T15:37:42.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:42.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:42.776+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3659289] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:42.776+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:42.776+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:42.777+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:42.778+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1283686493 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:37:42.780+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:42.788+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:42.795+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:42.796+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:42.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:42.824+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:42.827+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3659289]
2026-01-22T15:37:42.828+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:42.829+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:42.835+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:51.870+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:37:51.871+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:37:51.871+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:51.872+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:51.946+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:37:52.066+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:37:52.170+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:37:52.273+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:37:52.423+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:37:52.539+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:37:52.665+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:37:52.792+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:37:52.858+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:37:52.877+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:37:52.878+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:37:52.878+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:37:52.879+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:37:52.880+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:37:52.891+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:37:52.892+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:37:52.892+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:52.936+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:52.963+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:52.964+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:52.965+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:52.967+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:52.968+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:52.987+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:37:52.987+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:52.988+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:53.036+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:53.067+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:53.122+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@518400a1] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:53.136+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@658d13cb] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:53.136+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ef57c99] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:53.141+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@534a3387] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:53.268+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1838340919 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:37:53.305+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:37:53.307+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:37:53.318+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1270535776 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:53.324+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@788455585 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:37:53.324+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2124001723 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:37:53.413+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:37:53.414+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:37:53.423+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:37:53.425+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:37:53.426+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:37:53.439+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@518400a1]
2026-01-22T15:37:53.448+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:37:53.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:37:53.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:53.457+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:37:53.461+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:53.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:37:53.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:37:53.476+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:37:53.481+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ef57c99]
2026-01-22T15:37:53.486+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@534a3387]
2026-01-22T15:37:53.487+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@658d13cb]
2026-01-22T15:37:53.487+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:37:53.487+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:53.487+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:53.490+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63ab1bdc] was not registered for synchronization because synchronization is not active
2026-01-22T15:37:53.490+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:37:53.490+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:37:53.491+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@641552203 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:37:53.492+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:53.494+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:37:53.494+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:37:53.507+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:37:53.514+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:37:53.518+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63ab1bdc]
2026-01-22T15:37:53.519+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:37:53.520+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:37:53.521+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:04.333+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:04.352+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:04.352+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:04.356+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:04.369+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:04.371+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:04.372+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:04.371+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:04.372+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:04.373+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:04.373+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:04.374+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:04.374+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:04.375+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:04.378+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:04.378+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:04.379+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:04.379+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:04.384+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:04.384+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:04.389+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:04.385+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:04.385+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:04.386+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:04.392+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:04.393+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:04.393+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:04.394+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:04.405+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:04.409+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:04.409+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:04.428+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64361019] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:04.429+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@451fed27] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:04.437+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3841e9bb] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:04.442+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:04.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2515cdd9] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:04.457+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@775183521 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:04.457+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1056681816 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:04.457+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1135655899 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:04.459+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:04.461+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:04.461+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:04.463+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:04.467+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:04.469+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:04.487+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@64335502 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:04.526+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:04.527+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:04.528+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:04.529+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:04.529+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:04.542+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@451fed27]
2026-01-22T15:38:04.545+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3841e9bb]
2026-01-22T15:38:04.545+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64361019]
2026-01-22T15:38:04.547+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:04.550+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:04.551+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:04.551+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:04.551+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:04.552+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e744112] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:04.553+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:04.554+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:04.559+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1682497148 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:04.559+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:04.572+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:04.573+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2515cdd9]
2026-01-22T15:38:04.576+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:04.578+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:04.579+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:04.590+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:04.607+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:04.625+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e744112]
2026-01-22T15:38:04.629+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:04.638+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:04.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:07.915+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:07.917+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:07.918+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:07.934+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:07.936+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:07.937+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:07.935+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:07.937+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:07.938+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:07.939+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:07.939+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:07.941+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:08.010+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:08.055+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:08.058+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:08.072+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:08.071+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:08.072+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:08.072+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:08.073+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:08.074+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:08.074+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:08.085+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57c6592f] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:08.074+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:08.075+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:08.085+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:08.090+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:08.091+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:08.091+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:08.091+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:08.091+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@58b9ac42] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:08.092+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:08.092+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@29d165ea] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:08.106+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:08.107+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:08.113+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1715226706 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:08.119+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b57b65f] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:08.120+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:08.129+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@414516786 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:08.129+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1449042551 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:08.130+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:08.138+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:08.139+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:08.143+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1610340318 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:08.155+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:08.155+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:08.155+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:08.157+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:08.159+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:08.171+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57c6592f]
2026-01-22T15:38:08.173+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:08.174+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:08.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:08.187+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@29d165ea]
2026-01-22T15:38:08.188+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@58b9ac42]
2026-01-22T15:38:08.189+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:08.191+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:08.192+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:08.193+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:08.194+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b57b65f]
2026-01-22T15:38:08.203+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:08.205+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:08.206+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6d5492ab] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:08.300+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:08.301+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@655034373 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:08.302+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:08.217+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:08.304+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:08.304+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:08.306+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:08.369+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:08.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6d5492ab]
2026-01-22T15:38:08.399+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:08.407+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:08.429+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:11.511+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:11.512+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:11.512+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:11.512+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:11.516+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:11.526+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:11.531+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:11.516+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:11.521+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:11.522+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:11.533+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:11.535+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:11.543+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:11.545+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:11.547+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:11.549+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:11.550+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:11.551+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:11.554+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:11.554+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:11.555+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:11.556+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:11.558+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:11.556+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:11.557+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:11.558+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:11.560+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:11.560+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31edd093] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:11.575+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:11.575+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:11.577+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:11.586+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:11.578+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:11.586+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71267732] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:11.586+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8318cf7] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:11.588+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@704c65ab] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:11.590+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1467404535 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:11.592+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:11.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:11.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@118078649 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:11.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1783332401 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:11.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1932601860 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:11.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:11.595+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:11.596+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:11.602+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:11.602+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:11.603+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:11.605+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:11.606+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31edd093]
2026-01-22T15:38:11.607+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:11.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:11.609+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:11.609+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:11.610+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:11.613+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:11.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8318cf7]
2026-01-22T15:38:11.619+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71267732]
2026-01-22T15:38:11.623+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@704c65ab]
2026-01-22T15:38:11.624+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:11.625+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:11.626+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c8f9d99] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:11.626+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:11.626+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:11.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@913913044 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:11.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:11.628+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:11.635+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:11.638+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:11.641+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:11.653+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:11.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c8f9d99]
2026-01-22T15:38:11.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:11.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:11.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:39.350+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:38:39.350+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/companies
2026-01-22T15:38:39.351+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:38:39.399+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:38:39.417+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:38:39.437+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:38:39.450+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:38:39.451+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:38:39.452+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:38:39.461+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:39.465+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@38581eab] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:39.455+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:38:39.467+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:38:39.470+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/companies
2026-01-22T15:38:39.557+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@249849806 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:39.559+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:38:39.561+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:38:39.562+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:38:39.564+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/companies
2026-01-22T15:38:39.565+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:38:39.572+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:39.572+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/companies
2026-01-22T15:38:39.578+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@28ef0dd3] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:39.582+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/companies", parameters={}
2026-01-22T15:38:39.584+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.CompanyController#getMyCompanies()
2026-01-22T15:38:39.589+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:39.591+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b40701] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:39.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@541723660 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:39.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:38:39.601+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:38:39.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@38581eab]
2026-01-22T15:38:39.610+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:38:39.610+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:39.623+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:38:39.625+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@39534833 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:39.638+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:39.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:38:39.667+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:38:39.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:39.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:39.689+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.U.findCompaniesByUserId          : ==>  Preparing: SELECT c.company_id AS companyId, c.company_code AS companyCode, c.company_name AS companyName, c.business_reg_no AS businessRegNo, c.representative_name AS representativeName, c.created_by AS createdBy, c.is_active AS isActive, c.created_at AS createdAt, c.updated_at AS updatedAt FROM company_tb c INNER JOIN user_company_tb uc ON c.company_id = uc.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' AND c.is_active = 1 ORDER BY uc.is_primary DESC, c.created_at DESC
2026-01-22T15:38:39.691+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:39.692+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@28ef0dd3]
2026-01-22T15:38:39.796+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:39.796+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:39.798+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:39.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.U.findCompaniesByUserId          : ==> Parameters: 12(Long)
2026-01-22T15:38:39.804+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:39.810+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:39.811+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:39.826+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:38:39.831+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:38:39.832+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:39.832+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:39.832+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:39.838+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:39.840+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.U.findCompaniesByUserId          : <==      Total: 2
2026-01-22T15:38:39.863+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b40701]
2026-01-22T15:38:39.847+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:39.867+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:39.847+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:39.869+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ApiResponse(success=true, message=조회 성공, data=[CompanyDto(companyId=1, companyCode=2C4PSB, companyNa (truncated)...]
2026-01-22T15:38:39.856+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:39.857+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:39.858+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:39.868+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:38:39.872+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:39.873+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:39.877+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:39.881+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:39.891+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:39.882+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:39.884+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:38:39.893+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:38:39.887+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:39.891+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:39.892+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:39.899+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:39.892+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:39.894+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:39.896+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:38:39.898+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:39.898+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:39.899+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:39.900+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:39.900+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:39.901+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:38:39.901+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:39.967+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:39.976+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:39.976+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:39.976+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:39.981+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:39.984+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:39.985+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:39.985+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:39.987+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:39.988+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:39.991+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b8e389a] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:39.991+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:39.992+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:39.995+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.002+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.006+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.009+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.009+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.016+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.017+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.018+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.018+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.033+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.033+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@846830621 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:40.040+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@73a6aec0] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.041+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@24395aa0] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.043+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.054+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.058+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4553cdad] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.058+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:38:40.061+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1614519905 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:40.061+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2060256707 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:40.061+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62fa4f01] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.062+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@502e1b57] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.068+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@368012446 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:40.069+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:38:40.072+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:40.072+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:40.076+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:40.078+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:40.080+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:40.081+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:40.088+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1796159658 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:38:40.088+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@57994436 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:40.091+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:40.092+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:40.092+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:40.093+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:38:40.094+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:40.102+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:40.106+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:40.107+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@73a6aec0]
2026-01-22T15:38:40.108+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4553cdad]
2026-01-22T15:38:40.108+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b8e389a]
2026-01-22T15:38:40.108+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@24395aa0]
2026-01-22T15:38:40.109+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:40.110+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.110+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.111+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.111+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.112+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c445b3] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.119+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:40.120+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:38:40.121+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:40.122+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:40.122+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:40.123+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@481062544 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:40.124+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.144+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:40.125+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.138+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.140+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62fa4f01]
2026-01-22T15:38:40.140+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@502e1b57]
2026-01-22T15:38:40.170+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.148+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:40.152+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:40.155+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:40.169+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:40.170+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.187+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:40.170+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:40.172+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:40.174+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:40.187+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:40.188+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.190+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.193+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:40.193+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:40.198+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:40.203+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:40.205+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:40.208+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:40.220+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:40.223+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:40.220+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:40.221+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c445b3]
2026-01-22T15:38:40.221+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:40.223+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:40.223+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:40.224+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:40.225+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:40.226+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.227+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.226+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:40.226+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:40.227+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.227+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:40.228+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:40.229+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.231+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.236+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:40.243+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.244+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:40.245+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.250+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.255+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.255+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:40.256+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.270+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@28f39300] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.257+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.260+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:40.267+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6304a2be] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.268+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.283+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@149b3ac5] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.269+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.271+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2046731892 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:40.274+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.275+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1064750470 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:40.276+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:40.284+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1850789362 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:40.284+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.287+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:40.288+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.289+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:40.289+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:40.290+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:40.290+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.292+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:40.292+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a682390] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.293+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:40.294+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:40.304+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:40.306+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5eea9239] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.307+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@26063829 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:40.321+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:40.336+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:40.337+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:40.351+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@18151768 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:40.351+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:40.352+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.353+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:40.361+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6304a2be]
2026-01-22T15:38:40.370+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@28f39300]
2026-01-22T15:38:40.371+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:40.388+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:40.389+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.390+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@149b3ac5]
2026-01-22T15:38:40.390+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.399+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.401+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:40.402+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.403+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.404+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32e07b79] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.404+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:40.405+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79745c1c] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.406+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:40.406+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1949777609 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:40.415+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:40.407+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.419+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:40.414+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@626117185 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:40.416+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.420+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:40.421+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:40.425+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:38:40.427+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:40.430+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:40.431+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:40.432+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:38:40.432+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:40.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:40.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.476+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.452+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:38:40.460+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:40.460+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:40.460+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:40.461+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:40.477+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.477+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:38:40.479+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32e07b79]
2026-01-22T15:38:40.487+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5eea9239]
2026-01-22T15:38:40.492+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.488+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79745c1c]
2026-01-22T15:38:40.488+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a682390]
2026-01-22T15:38:40.488+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3250df4e] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.491+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:38:40.493+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.493+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:40.497+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.523+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f562cdc] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.500+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.501+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1705296872 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:40.521+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.522+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:40.523+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.526+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1419314582 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:40.527+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:40.527+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:40.565+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13f56fa0] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.568+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.572+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:40.578+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:40.604+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.624+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:40.607+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:40.607+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1593127433 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:40.620+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:40.621+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:40.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:40.636+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:40.637+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:40.633+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:38:40.633+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:40.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:38:40.637+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:40.638+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:40.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:40.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:40.641+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:40.641+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:40.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:40.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:40.643+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.644+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.650+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.653+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.656+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.675+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.736+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.704+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:38:40.704+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:40.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:40.716+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.736+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6ff267c7] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.736+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@277a858] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.736+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13f56fa0]
2026-01-22T15:38:40.737+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3250df4e]
2026-01-22T15:38:40.737+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f562cdc]
2026-01-22T15:38:40.737+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6d69e932] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:40.738+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@421035813 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:40.739+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.739+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.739+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.740+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1554365084 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:40.752+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:40.752+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:38:40.752+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:40.752+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:40.753+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:40.754+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:40.768+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.771+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.774+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:40.777+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:40.787+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:40.790+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:38:40.792+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:40.797+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:40.911+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:40.800+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@145462497 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:38:40.845+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:40.845+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:40.894+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:40.914+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:40.915+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:40.953+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:40.916+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:40.917+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@277a858]
2026-01-22T15:38:40.934+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6d69e932]
2026-01-22T15:38:40.948+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:40.957+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:40.958+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:40.952+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:38:40.955+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:40.956+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:40.956+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:40.960+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:40.965+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:41.010+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:38:41.041+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:38:41.019+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:41.036+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f82a116] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:41.039+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:41.043+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:38:41.043+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:41.044+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1611196374 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:41.045+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:41.053+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:38:41.095+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:41.133+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c1b990a] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:41.134+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:41.138+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:41.138+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:41.138+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:41.144+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:41.328+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1418744493 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:41.339+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6ff267c7]
2026-01-22T15:38:41.355+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:41.356+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:41.356+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76904e0b] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:41.356+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:41.356+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:41.357+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:41.368+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:41.380+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:41.381+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:41.382+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:41.386+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:41.386+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@339975408 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:41.387+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:41.387+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:41.388+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:41.403+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f82a116]
2026-01-22T15:38:41.404+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:38:41.409+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:41.410+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:41.422+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:41.435+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c1b990a]
2026-01-22T15:38:41.425+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:41.427+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:41.432+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:38:41.432+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a131b11] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:41.434+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:41.436+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:41.442+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:41.453+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:41.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:41.455+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@543305520 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:41.459+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:41.455+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:41.455+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:41.476+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:41.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:41.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:41.464+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:41.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f04a4f8] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:41.490+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:41.495+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:41.507+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:41.507+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:41.507+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:41.508+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:41.508+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55e50a0d] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:41.508+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:41.509+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:41.509+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1643844944 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:41.510+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:41.510+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:41.511+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:41.511+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:41.511+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:41.513+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:41.513+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15f1c8d1] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:41.515+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@729757311 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:41.516+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:41.517+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:41.525+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:38:41.525+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76904e0b]
2026-01-22T15:38:41.526+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:41.526+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:38:41.527+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:41.578+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:41.579+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1084640066 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:41.582+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:41.582+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:41.604+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15f1c8d1]
2026-01-22T15:38:41.604+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:41.605+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a131b11]
2026-01-22T15:38:41.606+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55e50a0d]
2026-01-22T15:38:41.606+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:41.607+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:41.607+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:41.607+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:41.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:41.609+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:41.611+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:41.610+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a16acd9] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:41.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:41.619+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1197370612 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:41.692+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:41.692+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:41.692+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f04a4f8]
2026-01-22T15:38:41.703+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:41.704+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:41.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:41.745+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:41.773+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:41.787+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a16acd9]
2026-01-22T15:38:41.798+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:41.800+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:41.801+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:42.801+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:42.809+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:42.809+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:42.809+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:42.894+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:42.894+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:42.896+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:42.896+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:42.907+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:42.908+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:42.928+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:42.928+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:42.928+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:42.929+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:42.929+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:42.931+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:42.931+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:42.939+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:42.939+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:42.939+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:42.940+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:42.940+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:42.943+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:42.954+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:42.955+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:42.955+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:42.956+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:42.958+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:42.959+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:42.959+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:42.959+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:42.961+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:42.964+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:42.966+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:42.967+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:42.967+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c61ddfa] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:42.967+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:42.968+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74bc3f1f] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:42.969+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46621ea1] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:42.971+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35c32e28] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:42.973+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@743906933 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:42.976+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:42.976+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@435018961 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:42.977+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@265353444 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:42.979+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:42.979+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:42.980+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:42.984+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@915457130 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:42.990+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:42.991+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:42.991+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:43.000+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:43.002+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:43.002+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:43.004+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74bc3f1f]
2026-01-22T15:38:43.004+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c61ddfa]
2026-01-22T15:38:43.005+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:43.005+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:43.006+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:43.007+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:43.007+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:43.007+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46621ea1]
2026-01-22T15:38:43.008+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:43.008+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:43.008+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:43.011+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f589d02] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:43.015+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:43.021+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35c32e28]
2026-01-22T15:38:43.021+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1974683140 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:43.023+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:43.025+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:43.025+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:43.027+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:43.027+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:43.039+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:43.040+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f589d02]
2026-01-22T15:38:43.041+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:43.042+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:43.043+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:45.318+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:45.323+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:45.323+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:45.330+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:45.346+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:45.347+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:45.360+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:45.347+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:45.352+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:45.360+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:45.366+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:45.368+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:45.383+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:45.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:45.407+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:45.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:45.406+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:45.407+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:45.408+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:45.408+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:45.409+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:45.419+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:45.422+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:45.433+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:45.439+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:45.440+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:45.444+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:45.444+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:45.449+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:45.454+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:45.454+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:45.454+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:45.455+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:45.455+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:45.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64c1d5d7] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:45.466+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1261870a] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:45.471+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:45.472+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:45.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2cc2f0c6] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:45.476+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7fe88931] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:45.483+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@859984097 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:38:45.484+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1583633152 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:45.490+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:45.490+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:45.491+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:45.493+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:45.499+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@13491808 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:45.499+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@315293124 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:45.505+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:45.510+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:45.510+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:45.511+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:45.518+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:45.521+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:45.522+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64c1d5d7]
2026-01-22T15:38:45.524+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1261870a]
2026-01-22T15:38:45.527+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:45.528+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:45.529+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:45.530+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:45.534+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:45.538+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:45.543+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:45.544+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:45.554+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2cc2f0c6]
2026-01-22T15:38:45.555+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7fe88931]
2026-01-22T15:38:45.557+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:45.557+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:45.557+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19a2e89c] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:45.558+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:45.560+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1645225276 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:45.561+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:45.567+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:45.582+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:45.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:45.616+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19a2e89c]
2026-01-22T15:38:45.617+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:45.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:45.619+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:46.698+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:46.699+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:46.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:46.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:46.735+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:46.735+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:46.751+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:46.736+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:46.736+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:46.767+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:46.770+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:46.786+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:46.788+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:46.789+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:46.789+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:46.790+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:46.792+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:46.795+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:46.798+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:46.800+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:46.801+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:46.802+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:46.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:46.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:46.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:46.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:46.804+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:46.804+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:46.804+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:46.804+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:46.805+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:46.806+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:46.807+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:46.808+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:46.808+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b839bd0] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:46.809+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:46.809+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:46.809+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c72ca92] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:46.810+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@466b64ec] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:46.810+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b0ed69e] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:46.817+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@795917407 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:46.817+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1402846890 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:46.819+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:46.819+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:46.820+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@151217078 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:46.821+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:46.823+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:46.823+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:46.825+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1528959189 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:38:46.827+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:46.834+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:46.836+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:46.836+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:46.840+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c72ca92]
2026-01-22T15:38:46.840+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:46.840+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b839bd0]
2026-01-22T15:38:46.842+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:46.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:46.845+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:46.845+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:46.849+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:46.849+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@466b64ec]
2026-01-22T15:38:46.850+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:46.853+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:46.853+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:46.854+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:46.861+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b0ed69e]
2026-01-22T15:38:46.861+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:46.867+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:46.869+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:46.869+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19d1707e] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:46.875+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1472763586 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:38:46.878+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:46.884+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:46.887+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:46.888+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19d1707e]
2026-01-22T15:38:46.889+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:46.889+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:46.890+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:47.223+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:47.223+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:47.224+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:47.231+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:47.244+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:47.244+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:47.245+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:47.245+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:47.252+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:47.253+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:47.252+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:47.253+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:47.253+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:47.253+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:47.254+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:47.255+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:47.269+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:47.272+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:47.272+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:47.282+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:47.284+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:47.285+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:47.285+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:47.286+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:47.292+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:47.293+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:47.293+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:47.320+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:47.320+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:47.321+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:47.328+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:47.331+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:47.332+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:47.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26b4c899] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:47.335+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:47.373+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:47.390+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45863509] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:47.392+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:47.393+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e727ab6] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:47.394+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d2fac47] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:47.400+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1455731640 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:47.400+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2121586019 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:47.400+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@692815668 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:47.401+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:47.401+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:47.402+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:47.403+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:47.404+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:47.405+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2145941076 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:47.406+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:47.408+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:47.410+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:47.426+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:47.427+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:47.428+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:47.450+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45863509]
2026-01-22T15:38:47.451+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e727ab6]
2026-01-22T15:38:47.451+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26b4c899]
2026-01-22T15:38:47.452+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:47.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:47.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:47.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:47.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d2fac47]
2026-01-22T15:38:47.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:47.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:47.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f2b8991] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:47.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:47.476+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:47.477+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:47.482+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1075422658 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:47.487+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:47.541+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:47.553+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:47.562+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:47.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:38:47.598+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f2b8991]
2026-01-22T15:38:47.602+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:47.603+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:38:47.604+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:58.969+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:38:58.972+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:38:58.972+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/companies
2026-01-22T15:38:59.009+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:38:59.009+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/companies
2026-01-22T15:38:59.013+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:38:59.075+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:38:59.124+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:38:59.119+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/companies
2026-01-22T15:38:59.124+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:38:59.125+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:38:59.125+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/companies
2026-01-22T15:38:59.125+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:38:59.126+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:38:59.126+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/companies", parameters={}
2026-01-22T15:38:59.139+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:38:59.153+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.CompanyController#getMyCompanies()
2026-01-22T15:38:59.153+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.154+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:38:59.156+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.159+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4592b3e9] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.161+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.163+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4aa6ce40] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.166+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c185000] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.172+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@673230921 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:59.173+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:38:59.174+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@785066449 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:59.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:38:59.181+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.U.findCompaniesByUserId          : ==>  Preparing: SELECT c.company_id AS companyId, c.company_code AS companyCode, c.company_name AS companyName, c.business_reg_no AS businessRegNo, c.representative_name AS representativeName, c.created_by AS createdBy, c.is_active AS isActive, c.created_at AS createdAt, c.updated_at AS updatedAt FROM company_tb c INNER JOIN user_company_tb uc ON c.company_id = uc.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' AND c.is_active = 1 ORDER BY uc.is_primary DESC, c.created_at DESC
2026-01-22T15:38:59.184+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1214225288 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:59.187+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.U.findCompaniesByUserId          : ==> Parameters: 12(Long)
2026-01-22T15:38:59.188+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:38:59.191+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:38:59.193+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:38:59.194+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:38:59.195+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.U.findCompaniesByUserId          : <==      Total: 2
2026-01-22T15:38:59.195+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4592b3e9]
2026-01-22T15:38:59.197+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c185000]
2026-01-22T15:38:59.198+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4aa6ce40]
2026-01-22T15:38:59.200+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.201+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.203+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.203+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:38:59.203+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:38:59.204+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ApiResponse(success=true, message=조회 성공, data=[CompanyDto(companyId=1, companyCode=2C4PSB, companyNa (truncated)...]
2026-01-22T15:38:59.204+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.204+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.206+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.257+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:38:59.286+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:38:59.306+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:38:59.307+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:38:59.308+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:38:59.308+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:38:59.309+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.320+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@41d54fc2] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.321+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1122496501 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:59.322+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:38:59.323+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:38:59.326+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:38:59.341+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@41d54fc2]
2026-01-22T15:38:59.345+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.358+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:38:59.360+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:38:59.392+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:59.393+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:59.445+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:59.454+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.455+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:59.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:59.457+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:59.466+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.482+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:38:59.483+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:59.483+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:59.484+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:59.485+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.485+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:38:59.506+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:38:59.506+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:59.506+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.507+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:38:59.507+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:59.512+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:59.513+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:38:59.515+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:59.515+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:59.517+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.520+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:59.521+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:38:59.521+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:59.526+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:59.530+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:59.530+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.531+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:59.533+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:38:59.534+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:59.534+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:59.535+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:59.535+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.535+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:59.539+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:38:59.539+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:59.540+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:59.540+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:59.541+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:59.541+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:59.542+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.542+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:59.542+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:59.554+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:59.560+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:59.567+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.567+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@497a12dd] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.567+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.568+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.568+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.568+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.569+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.573+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.574+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.575+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.576+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.576+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.577+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.577+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.580+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.582+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.583+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1318081989 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:59.584+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57721b7e] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.585+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5adb7bef] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.585+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@377b3765] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.586+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b484848] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.586+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44f26ccf] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.586+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:38:59.587+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1018361101 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:59.588+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1821560771 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:59.588+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@874465050 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:59.591+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:38:59.591+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:59.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:59.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:59.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1388213101 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:59.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1346774155 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:38:59.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:59.610+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:59.611+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:59.619+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:59.620+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:59.622+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:59.622+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:59.626+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:38:59.635+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@497a12dd]
2026-01-22T15:38:59.636+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:59.636+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:59.636+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:59.645+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44f26ccf]
2026-01-22T15:38:59.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.641+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:59.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:59.643+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@377b3765]
2026-01-22T15:38:59.645+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57721b7e]
2026-01-22T15:38:59.649+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.666+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:38:59.666+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5adb7bef]
2026-01-22T15:38:59.666+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b484848]
2026-01-22T15:38:59.667+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.667+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.667+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:59.672+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.678+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:59.687+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:59.688+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.689+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:59.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:59.709+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:59.732+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.714+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:38:59.721+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:59.734+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.738+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:59.741+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:59.744+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.746+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:38:59.747+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:59.749+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:59.752+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:59.758+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:59.763+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.763+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:38:59.764+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:59.766+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:59.767+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:59.768+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:59.768+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.769+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:38:59.769+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:59.771+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:59.778+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:59.783+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:59.787+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:38:59.787+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:38:59.788+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.790+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:38:59.790+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:59.790+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:59.790+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:38:59.791+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.791+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.793+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:38:59.793+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.793+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.794+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.794+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3ecc00a8] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.801+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.802+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.805+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.808+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@356070968 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:38:59.808+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@fa00f96] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.809+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.811+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.811+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.817+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.823+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@748b7fd5] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.825+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@712145679 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:38:59.826+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:38:59.818+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:38:59.820+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@501271708 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:59.821+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.822+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@72791012] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.822+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f30a790] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.829+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:38:59.831+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:38:59.832+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:59.834+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45095a0a] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.835+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1798633391 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:38:59.837+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@326064992 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:38:59.840+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:59.843+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@283023075 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:59.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:38:59.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:38:59.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:38:59.850+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3ecc00a8]
2026-01-22T15:38:59.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:38:59.845+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:38:59.845+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@748b7fd5]
2026-01-22T15:38:59.849+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:38:59.851+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.851+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:38:59.852+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:38:59.875+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.875+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:38:59.877+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:59.885+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:38:59.890+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.892+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:38:59.893+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:38:59.894+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:38:59.900+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@fa00f96]
2026-01-22T15:38:59.900+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.904+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:38:59.907+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@72791012]
2026-01-22T15:38:59.907+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45095a0a]
2026-01-22T15:38:59.908+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f30a790]
2026-01-22T15:38:59.908+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.911+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:38:59.920+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:38:59.920+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.920+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:38:59.921+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:38:59.921+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e0823d3] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.941+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:38:59.941+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:38:59.941+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4fa04d87] was not registered for synchronization because synchronization is not active
2026-01-22T15:38:59.942+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:38:59.942+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:38:59.943+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@559629627 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:38:59.948+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:38:59.949+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.950+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1089898355 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:38:59.960+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:59.956+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:38:59.959+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:38:59.959+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:38:59.959+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:38:59.962+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.967+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:59.972+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:38:59.975+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:38:59.977+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:38:59.979+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:38:59.981+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:38:59.989+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:38:59.990+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:38:59.992+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.002+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:39:00.003+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:39:00.004+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.005+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:39:00.006+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:39:00.006+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4fa04d87]
2026-01-22T15:39:00.022+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:39:00.006+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:39:00.007+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.015+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:39:00.021+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:39:00.022+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@409bddc9] was not registered for synchronization because synchronization is not active
2026-01-22T15:39:00.023+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:39:00.025+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:39:00.026+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:39:00.026+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e0823d3]
2026-01-22T15:39:00.026+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:39:00.027+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1127373001 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:39:00.029+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:39:00.034+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.034+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3fc6c0ea] was not registered for synchronization because synchronization is not active
2026-01-22T15:39:00.035+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:39:00.036+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.036+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:39:00.042+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:39:00.052+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.102+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1044627710 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:39:00.141+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:39:00.144+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.146+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:39:00.155+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:39:00.150+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:39:00.150+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:39:00.152+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:39:00.154+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:39:00.156+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c8220c9] was not registered for synchronization because synchronization is not active
2026-01-22T15:39:00.171+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@460093900 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:39:00.156+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16810807] was not registered for synchronization because synchronization is not active
2026-01-22T15:39:00.156+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:39:00.167+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:39:00.171+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:39:00.172+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:39:00.173+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2016400813 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:39:00.181+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:39:00.173+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:39:00.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:39:00.177+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:39:00.183+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:39:00.183+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:39:00.184+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:39:00.185+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.186+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:39:00.186+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.199+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:39:00.204+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:39:00.207+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:39:00.220+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@409bddc9]
2026-01-22T15:39:00.221+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.221+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@614a4c20] was not registered for synchronization because synchronization is not active
2026-01-22T15:39:00.222+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:39:00.222+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:39:00.231+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:39:00.233+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:39:00.234+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:39:00.257+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1063115233 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:39:00.257+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16810807]
2026-01-22T15:39:00.257+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c8220c9]
2026-01-22T15:39:00.257+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:39:00.258+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:39:00.258+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3fc6c0ea]
2026-01-22T15:39:00.258+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:39:00.259+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:39:00.268+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:39:00.269+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:39:00.269+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e124c42] was not registered for synchronization because synchronization is not active
2026-01-22T15:39:00.270+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:39:00.271+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:39:00.292+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:39:00.342+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@489b3066] was not registered for synchronization because synchronization is not active
2026-01-22T15:39:00.356+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1640560514 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:39:00.356+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:39:00.357+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:39:00.358+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@97699284 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:39:00.368+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:39:00.358+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:39:00.363+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:39:00.371+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:39:00.373+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:39:00.431+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:39:00.444+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@614a4c20]
2026-01-22T15:39:00.452+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:39:00.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:39:00.457+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@489b3066]
2026-01-22T15:39:00.473+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:39:00.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:39:00.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:39:00.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:39:00.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:39:00.494+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:39:00.537+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e124c42]
2026-01-22T15:39:00.555+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:39:00.556+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@755ca4f] was not registered for synchronization because synchronization is not active
2026-01-22T15:39:00.557+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1534715579 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:39:00.557+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:39:00.567+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:39:00.610+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:39:00.613+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@755ca4f]
2026-01-22T15:39:00.638+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:39:00.643+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:39:00.644+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:26.316+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:46:26.331+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:46:26.332+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:46:26.333+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:46:26.337+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:26.341+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:46:26.510+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:46:26.590+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:46:26.631+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:26.632+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:46:26.632+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/companies
2026-01-22T15:46:26.633+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:46:26.633+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:46:26.638+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:46:26.728+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:46:26.777+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:26.848+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:46:26.898+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:46:26.899+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:46:26.899+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:26.899+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:46:26.902+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:46:26.903+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:46:27.130+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:46:27.237+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:46:27.237+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:46:27.241+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:27.240+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:46:27.241+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:27.305+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:46:27.349+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:46:27.422+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:46:27.506+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:46:27.574+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:46:27.653+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:46:27.693+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:46:27.760+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:46:27.833+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:46:27.895+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:27.906+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:46:27.906+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:27.907+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:46:27.907+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:46:27.956+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:46:27.972+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:46:27.972+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:46:27.972+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:46:28.023+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:46:28.112+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:28.125+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:28.125+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:46:28.126+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:46:28.126+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:46:28.127+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:28.128+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46c53fa7] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:28.383+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:28.193+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f675549] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:28.258+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:28.338+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:28.379+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:28.386+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:28.388+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:28.413+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:28.480+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@605949320 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:46:28.480+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1108444932 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:46:28.567+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:28.695+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@22e3305e] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:28.794+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:28.800+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:28.816+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:46:28.817+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:46:28.818+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:28.842+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@216b75a0] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:28.842+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20873264] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:28.843+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:46:28.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:46:28.932+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4091a8db] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:28.933+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@545633192 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:29.023+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@959494236 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:46:29.035+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1875453244 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:29.039+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:46:29.039+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:46:29.040+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:46:29.041+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:46:29.042+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:46:29.043+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:46:29.058+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2041174757 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:46:29.058+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:46:29.058+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:46:29.063+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:46:29.063+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46c53fa7]
2026-01-22T15:46:29.063+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:46:29.064+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:46:29.065+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:46:29.073+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f675549]
2026-01-22T15:46:29.110+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:46:29.110+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:29.156+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@216b75a0]
2026-01-22T15:46:29.162+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@22e3305e]
2026-01-22T15:46:29.165+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20873264]
2026-01-22T15:46:29.166+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:29.166+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:46:29.169+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:29.178+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:29.179+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:29.180+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:46:29.181+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:29.190+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@461e5e4c] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:29.191+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:46:29.191+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:46:29.199+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:29.205+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:46:29.221+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:46:29.228+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1563699061 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:46:29.229+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:29.232+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:29.241+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:46:29.277+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4091a8db]
2026-01-22T15:46:29.282+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:46:29.290+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:46:29.325+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:29.338+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:29.345+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:46:29.361+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:29.377+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:46:29.388+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:46:29.390+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:46:29.390+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:46:29.433+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:46:29.439+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:46:29.442+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:46:29.462+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:29.463+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:29.463+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:46:29.464+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:46:29.473+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:29.476+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:46:29.477+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:46:29.477+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:46:29.477+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:46:29.481+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@461e5e4c]
2026-01-22T15:46:29.482+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/companies
2026-01-22T15:46:29.491+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:29.496+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:46:29.497+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:46:29.514+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:29.515+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:29.546+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:29.524+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:29.525+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/companies
2026-01-22T15:46:29.535+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:29.545+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:29.547+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:46:29.549+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:29.547+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:29.548+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:29.548+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/companies
2026-01-22T15:46:29.549+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:29.553+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:29.557+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:29.563+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45c349ea] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:29.564+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43084c39] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:29.598+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1868917477 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:46:29.564+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/companies", parameters={}
2026-01-22T15:46:29.565+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:29.566+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:46:29.579+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@36a5b0ad] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:29.598+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2034974154 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:46:29.598+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:46:29.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.CompanyController#getMyCompanies()
2026-01-22T15:46:29.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d15cf8b] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:29.610+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:46:29.610+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1064167171 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:29.658+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:46:29.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:46:29.712+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:46:29.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:29.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:46:29.711+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:46:29.714+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6568a8b8] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:29.714+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:46:29.716+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:46:29.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:46:29.726+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:29.779+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:46:29.779+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@780927310 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:46:29.780+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:46:29.780+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1231388842 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:29.781+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76acfa29] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:29.791+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@36a5b0ad]
2026-01-22T15:46:29.799+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:46:29.830+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.U.findCompaniesByUserId          : ==>  Preparing: SELECT c.company_id AS companyId, c.company_code AS companyCode, c.company_name AS companyName, c.business_reg_no AS businessRegNo, c.representative_name AS representativeName, c.created_by AS createdBy, c.is_active AS isActive, c.created_at AS createdAt, c.updated_at AS updatedAt FROM company_tb c INNER JOIN user_company_tb uc ON c.company_id = uc.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' AND c.is_active = 1 ORDER BY uc.is_primary DESC, c.created_at DESC
2026-01-22T15:46:29.843+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43084c39]
2026-01-22T15:46:29.894+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:46:29.897+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:29.898+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45c349ea]
2026-01-22T15:46:29.941+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1967195483 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:46:29.941+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.U.findCompaniesByUserId          : ==> Parameters: 12(Long)
2026-01-22T15:46:29.949+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:29.950+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:46:29.996+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:46:29.999+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:29.999+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:46:30.047+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:46:30.049+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.U.findCompaniesByUserId          : <==      Total: 2
2026-01-22T15:46:30.111+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:30.113+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:46:30.141+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:46:30.160+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:46:30.179+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6568a8b8]
2026-01-22T15:46:30.179+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:30.259+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:46:30.306+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d15cf8b]
2026-01-22T15:46:30.349+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:30.412+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:30.433+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:46:30.440+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:46:30.444+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:30.445+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:46:30.445+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ApiResponse(success=true, message=조회 성공, data=[CompanyDto(companyId=1, companyCode=2C4PSB, companyNa (truncated)...]
2026-01-22T15:46:30.445+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76acfa29]
2026-01-22T15:46:30.479+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:30.528+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:46:30.577+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@276b0d5d] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:30.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:46:30.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:46:30.641+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:30.649+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:30.693+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:46:30.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1981570704 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:30.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:46:30.727+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:46:30.741+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:46:30.742+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:30.742+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:46:30.743+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:46:30.743+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:46:30.756+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:30.832+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:30.925+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:46:31.142+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:46:31.162+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:31.180+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:31.230+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:46:31.238+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:46:31.279+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:46:31.331+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:31.360+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:46:31.389+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:31.428+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:31.448+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:31.476+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:46:31.571+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:31.581+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@276b0d5d]
2026-01-22T15:46:31.582+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:31.582+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:46:31.583+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:31.583+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:46:31.641+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@259cdef3] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:31.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:31.687+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7456cf0f] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:31.687+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:46:31.688+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:31.726+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:46:31.794+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:46:31.796+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:31.798+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:31.796+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7913d11c] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:31.797+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:46:31.798+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:31.909+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:31.911+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4bf7b1ce] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:31.824+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:46:31.830+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1063821025 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:46:31.928+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:46:31.830+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1247952013 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:31.935+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:46:31.850+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@555128192 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:31.899+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:31.925+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:46:31.932+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:46:31.938+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:46:32.005+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:46:32.012+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1911202953 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:46:32.055+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4aa36ae7] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:32.113+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:46:32.259+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:46:32.274+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:46:32.291+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:46:32.315+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:46:32.331+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:46:32.331+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7456cf0f]
2026-01-22T15:46:32.348+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@259cdef3]
2026-01-22T15:46:32.349+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:46:32.392+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@34090724 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:46:32.404+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:46:32.410+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:46:32.502+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:32.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:32.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:46:32.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:32.709+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7913d11c]
2026-01-22T15:46:32.720+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:46:32.727+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:46:32.728+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:46:32.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:46:32.851+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:32.821+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:32.827+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:32.838+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4bf7b1ce]
2026-01-22T15:46:32.850+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:32.862+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:46:32.929+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:32.930+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:46:32.900+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:32.905+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:46:32.909+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1103f24b] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:32.909+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:32.930+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:46:32.931+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2eadfa7a] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:32.931+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:46:32.931+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4aa36ae7]
2026-01-22T15:46:32.932+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1988053574 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:32.932+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:46:32.942+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:46:32.943+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@801444370 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:46:32.943+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:32.968+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:32.969+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:46:32.970+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:32.974+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:46:32.971+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:46:32.972+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:46:32.973+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:46:32.978+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:46:32.973+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:46:32.975+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:32.977+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:46:32.979+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:32.979+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:32.979+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:32.980+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:32.981+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:33.021+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:33.022+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-22T15:46:33.063+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:46:33.063+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:46:33.115+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:33.414+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2eadfa7a]
2026-01-22T15:46:33.206+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@610d2b4a] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:33.249+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:46:33.360+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:46:33.415+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:33.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1103f24b]
2026-01-22T15:46:33.414+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78fab9e0] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:33.414+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:33.416+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:46:33.416+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:33.443+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:46:33.511+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2049492452 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:46:33.727+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@490581665 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:46:33.782+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:46:33.847+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:46:33.890+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:46:33.991+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:46:33.992+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:46:33.994+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:34.071+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:34.113+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:34.120+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:34.123+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:46:34.124+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:46:34.127+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:46:34.150+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-22T15:46:34.166+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:34.167+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:46:34.271+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-22T15:46:34.272+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:46:34.273+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:34.276+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:46:34.378+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:46:34.380+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:46:34.416+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-22T15:46:34.447+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:46:34.459+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7197ade] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:34.498+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@610d2b4a]
2026-01-22T15:46:34.509+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:46:34.511+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78fab9e0]
2026-01-22T15:46:34.512+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-22T15:46:34.512+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:46:34.515+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:34.515+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:46:34.524+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:34.525+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-22T15:46:34.525+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:46:34.530+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:46:34.530+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:46:34.533+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@91639791 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:46:34.535+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@578c7734] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:34.544+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:34.564+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:46:34.577+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:34.577+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:34.578+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:46:34.579+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@773805174 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:46:34.580+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48fddc94] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:34.626+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:34.632+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:34.664+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:34.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:46:34.673+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:46:34.673+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:46:34.675+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:34.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:34.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:34.679+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:46:34.680+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:34.680+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@24446368] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:34.680+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:46:34.711+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@603918749 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:34.712+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:46:34.712+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:46:34.729+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2effa192] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:34.755+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:46:34.755+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-22T15:46:34.755+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7197ade]
2026-01-22T15:46:34.762+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@107921320 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:34.788+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@578c7734]
2026-01-22T15:46:34.794+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@677064468 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:46:34.861+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:34.872+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-22T15:46:34.889+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:34.907+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:46:34.908+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:34.908+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:46:34.909+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:34.911+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:46:34.913+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:46:34.961+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-22T15:46:34.970+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:46:34.981+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:46:34.982+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:35.018+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:35.102+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48fddc94]
2026-01-22T15:46:35.109+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:35.110+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-22T15:46:35.103+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:35.104+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69531f3e] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:35.108+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:35.111+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:35.123+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:46:35.146+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@24446368]
2026-01-22T15:46:35.147+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:35.147+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:46:35.145+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:46:35.149+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:35.151+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:35.161+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:46:35.164+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:46:35.179+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:46:35.179+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2effa192]
2026-01-22T15:46:35.180+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:35.180+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:35.181+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:35.181+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:46:35.182+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:35.183+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:35.183+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4bac5a4a] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:35.186+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@177407855 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:35.188+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@306702238 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:46:35.257+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:46:35.280+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:46:35.323+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:46:35.381+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:46:35.449+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:46:35.460+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4bac5a4a]
2026-01-22T15:46:35.467+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:46:35.472+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:35.472+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69531f3e]
2026-01-22T15:46:35.472+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:46:35.472+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:35.478+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:35.478+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@191c3321] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:35.482+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1106257823 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:46:35.489+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:46:35.507+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:46:35.555+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:46:35.560+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@191c3321]
2026-01-22T15:46:35.583+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:35.592+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:46:35.600+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:37.388+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-22T15:46:37.395+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-22T15:46:37.395+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:37.395+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-22T15:46:37.552+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-22T15:46:37.588+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:46:37.590+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-22T15:46:37.591+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-22T15:46:37.592+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:46:37.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:37.621+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:37.644+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:37.645+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-22T15:46:37.716+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3cf9dc5] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:37.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:37.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:37.763+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:46:37.774+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-22T15:46:37.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:46:37.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-22T15:46:37.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:46:37.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-22T15:46:37.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:46:37.804+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-22T15:46:37.810+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1663447332 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:46:37.815+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:46:37.815+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:37.828+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-22T15:46:37.829+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-22T15:46:37.829+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:46:37.830+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:37.830+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:46:37.831+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-22T15:46:37.831+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:37.832+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:37.832+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:37.866+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:37.866+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59845f7c] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:37.929+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:37.930+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:46:37.969+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:38.051+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@747168582 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:38.053+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:38.121+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3cf9dc5]
2026-01-22T15:46:38.129+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44e7c3e] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:38.235+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:46:38.319+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26f4f242] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:38.379+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:38.607+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@829248424 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:38.672+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-22T15:46:38.980+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@75925022 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:46:38.980+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:46:39.132+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:46:39.248+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:46:39.253+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:46:39.256+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:39.257+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:46:39.324+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-22T15:46:39.388+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59845f7c]
2026-01-22T15:46:39.616+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:39.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:46:39.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:46:39.666+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:46:39.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26f4f242]
2026-01-22T15:46:39.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44e7c3e]
2026-01-22T15:46:39.678+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:39.678+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:39.678+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:39.678+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:46:39.679+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7510c841] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:39.758+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:39.796+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1577791770 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:39.812+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:46:39.830+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-22T15:46:39.904+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:46:39.922+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7510c841]
2026-01-22T15:46:39.926+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:39.929+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:46:39.932+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:45.189+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01
2026-01-22T15:46:45.191+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01
2026-01-22T15:46:45.192+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&status%5B%5D=APPROVED
2026-01-22T15:46:45.195+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01
2026-01-22T15:46:45.246+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01
2026-01-22T15:46:45.246+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01
2026-01-22T15:46:45.246+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&status%5B%5D=APPROVED
2026-01-22T15:46:45.247+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01
2026-01-22T15:46:45.265+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:46:45.305+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:46:45.317+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:46:45.319+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:46:45.320+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01
2026-01-22T15:46:45.321+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01
2026-01-22T15:46:45.321+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&status%5B%5D=APPROVED
2026-01-22T15:46:45.321+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01
2026-01-22T15:46:45.321+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01", parameters={masked}
2026-01-22T15:46:45.322+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01", parameters={masked}
2026-01-22T15:46:45.322+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:46:45.322+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01", parameters={masked}
2026-01-22T15:46:45.323+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:46:45.323+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:46:45.323+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:46:45.332+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:46:45.332+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:45.332+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:45.333+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:45.340+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:45.341+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:45.341+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:45.342+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:45.343+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:45.346+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:45.346+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:45.346+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:45.346+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:45.346+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7287bba1] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:45.347+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b1f8a46] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:45.347+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7fc1ccbe] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:45.347+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71ba8a8d] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:45.358+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@974456743 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:46:45.358+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@193088659 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:46:45.358+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1766611421 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:46:45.360+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:46:45.361+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1848183956 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:45.362+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ?
2026-01-22T15:46:45.363+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:46:45.364+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate)
2026-01-22T15:46:45.389+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:46:45.392+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate)
2026-01-22T15:46:45.412+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:46:45.413+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate)
2026-01-22T15:46:45.441+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:46:45.442+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:46:45.442+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:46:45.442+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 17
2026-01-22T15:46:45.470+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7fc1ccbe]
2026-01-22T15:46:45.471+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71ba8a8d]
2026-01-22T15:46:45.471+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b1f8a46]
2026-01-22T15:46:45.471+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7287bba1]
2026-01-22T15:46:45.472+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:45.473+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:45.473+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:45.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:45.522+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62bab776] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:45.567+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:46:45.615+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1455099567 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:46:45.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:46:45.613+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:46:45.615+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:45.616+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:46:45.673+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:45.812+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:45.911+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), APPROVED(String)
2026-01-22T15:46:45.941+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:46:45.947+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62bab776]
2026-01-22T15:46:45.957+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:45.961+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:46:45.972+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:47.071+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:46:47.072+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:46:47.074+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:46:47.074+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:46:47.158+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:46:47.158+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:46:47.159+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:46:47.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:46:47.159+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:46:47.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:46:47.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:46:47.176+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:46:47.177+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:46:47.196+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:46:47.196+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:46:47.208+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:46:47.208+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:46:47.208+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:46:47.208+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:46:47.209+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:46:47.211+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:47.210+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:46:47.210+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:46:47.211+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:46:47.247+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:47.257+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:46:47.258+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:47.258+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:47.259+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:47.275+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:47.287+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:47.331+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:47.346+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@612069c1] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:47.355+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:47.356+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:47.356+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:47.358+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:47.360+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@66546c17] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:47.361+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@33fcfa72] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:47.399+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c1449db] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:47.403+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1671304415 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:47.426+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:46:47.429+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:46:47.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1949185174 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:46:47.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@313336579 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:47.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@113137151 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:46:47.486+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:46:47.486+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:46:47.486+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:46:47.487+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:46:47.546+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:46:47.564+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:46:47.565+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:46:47.565+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@612069c1]
2026-01-22T15:46:47.568+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:47.588+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:46:47.589+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:47.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 17
2026-01-22T15:46:47.617+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@66546c17]
2026-01-22T15:46:47.624+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:47.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:46:47.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:46:47.647+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:46:47.647+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c1449db]
2026-01-22T15:46:47.653+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@33fcfa72]
2026-01-22T15:46:47.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:47.657+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:47.661+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:47.669+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:46:47.670+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6fee4edb] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:47.673+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:47.674+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1838116041 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:47.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:46:47.689+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:46:47.699+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:46:47.703+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6fee4edb]
2026-01-22T15:46:47.704+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:47.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:46:47.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:54.285+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2025-12-01&endDate=2026-01-31
2026-01-22T15:46:54.286+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2025-12-01&endDate=2026-01-31
2026-01-22T15:46:54.287+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:46:54.289+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2026-01-31
2026-01-22T15:46:54.374+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2025-12-01&endDate=2026-01-31
2026-01-22T15:46:54.375+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2025-12-01&endDate=2026-01-31
2026-01-22T15:46:54.400+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:46:54.402+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2025-12-01&endDate=2026-01-31
2026-01-22T15:46:54.403+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:46:54.403+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2025-12-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:46:54.403+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2025-12-01&endDate=2026-01-31
2026-01-22T15:46:54.423+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:46:54.428+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:46:54.428+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2026-01-31
2026-01-22T15:46:54.439+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2025-12-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:46:54.458+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:54.460+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:46:54.506+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:46:54.513+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:46:54.513+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:54.522+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:46:54.528+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2026-01-31
2026-01-22T15:46:54.547+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:54.561+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:54.561+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2025-12-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:46:54.561+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:46:54.562+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:54.575+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4725def] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:54.575+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:46:54.591+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:46:54.595+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:54.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:54.613+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:54.613+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f6d6dff] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:54.613+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:54.614+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:54.630+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:54.639+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:54.639+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@617e0065] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:54.639+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a651de9] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:54.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1059060629 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:54.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@119328698 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:46:54.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:46:54.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:46:54.716+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1513310220 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:46:54.717+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1737484167 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:54.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:46:54.730+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:46:54.731+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:46:54.745+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:46:54.772+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:46:54.773+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:46:54.776+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:46:54.776+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4725def]
2026-01-22T15:46:54.777+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:54.792+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 27
2026-01-22T15:46:54.856+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=27, pendingCoun (truncated)...]
2026-01-22T15:46:54.857+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f6d6dff]
2026-01-22T15:46:54.858+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:54.859+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:54.861+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:46:54.866+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:54.882+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:46:54.882+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-22T15:46:54.960+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@617e0065]
2026-01-22T15:46:54.960+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a651de9]
2026-01-22T15:46:55.007+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:55.044+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:55.055+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@65fff8c5] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:55.055+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:46:55.057+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@820483175 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:55.070+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:55.070+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:46:55.073+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:46:55.108+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:46:55.121+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@65fff8c5]
2026-01-22T15:46:55.139+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:55.145+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:46:55.158+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:57.903+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:46:57.908+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:46:57.909+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED
2026-01-22T15:46:57.911+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:46:57.970+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:46:57.970+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:46:57.970+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED
2026-01-22T15:46:57.987+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:46:57.987+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:46:57.970+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:46:57.986+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:46:57.989+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:46:57.988+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:46:57.990+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED
2026-01-22T15:46:57.988+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:46:57.989+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:46:57.989+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:46:57.992+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:46:57.992+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:46:57.993+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:46:57.993+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:46:57.993+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:46:57.993+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:57.993+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:46:58.171+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:58.367+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:58.450+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:58.460+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:46:58.461+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:58.461+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:58.461+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:58.467+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:58.534+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:58.541+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:58.554+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4070e745] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:58.554+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:46:58.570+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2fefc0e4] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:58.572+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2adbb622] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:58.575+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:58.582+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2dda2d20] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:58.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@886380891 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:46:58.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1263023083 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:46:58.634+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1857088377 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:58.639+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:46:58.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:46:58.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:46:58.641+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:46:58.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:46:58.643+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:46:58.681+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1301167003 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:46:58.682+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:46:58.688+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:46:58.691+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:46:58.704+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:46:58.704+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 10
2026-01-22T15:46:58.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2fefc0e4]
2026-01-22T15:46:58.709+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2adbb622]
2026-01-22T15:46:58.709+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4070e745]
2026-01-22T15:46:58.709+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:58.709+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:46:58.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:58.711+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=10, pendingCoun (truncated)...]
2026-01-22T15:46:58.711+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@258a3212] was not registered for synchronization because synchronization is not active
2026-01-22T15:46:58.751+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@276812012 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:46:58.711+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=20, drafte (truncated)...]
2026-01-22T15:46:58.745+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:58.754+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:46:58.755+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:58.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate), APPROVED(String)
2026-01-22T15:46:58.777+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:46:58.818+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2dda2d20]
2026-01-22T15:46:58.836+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:58.853+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 3
2026-01-22T15:46:58.887+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:46:58.898+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@258a3212]
2026-01-22T15:46:58.899+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:46:58.899+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:46:58.902+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:46:58.906+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:26.168+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:26.169+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31&collectionStatus=false
2026-01-22T15:47:26.169+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED&taxProcessed=false
2026-01-22T15:47:26.169+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:26.436+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:26.454+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:47:26.458+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31&collectionStatus=false
2026-01-22T15:47:26.460+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:26.461+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:47:26.461+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:47:26.465+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:47:26.471+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED&taxProcessed=false
2026-01-22T15:47:26.473+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31&collectionStatus=false
2026-01-22T15:47:26.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:26.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:47:26.476+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31&collectionStatus=false", parameters={masked}
2026-01-22T15:47:26.501+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:26.509+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:26.509+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED&taxProcessed=false
2026-01-22T15:47:26.511+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:47:26.511+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:26.512+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:47:26.514+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED&taxProcessed=false", parameters={masked}
2026-01-22T15:47:26.517+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:26.529+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@37dbda5e] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:26.574+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:26.591+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:47:26.592+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:26.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:47:26.597+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:26.598+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:26.601+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@645e838b] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:26.599+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:47:26.601+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:26.603+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:26.603+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:26.604+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:26.604+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7699db1e] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:26.606+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@246243856 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:47:26.611+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:26.611+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:47:26.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70b0be05] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:26.613+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:47:26.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@66113686 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:47:26.625+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.tax_collected_at IS NULL AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:47:26.626+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:47:26.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1885430732 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:47:26.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1421108584 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:47:26.642+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:47:26.660+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:47:26.665+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:47:26.666+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@37dbda5e]
2026-01-22T15:47:26.678+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:47:26.678+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:47:26.680+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 0
2026-01-22T15:47:26.685+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:26.686+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@645e838b]
2026-01-22T15:47:26.686+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=10, pendingCoun (truncated)...]
2026-01-22T15:47:26.689+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:26.690+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:26.696+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[])]
2026-01-22T15:47:26.698+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:26.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:47:26.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:47:26.715+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70b0be05]
2026-01-22T15:47:26.732+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7699db1e]
2026-01-22T15:47:26.744+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:26.745+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:26.745+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:47:26.746+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69a63587] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:26.746+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:26.747+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1963330720 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:47:26.752+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) AND r.tax_processed = ? GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:47:26.760+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate), APPROVED(String), false(Boolean)
2026-01-22T15:47:26.768+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectCategorySummary          : <==      Total: 3
2026-01-22T15:47:26.769+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69a63587]
2026-01-22T15:47:26.770+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:26.771+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:47:26.772+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:30.495+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:30.496+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:30.504+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED
2026-01-22T15:47:30.504+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:30.564+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:30.564+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:30.565+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED
2026-01-22T15:47:30.569+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:30.572+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:47:30.581+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:47:30.641+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:47:30.645+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:30.645+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:30.646+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED
2026-01-22T15:47:30.646+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:47:30.646+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2025-12-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:47:30.647+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2025-12-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:47:30.647+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2025-12-01&endDate=2025-12-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:47:30.647+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31
2026-01-22T15:47:30.648+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:47:30.648+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:47:30.656+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:47:30.664+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2025-12-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:47:30.673+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:30.674+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:30.674+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:30.675+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:47:30.675+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:30.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:30.678+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:30.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:30.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:30.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:30.680+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a219bd] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:30.680+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:30.693+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:30.695+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@34f07b1a] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:30.695+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b0b456f] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:30.696+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:30.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@249088445 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:47:30.712+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15379d42] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:30.713+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:47:30.715+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@537286393 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:47:30.715+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1410379805 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:47:30.722+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:47:30.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:47:30.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:47:30.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:47:30.725+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:47:30.733+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1342187067 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:47:30.736+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:47:30.736+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 10
2026-01-22T15:47:30.740+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:47:30.741+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b0b456f]
2026-01-22T15:47:30.741+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a219bd]
2026-01-22T15:47:30.742+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:47:30.743+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:47:30.743+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:30.744+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:30.746+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@34f07b1a]
2026-01-22T15:47:30.746+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48578f83] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:30.749+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=20, drafte (truncated)...]
2026-01-22T15:47:30.754+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2108773432 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:47:30.749+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:30.755+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:30.756+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:47:30.761+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=10, pendingCoun (truncated)...]
2026-01-22T15:47:30.763+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2025-12-01(LocalDate), 2025-12-31(LocalDate), APPROVED(String)
2026-01-22T15:47:30.770+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:47:30.772+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:30.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15379d42]
2026-01-22T15:47:30.776+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:30.793+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-22T15:47:30.797+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:30.822+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 3
2026-01-22T15:47:30.823+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48578f83]
2026-01-22T15:47:30.830+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:30.832+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-22T15:47:30.838+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:36.408+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2025-12-31
2026-01-22T15:47:36.408+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2025-12-31
2026-01-22T15:47:36.424+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2025-12-31&status%5B%5D=APPROVED
2026-01-22T15:47:36.425+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2025-12-31
2026-01-22T15:47:36.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2025-12-31
2026-01-22T15:47:36.457+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2025-12-31
2026-01-22T15:47:36.463+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:47:36.463+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:47:36.471+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2025-12-31&status%5B%5D=APPROVED
2026-01-22T15:47:36.471+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2025-12-31
2026-01-22T15:47:36.473+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2025-12-31
2026-01-22T15:47:36.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2025-12-31
2026-01-22T15:47:36.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:47:36.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:47:36.475+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:47:36.476+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:47:36.500+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2025-12-31
2026-01-22T15:47:36.552+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2025-12-31&status%5B%5D=APPROVED
2026-01-22T15:47:36.560+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:47:36.564+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:47:36.571+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2025-12-31", parameters={masked}
2026-01-22T15:47:36.571+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2025-12-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:47:36.574+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:36.574+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:36.575+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:47:36.575+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:47:36.576+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:36.576+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:36.577+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:36.577+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:36.578+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:36.578+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:36.578+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:36.580+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:36.584+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@280906a] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:36.586+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3cccfb17] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:36.587+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:36.588+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:36.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6236cd77] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:36.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@22e96b25] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:36.597+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1092570152 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:47:36.597+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1784683154 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:47:36.602+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:47:36.602+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:47:36.603+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:47:36.607+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:47:36.605+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1628371780 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:47:36.605+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@795323710 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:47:36.607+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:47:36.608+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:47:36.609+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2025-12-31(LocalDate)
2026-01-22T15:47:36.610+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:47:36.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 0
2026-01-22T15:47:36.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 0
2026-01-22T15:47:36.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:47:36.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:47:36.614+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6236cd77]
2026-01-22T15:47:36.614+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3cccfb17]
2026-01-22T15:47:36.618+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@280906a]
2026-01-22T15:47:36.619+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@22e96b25]
2026-01-22T15:47:36.620+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:36.620+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:36.620+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:36.638+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:36.638+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[])]
2026-01-22T15:47:36.639+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[])]
2026-01-22T15:47:36.644+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=0, pendingCount (truncated)...]
2026-01-22T15:47:36.644+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@241579f6] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:36.657+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:36.657+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:36.658+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:36.658+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1639851642 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:47:36.673+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:47:36.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2025-12-31(LocalDate), APPROVED(String)
2026-01-22T15:47:36.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 0
2026-01-22T15:47:36.708+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@241579f6]
2026-01-22T15:47:36.709+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:36.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[])]
2026-01-22T15:47:36.711+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:40.587+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:47:40.587+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:47:40.587+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:47:40.588+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:47:40.625+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:47:40.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:47:40.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:47:40.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:47:40.639+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:47:40.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:47:40.640+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:47:40.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:47:40.647+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:47:40.649+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:47:40.651+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:47:40.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:47:40.656+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:47:40.668+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:47:40.669+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:47:40.669+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:47:40.671+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:47:40.671+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:47:40.671+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:47:40.672+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:40.672+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:47:40.672+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:40.673+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:40.673+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:40.674+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:40.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:40.679+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:40.687+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:40.688+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:47:40.688+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:40.689+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:40.689+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@412e9353] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:40.690+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:40.690+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10b1fcc9] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:40.692+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@494ec50a] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:40.693+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a5d0d38] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:40.697+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@47289422 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:47:40.697+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1472565705 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:47:40.697+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1229012736 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:47:40.697+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1435613405 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:47:40.698+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:47:40.700+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:47:40.701+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:47:40.702+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:47:40.703+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:47:40.704+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:47:40.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:47:40.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:47:40.711+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:47:40.714+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@494ec50a]
2026-01-22T15:47:40.718+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:47:40.719+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 17
2026-01-22T15:47:40.721+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10b1fcc9]
2026-01-22T15:47:40.719+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:47:40.721+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@412e9353]
2026-01-22T15:47:40.721+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:40.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:47:40.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1f183fcd] was not registered for synchronization because synchronization is not active
2026-01-22T15:47:40.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:40.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:47:40.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a5d0d38]
2026-01-22T15:47:40.725+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@399111404 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:47:40.725+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:47:40.726+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:40.727+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:40.727+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:47:40.728+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:40.737+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:47:40.743+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:47:40.744+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:47:40.763+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:47:40.766+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1f183fcd]
2026-01-22T15:47:40.766+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:47:40.767+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:47:40.767+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:06.223+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:06.230+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:06.230+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:06.230+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:06.413+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:06.493+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:06.572+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:06.571+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:48:06.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:48:06.589+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:48:06.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:06.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:06.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:06.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:06.595+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:06.595+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:48:06.596+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:48:06.596+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:48:06.596+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:48:06.597+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:06.630+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:06.670+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:06.704+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:06.755+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:06.838+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:48:06.843+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:06.849+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:06.851+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:06.851+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:06.906+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:06.970+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:07.039+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2fd596e0] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:07.052+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:07.063+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d3286d9] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:07.114+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14217006] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:07.206+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:48:07.209+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1570218298 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:48:07.245+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:07.246+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@240750183 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:48:07.247+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@118193153 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:48:07.256+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:48:07.270+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:07.288+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:48:07.319+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:48:07.356+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:07.363+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:07.439+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:48:07.529+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:07.603+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2d36fcba] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:07.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1722293414 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:48:07.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:48:07.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:48:07.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 17
2026-01-22T15:48:07.661+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:48:07.673+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2fd596e0]
2026-01-22T15:48:07.674+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14217006]
2026-01-22T15:48:07.674+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d3286d9]
2026-01-22T15:48:07.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:07.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:07.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:07.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:07.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:48:07.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@de177d] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:07.757+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:48:07.762+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:48:07.789+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:07.801+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:07.798+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2d36fcba]
2026-01-22T15:48:07.800+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@517919518 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:48:07.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:07.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:48:07.804+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:48:07.805+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:48:07.806+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:07.954+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:48:08.014+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@de177d]
2026-01-22T15:48:08.033+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:08.035+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:48:08.037+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:11.760+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:11.761+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:11.769+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:11.789+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:11.827+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:11.828+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:11.840+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:48:11.841+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:11.828+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:11.830+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:11.841+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:48:11.843+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:48:11.841+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:11.842+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:48:11.843+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:11.843+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:11.843+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:48:11.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:11.846+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:48:11.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:11.844+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:11.845+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:11.847+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:48:11.848+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:48:11.849+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:48:11.849+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:11.849+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:11.850+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:11.850+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:11.850+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:11.851+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:11.851+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:11.851+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:11.852+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ade6928] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:11.853+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:11.880+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:11.880+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d7bb9d1] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:11.880+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f420478] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:11.879+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:11.995+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1159069793 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:48:12.046+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@339094965 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:48:12.050+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f8903af] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:12.050+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:48:12.051+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:48:12.064+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:12.065+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:48:12.071+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1405196217 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:48:12.081+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:48:12.083+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:12.084+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:48:12.084+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2100565294 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:48:12.085+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:48:12.088+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d7bb9d1]
2026-01-22T15:48:12.088+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:48:12.088+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ade6928]
2026-01-22T15:48:12.089+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:12.091+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:12.091+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:48:12.092+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:12.092+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@18a6f7c3] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:12.093+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f420478]
2026-01-22T15:48:12.093+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:48:12.096+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@717208532 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:48:12.096+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:12.096+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:48:12.096+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:12.096+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:48:12.100+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:48:12.102+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:12.112+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 17
2026-01-22T15:48:12.118+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f8903af]
2026-01-22T15:48:12.120+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:12.120+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:48:12.121+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:48:12.123+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:12.126+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@18a6f7c3]
2026-01-22T15:48:12.138+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:12.139+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:48:12.141+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:28.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:28.713+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:28.714+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:28.714+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:28.882+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:28.922+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:28.945+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:48:28.997+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:29.042+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:48:29.078+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:29.099+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:48:29.088+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:29.096+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:29.102+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:48:29.105+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:29.111+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:29.112+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:29.127+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:29.128+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:48:29.128+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:48:29.135+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:29.129+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:48:29.130+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:29.132+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:48:29.136+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:29.137+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:29.161+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:48:29.173+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:29.175+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:29.175+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:29.175+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:29.238+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:29.311+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b3e99ce] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:29.324+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:29.325+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:29.325+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:29.326+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@254787fb] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:29.452+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:29.453+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@239121305 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:48:29.527+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c23d046] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:29.544+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@706ded07] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:29.561+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:48:29.571+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:29.586+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1833196005 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:48:29.624+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2009881763 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:48:29.624+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@282001194 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:48:29.628+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:48:29.628+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:48:29.629+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:48:29.632+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:29.636+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:48:29.637+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:29.664+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:48:29.680+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b3e99ce]
2026-01-22T15:48:29.691+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:48:29.691+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:48:29.691+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 17
2026-01-22T15:48:29.692+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:29.693+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@706ded07]
2026-01-22T15:48:29.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c23d046]
2026-01-22T15:48:29.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@254787fb]
2026-01-22T15:48:29.713+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:48:29.727+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:29.727+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:29.740+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:29.741+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:48:29.741+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:29.742+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2bfb846b] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:29.742+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:48:29.743+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:29.747+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1262196786 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:48:29.748+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:29.803+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:48:29.846+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:48:29.895+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:48:29.906+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2bfb846b]
2026-01-22T15:48:29.956+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:29.970+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:48:29.977+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:35.224+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:35.224+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:35.225+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:35.225+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:35.287+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:35.288+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:35.303+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:35.334+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:35.351+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:48:35.353+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:48:35.353+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:48:35.353+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:35.353+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:48:35.354+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:35.354+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:35.354+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:35.355+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:35.372+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:35.374+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:35.375+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:48:35.376+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:48:35.377+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:48:35.378+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:48:35.378+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:35.379+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:48:35.379+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:35.380+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:35.383+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:35.383+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:35.384+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:35.384+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:35.385+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:35.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:35.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:35.391+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:35.392+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7414e9ac] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:35.392+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:35.393+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3719795b] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:35.394+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26ddb6cc] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:35.394+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a4845cf] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:35.405+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1032586301 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:48:35.405+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1820180490 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:48:35.405+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@831994222 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:48:35.405+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1690223961 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:48:35.406+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:48:35.406+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:48:35.407+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:48:35.408+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:48:35.409+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:35.411+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:48:35.414+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:35.415+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:35.424+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:48:35.424+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:48:35.424+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 17
2026-01-22T15:48:35.424+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:48:35.425+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26ddb6cc]
2026-01-22T15:48:35.426+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a4845cf]
2026-01-22T15:48:35.426+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7414e9ac]
2026-01-22T15:48:35.427+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3719795b]
2026-01-22T15:48:35.428+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:35.428+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:35.429+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:35.429+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:35.429+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:48:35.430+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@259debd9] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:35.436+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:48:35.437+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1142817929 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:48:35.436+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:48:35.437+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:35.437+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:35.437+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:48:35.438+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:35.456+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:48:35.467+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:48:35.469+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@259debd9]
2026-01-22T15:48:35.471+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:35.472+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:48:35.473+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:46.296+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:46.297+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:46.297+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:46.301+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:46.360+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:46.360+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:46.361+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:46.361+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:46.372+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:48:46.372+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:48:46.401+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:48:46.412+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:46.412+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:48:46.416+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:46.416+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:46.417+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:46.419+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:46.419+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:48:46.420+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:46.436+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:48:46.438+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:46.438+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:48:46.439+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:48:46.444+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:46.439+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:46.442+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:48:46.443+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:46.448+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:46.445+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:46.446+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:46.454+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:46.455+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4460d498] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:46.446+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:46.452+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:46.454+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:46.457+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e7327f6] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:46.457+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:46.457+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1a34d8e9] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:46.474+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:46.493+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1557865765 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:48:46.524+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@565283049 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:48:46.590+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31e459ad] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:46.593+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@752644810 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:48:46.611+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:48:46.612+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:48:46.621+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:48:46.623+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:46.624+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:48:46.646+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@290134075 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:48:46.653+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:46.659+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:48:46.671+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:46.672+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:48:46.691+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:48:46.692+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 17
2026-01-22T15:48:46.693+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4460d498]
2026-01-22T15:48:46.693+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e7327f6]
2026-01-22T15:48:46.694+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1a34d8e9]
2026-01-22T15:48:46.694+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:46.696+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:46.697+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:48:46.697+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:46.698+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@741594d2] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:46.700+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:46.703+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:48:46.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:48:46.709+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@617817457 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:48:46.712+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:46.720+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31e459ad]
2026-01-22T15:48:46.721+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:48:46.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:46.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:48:46.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:48:46.725+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:46.879+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:48:46.933+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@741594d2]
2026-01-22T15:48:46.945+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:46.978+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:48:47.007+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:55.935+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:55.936+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:55.938+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:55.939+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:55.991+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:55.992+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:55.993+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:55.993+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:56.037+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:48:56.040+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:48:56.040+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:48:56.040+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:48:56.041+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:56.041+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:56.041+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:48:56.041+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:48:56.043+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:56.044+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:56.044+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:48:56.045+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:48:56.045+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:48:56.045+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:48:56.047+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:48:56.048+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:48:56.050+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:56.050+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:56.051+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:56.053+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:56.055+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:56.056+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:56.059+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:56.059+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:48:56.062+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:56.069+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:56.071+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:56.071+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:56.071+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21274a74] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:56.072+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26e4f413] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:56.072+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70e54296] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:56.072+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@620b82d6] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:56.079+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1029431511 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:48:56.079+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1097179676 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:48:56.079+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1800247573 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:48:56.079+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@342250102 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:48:56.088+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:48:56.088+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:48:56.088+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:48:56.089+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:48:56.090+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:56.091+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:56.092+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:48:56.093+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:48:56.104+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:48:56.104+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:48:56.108+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21274a74]
2026-01-22T15:48:56.109+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@620b82d6]
2026-01-22T15:48:56.110+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:56.110+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:56.111+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:48:56.111+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:48:56.112+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:56.112+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:56.142+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:48:56.142+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 17
2026-01-22T15:48:56.144+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70e54296]
2026-01-22T15:48:56.145+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26e4f413]
2026-01-22T15:48:56.145+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:48:56.145+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:56.146+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1f097a5e] was not registered for synchronization because synchronization is not active
2026-01-22T15:48:56.152+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:48:56.155+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@584132590 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:48:56.158+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:48:56.158+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:48:56.159+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:48:56.210+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:48:56.212+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1f097a5e]
2026-01-22T15:48:56.213+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:48:56.215+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:48:56.216+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:49:25.569+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:25.571+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:25.571+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:49:25.571+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:25.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:25.654+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:25.659+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:49:25.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:49:25.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:49:25.661+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:25.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:49:25.676+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:25.677+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED
2026-01-22T15:49:25.678+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:49:25.685+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:25.686+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:49:25.687+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED", parameters={masked}
2026-01-22T15:49:25.687+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:25.687+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:49:25.688+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:49:25.689+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:49:25.690+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:25.689+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:49:25.689+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:49:25.690+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:25.693+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:25.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:49:25.705+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:25.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:25.706+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:49:25.707+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:25.710+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:25.722+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:49:25.722+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3b5592d2] was not registered for synchronization because synchronization is not active
2026-01-22T15:49:25.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:25.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:49:25.730+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3b89be6c] was not registered for synchronization because synchronization is not active
2026-01-22T15:49:25.732+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:49:25.732+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c508b82] was not registered for synchronization because synchronization is not active
2026-01-22T15:49:25.733+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a1685bb] was not registered for synchronization because synchronization is not active
2026-01-22T15:49:25.756+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1959859095 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:49:25.756+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@507697979 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:49:25.756+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@80069197 wrapping com.mysql.cj.jdbc.ConnectionImpl@3796d4f2] will not be managed by Spring
2026-01-22T15:49:25.756+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1130083902 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:49:25.780+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:49:25.781+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:49:25.798+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:49:25.798+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:49:25.812+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:49:25.826+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:49:25.836+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:49:25.837+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:49:25.857+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 17
2026-01-22T15:49:25.873+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c508b82]
2026-01-22T15:49:25.886+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:49:25.886+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:49:25.886+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:49:25.888+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:49:25.901+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a1685bb]
2026-01-22T15:49:25.927+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3b89be6c]
2026-01-22T15:49:25.937+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3b5592d2]
2026-01-22T15:49:25.937+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:49:25.937+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:49:25.937+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:49:25.937+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:49:25.938+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:49:25.942+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:49:25.942+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2487850c] was not registered for synchronization because synchronization is not active
2026-01-22T15:49:25.945+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:49:25.944+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:49:25.945+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@534422464 wrapping com.mysql.cj.jdbc.ConnectionImpl@14bc07bd] will not be managed by Spring
2026-01-22T15:49:25.946+09:00 DEBUG 56396 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:49:25.955+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:49:25.967+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String)
2026-01-22T15:49:25.986+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:49:25.992+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2487850c]
2026-01-22T15:49:26.002+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:49:26.019+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:49:26.033+09:00 DEBUG 56396 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:49:32.444+09:00 DEBUG 56396 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:32.445+09:00 DEBUG 56396 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31&collectionStatus=false
2026-01-22T15:49:32.449+09:00 DEBUG 56396 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED&taxProcessed=false
2026-01-22T15:49:32.450+09:00 DEBUG 56396 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:32.551+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:32.588+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-22T15:49:32.589+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:32.592+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31&collectionStatus=false
2026-01-22T15:49:32.592+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED&taxProcessed=false
2026-01-22T15:49:32.594+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:49:32.596+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-22T15:49:32.597+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-22T15:49:32.597+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-22T15:49:32.598+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31&collectionStatus=false
2026-01-22T15:49:32.606+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:32.609+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED&taxProcessed=false
2026-01-22T15:49:32.620+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:32.626+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending?startDate=2026-01-01&endDate=2026-01-31&collectionStatus=false", parameters={masked}
2026-01-22T15:49:32.627+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-22T15:49:32.628+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?startDate=2026-01-01&endDate=2026-01-31&status%5B%5D=APPROVED&taxProcessed=false", parameters={masked}
2026-01-22T15:49:32.632+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:32.639+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String, Boolean)
2026-01-22T15:49:32.639+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31
2026-01-22T15:49:32.643+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-22T15:49:32.644+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:49:32.645+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:32.646+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary?startDate=2026-01-01&endDate=2026-01-31", parameters={masked}
2026-01-22T15:49:32.648+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:32.648+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77bb7cf2] was not registered for synchronization because synchronization is not active
2026-01-22T15:49:32.649+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String,java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:32.655+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-22T15:49:32.658+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:32.659+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:49:32.659+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:32.659+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:49:32.672+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@166ed7a4] was not registered for synchronization because synchronization is not active
2026-01-22T15:49:32.683+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-22T15:49:32.684+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@416836575 wrapping com.mysql.cj.jdbc.ConnectionImpl@f6f436f] will not be managed by Spring
2026-01-22T15:49:32.684+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7895384d] was not registered for synchronization because synchronization is not active
2026-01-22T15:49:32.691+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:49:32.692+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN tax_collected_at IS NULL THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_collected_at IS NOT NULL THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ?
2026-01-22T15:49:32.693+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@397de957] was not registered for synchronization because synchronization is not active
2026-01-22T15:49:32.695+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:49:32.720+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@587734529 wrapping com.mysql.cj.jdbc.ConnectionImpl@79498ad4] will not be managed by Spring
2026-01-22T15:49:32.720+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@473079322 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:49:32.720+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1760123098 wrapping com.mysql.cj.jdbc.ConnectionImpl@2ea00320] will not be managed by Spring
2026-01-22T15:49:32.721+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-22T15:49:32.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? AND report_date >= ? AND report_date <= ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-22T15:49:32.723+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-22T15:49:32.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND r.company_id = ? AND r.tax_collected_at IS NULL AND r.report_date >= ? AND r.report_date <= ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-22T15:49:32.724+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77bb7cf2]
2026-01-22T15:49:32.725+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:49:32.726+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-22T15:49:32.730+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate)
2026-01-22T15:49:32.730+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:49:32.739+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=17, pendingCoun (truncated)...]
2026-01-22T15:49:32.746+09:00 DEBUG 56396 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:49:32.751+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 1
2026-01-22T15:49:32.751+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 1
2026-01-22T15:49:32.751+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-22T15:49:32.771+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@397de957]
2026-01-22T15:49:32.772+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@166ed7a4]
2026-01-22T15:49:32.773+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7895384d]
2026-01-22T15:49:32.774+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:49:32.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:49:32.775+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-22T15:49:32.778+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2026-01, complet (truncated)...]
2026-01-22T15:49:32.783+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=68, drafte (truncated)...]
2026-01-22T15:49:32.784+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@30d28cfc] was not registered for synchronization because synchronization is not active
2026-01-22T15:49:32.785+09:00 DEBUG 56396 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:49:32.785+09:00 DEBUG 56396 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T15:49:32.786+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1259043972 wrapping com.mysql.cj.jdbc.ConnectionImpl@1701737d] will not be managed by Spring
2026-01-22T15:49:32.789+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.report_date >= ? AND r.report_date <= ? AND r.status IN ( ? ) AND r.tax_processed = ? GROUP BY d.category ORDER BY totalAmount DESC
2026-01-22T15:49:32.809+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), 2026-01-01(LocalDate), 2026-01-31(LocalDate), APPROVED(String), false(Boolean)
2026-01-22T15:49:32.822+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-22T15:49:32.822+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@30d28cfc]
2026-01-22T15:49:32.824+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-22T15:49:32.824+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식비/회식, totalAmou (truncated)...]
2026-01-22T15:49:32.825+09:00 DEBUG 56396 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-22T16:03:15.059+09:00  INFO 22380 --- [main] c.i.backend.BackendApplication           : Starting BackendApplication using Java 17.0.17 with PID 22380 (C:\InnerSignature\backend\target\classes started by owner in C:\InnerSignature\backend)
2026-01-22T16:03:15.080+09:00 DEBUG 22380 --- [main] c.i.backend.BackendApplication           : Running with Spring Boot v3.5.8, Spring v6.2.14
2026-01-22T16:03:15.083+09:00  INFO 22380 --- [main] c.i.backend.BackendApplication           : The following 1 profile is active: "dev"
2026-01-22T16:03:17.306+09:00 DEBUG 22380 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Searching for mappers annotated with @Mapper
2026-01-22T16:03:17.313+09:00 DEBUG 22380 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Using auto-configuration base package 'com.innersignature.backend'
2026-01-22T16:03:17.857+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AccountCodeMappingMapper.class]
2026-01-22T16:03:17.865+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AuditLogMapper.class]
2026-01-22T16:03:17.868+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AuditRuleMapper.class]
2026-01-22T16:03:17.870+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\BudgetMapper.class]
2026-01-22T16:03:17.884+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CompanyCardMapper.class]
2026-01-22T16:03:17.885+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CompanyMapper.class]
2026-01-22T16:03:17.889+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CreditMapper.class]
2026-01-22T16:03:17.890+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\ExpenseCategoryMapper.class]
2026-01-22T16:03:17.895+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\ExpenseMapper.class]
2026-01-22T16:03:17.898+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\MonthlyClosingMapper.class]
2026-01-22T16:03:17.920+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\PasswordResetTokenMapper.class]
2026-01-22T16:03:17.934+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\PaymentMapper.class]
2026-01-22T16:03:17.950+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\SubscriptionMapper.class]
2026-01-22T16:03:17.954+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\SubscriptionPlanMapper.class]
2026-01-22T16:03:17.957+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserApproverMapper.class]
2026-01-22T16:03:17.961+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserCardMapper.class]
2026-01-22T16:03:17.965+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserMapper.class]
2026-01-22T16:03:17.966+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserSignatureMapper.class]
2026-01-22T16:03:17.971+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'accountCodeMappingMapper' and 'com.innersignature.backend.mapper.AccountCodeMappingMapper' mapperInterface
2026-01-22T16:03:17.976+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'auditLogMapper' and 'com.innersignature.backend.mapper.AuditLogMapper' mapperInterface
2026-01-22T16:03:17.983+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'auditRuleMapper' and 'com.innersignature.backend.mapper.AuditRuleMapper' mapperInterface
2026-01-22T16:03:17.985+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'budgetMapper' and 'com.innersignature.backend.mapper.BudgetMapper' mapperInterface
2026-01-22T16:03:17.986+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'companyCardMapper' and 'com.innersignature.backend.mapper.CompanyCardMapper' mapperInterface
2026-01-22T16:03:17.988+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'companyMapper' and 'com.innersignature.backend.mapper.CompanyMapper' mapperInterface
2026-01-22T16:03:17.989+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'creditMapper' and 'com.innersignature.backend.mapper.CreditMapper' mapperInterface
2026-01-22T16:03:17.991+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'expenseCategoryMapper' and 'com.innersignature.backend.mapper.ExpenseCategoryMapper' mapperInterface
2026-01-22T16:03:17.995+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'expenseMapper' and 'com.innersignature.backend.mapper.ExpenseMapper' mapperInterface
2026-01-22T16:03:17.997+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'monthlyClosingMapper' and 'com.innersignature.backend.mapper.MonthlyClosingMapper' mapperInterface
2026-01-22T16:03:17.998+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'passwordResetTokenMapper' and 'com.innersignature.backend.mapper.PasswordResetTokenMapper' mapperInterface
2026-01-22T16:03:17.999+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'paymentMapper' and 'com.innersignature.backend.mapper.PaymentMapper' mapperInterface
2026-01-22T16:03:18.003+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'subscriptionMapper' and 'com.innersignature.backend.mapper.SubscriptionMapper' mapperInterface
2026-01-22T16:03:18.004+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'subscriptionPlanMapper' and 'com.innersignature.backend.mapper.SubscriptionPlanMapper' mapperInterface
2026-01-22T16:03:18.005+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userApproverMapper' and 'com.innersignature.backend.mapper.UserApproverMapper' mapperInterface
2026-01-22T16:03:18.007+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userCardMapper' and 'com.innersignature.backend.mapper.UserCardMapper' mapperInterface
2026-01-22T16:03:18.009+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userMapper' and 'com.innersignature.backend.mapper.UserMapper' mapperInterface
2026-01-22T16:03:18.013+09:00 DEBUG 22380 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userSignatureMapper' and 'com.innersignature.backend.mapper.UserSignatureMapper' mapperInterface
2026-01-22T16:03:19.327+09:00  INFO 22380 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-22T16:03:19.355+09:00  INFO 22380 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-22T16:03:19.391+09:00  INFO 22380 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.49]
2026-01-22T16:03:19.585+09:00  INFO 22380 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-22T16:03:19.590+09:00  INFO 22380 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 4393 ms
2026-01-22T16:03:19.747+09:00 DEBUG 22380 --- [main] c.i.b.security.JwtAuthenticationFilter   : Filter 'jwtAuthenticationFilter' configured for use
2026-01-22T16:03:19.822+09:00 DEBUG 22380 --- [main] c.i.backend.security.RateLimitFilter     : Filter 'rateLimitFilter' configured for use
2026-01-22T16:03:20.723+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AccountCodeMappingMapper.xml]'
2026-01-22T16:03:20.786+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AuditLogMapper.xml]'
2026-01-22T16:03:20.811+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AuditRuleMapper.xml]'
2026-01-22T16:03:20.831+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\BudgetMapper.xml]'
2026-01-22T16:03:20.854+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CompanyCardMapper.xml]'
2026-01-22T16:03:20.901+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CompanyMapper.xml]'
2026-01-22T16:03:20.919+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CreditMapper.xml]'
2026-01-22T16:03:20.947+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\ExpenseCategoryMapper.xml]'
2026-01-22T16:03:21.085+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\ExpenseMapper.xml]'
2026-01-22T16:03:21.122+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\MonthlyClosingMapper.xml]'
2026-01-22T16:03:21.139+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\PasswordResetTokenMapper.xml]'
2026-01-22T16:03:21.151+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\PaymentMapper.xml]'
2026-01-22T16:03:21.189+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\SubscriptionMapper.xml]'
2026-01-22T16:03:21.213+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\SubscriptionPlanMapper.xml]'
2026-01-22T16:03:21.226+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserApproverMapper.xml]'
2026-01-22T16:03:21.245+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserCardMapper.xml]'
2026-01-22T16:03:21.279+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserMappeer.xml]'
2026-01-22T16:03:21.295+09:00 DEBUG 22380 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserSignatureMapper.xml]'
2026-01-22T16:03:23.505+09:00 DEBUG 22380 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 162 mappings in 'requestMappingHandlerMapping'
2026-01-22T16:03:23.755+09:00 DEBUG 22380 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**, /api/uploads/**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2026-01-22T16:03:23.831+09:00  WARN 22380 --- [main] .s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: 2f0e0bb3-9338-44bb-abd5-e56538677220

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-01-22T16:03:23.941+09:00  INFO 22380 --- [main] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2026-01-22T16:03:24.231+09:00 DEBUG 22380 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RateLimitFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-22T16:03:24.550+09:00 DEBUG 22380 --- [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2026-01-22T16:03:24.715+09:00 DEBUG 22380 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2026-01-22T16:03:24.786+09:00 DEBUG 22380 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2026-01-22T16:03:25.460+09:00  INFO 22380 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-22T16:03:25.559+09:00  INFO 22380 --- [main] c.i.backend.BackendApplication           : Started BackendApplication in 11.46 seconds (process running for 12.185)
