2026-01-12T09:33:00.781+09:00  INFO 21060 --- [main] c.i.backend.BackendApplication           : Starting BackendApplication using Java 17.0.17 with PID 21060 (C:\InnerSignature\backend\target\classes started by owner in C:\InnerSignature\backend)
2026-01-12T09:33:00.809+09:00 DEBUG 21060 --- [main] c.i.backend.BackendApplication           : Running with Spring Boot v3.5.8, Spring v6.2.14
2026-01-12T09:33:00.934+09:00  INFO 21060 --- [main] c.i.backend.BackendApplication           : The following 1 profile is active: "dev"
2026-01-12T09:33:03.962+09:00 DEBUG 21060 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Searching for mappers annotated with @Mapper
2026-01-12T09:33:03.988+09:00 DEBUG 21060 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Using auto-configuration base package 'com.innersignature.backend'
2026-01-12T09:33:04.485+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AccountCodeMappingMapper.class]
2026-01-12T09:33:04.490+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AuditLogMapper.class]
2026-01-12T09:33:04.492+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\AuditRuleMapper.class]
2026-01-12T09:33:04.493+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\BudgetMapper.class]
2026-01-12T09:33:04.493+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CompanyCardMapper.class]
2026-01-12T09:33:04.495+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CompanyMapper.class]
2026-01-12T09:33:04.497+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\CreditMapper.class]
2026-01-12T09:33:04.517+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\ExpenseCategoryMapper.class]
2026-01-12T09:33:04.528+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\ExpenseMapper.class]
2026-01-12T09:33:04.530+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\MonthlyClosingMapper.class]
2026-01-12T09:33:04.531+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\PasswordResetTokenMapper.class]
2026-01-12T09:33:04.532+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\PaymentMapper.class]
2026-01-12T09:33:04.533+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\SubscriptionMapper.class]
2026-01-12T09:33:04.534+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\SubscriptionPlanMapper.class]
2026-01-12T09:33:04.534+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserApproverMapper.class]
2026-01-12T09:33:04.535+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserCardMapper.class]
2026-01-12T09:33:04.538+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserMapper.class]
2026-01-12T09:33:04.539+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Identified candidate component class: file [C:\InnerSignature\backend\target\classes\com\innersignature\backend\mapper\UserSignatureMapper.class]
2026-01-12T09:33:04.547+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'accountCodeMappingMapper' and 'com.innersignature.backend.mapper.AccountCodeMappingMapper' mapperInterface
2026-01-12T09:33:04.550+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'auditLogMapper' and 'com.innersignature.backend.mapper.AuditLogMapper' mapperInterface
2026-01-12T09:33:04.552+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'auditRuleMapper' and 'com.innersignature.backend.mapper.AuditRuleMapper' mapperInterface
2026-01-12T09:33:04.562+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'budgetMapper' and 'com.innersignature.backend.mapper.BudgetMapper' mapperInterface
2026-01-12T09:33:04.565+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'companyCardMapper' and 'com.innersignature.backend.mapper.CompanyCardMapper' mapperInterface
2026-01-12T09:33:04.566+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'companyMapper' and 'com.innersignature.backend.mapper.CompanyMapper' mapperInterface
2026-01-12T09:33:04.568+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'creditMapper' and 'com.innersignature.backend.mapper.CreditMapper' mapperInterface
2026-01-12T09:33:04.571+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'expenseCategoryMapper' and 'com.innersignature.backend.mapper.ExpenseCategoryMapper' mapperInterface
2026-01-12T09:33:04.575+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'expenseMapper' and 'com.innersignature.backend.mapper.ExpenseMapper' mapperInterface
2026-01-12T09:33:04.578+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'monthlyClosingMapper' and 'com.innersignature.backend.mapper.MonthlyClosingMapper' mapperInterface
2026-01-12T09:33:04.580+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'passwordResetTokenMapper' and 'com.innersignature.backend.mapper.PasswordResetTokenMapper' mapperInterface
2026-01-12T09:33:04.581+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'paymentMapper' and 'com.innersignature.backend.mapper.PaymentMapper' mapperInterface
2026-01-12T09:33:04.582+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'subscriptionMapper' and 'com.innersignature.backend.mapper.SubscriptionMapper' mapperInterface
2026-01-12T09:33:04.584+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'subscriptionPlanMapper' and 'com.innersignature.backend.mapper.SubscriptionPlanMapper' mapperInterface
2026-01-12T09:33:04.585+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userApproverMapper' and 'com.innersignature.backend.mapper.UserApproverMapper' mapperInterface
2026-01-12T09:33:04.589+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userCardMapper' and 'com.innersignature.backend.mapper.UserCardMapper' mapperInterface
2026-01-12T09:33:04.590+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userMapper' and 'com.innersignature.backend.mapper.UserMapper' mapperInterface
2026-01-12T09:33:04.593+09:00 DEBUG 21060 --- [main] o.m.s.mapper.ClassPathMapperScanner      : Creating MapperFactoryBean with name 'userSignatureMapper' and 'com.innersignature.backend.mapper.UserSignatureMapper' mapperInterface
2026-01-12T09:33:06.298+09:00  INFO 21060 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-12T09:33:06.348+09:00  INFO 21060 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-12T09:33:06.394+09:00  INFO 21060 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.49]
2026-01-12T09:33:06.580+09:00  INFO 21060 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-12T09:33:06.581+09:00  INFO 21060 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 5424 ms
2026-01-12T09:33:06.687+09:00 DEBUG 21060 --- [main] c.i.b.security.JwtAuthenticationFilter   : Filter 'jwtAuthenticationFilter' configured for use
2026-01-12T09:33:06.703+09:00 DEBUG 21060 --- [main] c.i.backend.security.RateLimitFilter     : Filter 'rateLimitFilter' configured for use
2026-01-12T09:33:07.161+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AccountCodeMappingMapper.xml]'
2026-01-12T09:33:07.191+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AuditLogMapper.xml]'
2026-01-12T09:33:07.216+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\AuditRuleMapper.xml]'
2026-01-12T09:33:07.244+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\BudgetMapper.xml]'
2026-01-12T09:33:07.272+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CompanyCardMapper.xml]'
2026-01-12T09:33:07.327+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CompanyMapper.xml]'
2026-01-12T09:33:07.357+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\CreditMapper.xml]'
2026-01-12T09:33:07.395+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\ExpenseCategoryMapper.xml]'
2026-01-12T09:33:07.490+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\ExpenseMapper.xml]'
2026-01-12T09:33:07.511+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\MonthlyClosingMapper.xml]'
2026-01-12T09:33:07.544+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\PasswordResetTokenMapper.xml]'
2026-01-12T09:33:07.572+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\PaymentMapper.xml]'
2026-01-12T09:33:07.605+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\SubscriptionMapper.xml]'
2026-01-12T09:33:07.623+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\SubscriptionPlanMapper.xml]'
2026-01-12T09:33:07.653+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserApproverMapper.xml]'
2026-01-12T09:33:07.680+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserCardMapper.xml]'
2026-01-12T09:33:07.739+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserMappeer.xml]'
2026-01-12T09:33:07.757+09:00 DEBUG 21060 --- [main] o.mybatis.spring.SqlSessionFactoryBean   : Parsed mapper file: 'file [C:\InnerSignature\backend\target\classes\mapper\UserSignatureMapper.xml]'
2026-01-12T09:33:08.952+09:00 DEBUG 21060 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 153 mappings in 'requestMappingHandlerMapping'
2026-01-12T09:33:09.093+09:00 DEBUG 21060 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**, /api/uploads/**, /swagger-ui*/*swagger-initializer.js, /swagger-ui*/**] in 'resourceHandlerMapping'
2026-01-12T09:33:09.124+09:00  WARN 21060 --- [main] .s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: 5fbdf5a6-e9a6-494d-bf4f-8bb071ba685d

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-01-12T09:33:09.138+09:00  INFO 21060 --- [main] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2026-01-12T09:33:09.315+09:00 DEBUG 21060 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, RateLimitFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-12T09:33:09.485+09:00 DEBUG 21060 --- [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2026-01-12T09:33:09.570+09:00 DEBUG 21060 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 2 @ExceptionHandler, 1 ResponseBodyAdvice
2026-01-12T09:33:09.580+09:00 DEBUG 21060 --- [main] o.m.s.b.a.MybatisAutoConfiguration       : Not found configuration for registering mapper bean using @MapperScan, MapperFactoryBean and MapperScannerConfigurer.
2026-01-12T09:33:09.873+09:00  INFO 21060 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-12T09:33:09.894+09:00  INFO 21060 --- [main] c.i.backend.BackendApplication           : Started BackendApplication in 10.211 seconds (process running for 10.769)
2026-01-12T09:43:08.344+09:00  INFO 21060 --- [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-12T09:43:08.346+09:00  INFO 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-12T09:43:08.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected StandardServletMultipartResolver
2026-01-12T09:43:08.348+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected AcceptHeaderLocaleResolver
2026-01-12T09:43:08.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected FixedThemeResolver
2026-01-12T09:43:08.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@64f3991e
2026-01-12T09:43:08.466+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.support.SessionFlashMapManager@6996bbc4
2026-01-12T09:43:08.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2026-01-12T09:43:08.502+09:00  INFO 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 155 ms
2026-01-12T09:43:08.584+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/login
2026-01-12T09:43:08.635+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing POST /api/login
2026-01-12T09:43:08.645+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-12T09:43:08.651+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured POST /api/login
2026-01-12T09:43:08.655+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : POST "/api/login", parameters={}
2026-01-12T09:43:08.660+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#login(LoginRequest)
2026-01-12T09:43:08.768+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [UserController.LoginRequest(username=test_tax, password=1234)]
2026-01-12T09:43:08.790+09:00  INFO 21060 --- [http-nio-8080-exec-1] c.i.backend.controller.UserController    : 로그인 시도 - username: test_tax
2026-01-12T09:43:08.823+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:08.848+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20609a41] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:08.872+09:00  INFO 21060 --- [http-nio-8080-exec-1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-12T09:43:09.260+09:00  INFO 21060 --- [http-nio-8080-exec-1] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c
2026-01-12T09:43:09.263+09:00  INFO 21060 --- [http-nio-8080-exec-1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-12T09:43:09.272+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@559991010 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:09.289+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.findByUsername   : ==>  Preparing: SELECT * FROM user_tb WHERE username = ?
2026-01-12T09:43:09.335+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.findByUsername   : ==> Parameters: test_tax(String)
2026-01-12T09:43:09.433+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.findByUsername   : <==      Total: 1
2026-01-12T09:43:09.441+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20609a41]
2026-01-12T09:43:09.594+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:09.594+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44ac908e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:09.595+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1034461503 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:09.597+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:09.607+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:09.686+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:09.719+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44ac908e]
2026-01-12T09:43:09.928+09:00  INFO 21060 --- [http-nio-8080-exec-1] c.i.backend.controller.UserController    : 로그인 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1
2026-01-12T09:43:09.951+09:00  INFO 21060 --- [http-nio-8080-exec-1] SECURITY                                 : LOGIN_SUCCESS userId=12 username=test_tax role=TAX_ACCOUNTANT
2026-01-12T09:43:09.988+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:10.022+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=로그인 성공, data={user=UserDto(userId=12, username=test_tax, password= (truncated)...]
2026-01-12T09:43:10.087+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:10.590+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/companies
2026-01-12T09:43:10.596+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/companies
2026-01-12T09:43:10.681+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/companies
2026-01-12T09:43:10.685+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/companies
2026-01-12T09:43:10.693+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/companies", parameters={}
2026-01-12T09:43:10.694+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.CompanyController#getMyCompanies()
2026-01-12T09:43:10.706+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:10.768+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@971065f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:10.813+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2090890988 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:10.816+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.U.findCompaniesByUserId          : ==>  Preparing: SELECT c.company_id AS companyId, c.company_code AS companyCode, c.company_name AS companyName, c.business_reg_no AS businessRegNo, c.representative_name AS representativeName, c.created_by AS createdBy, c.is_active AS isActive, c.created_at AS createdAt, c.updated_at AS updatedAt FROM company_tb c INNER JOIN user_company_tb uc ON c.company_id = uc.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' AND c.is_active = 1 ORDER BY uc.is_primary DESC, c.created_at DESC
2026-01-12T09:43:10.825+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.U.findCompaniesByUserId          : ==> Parameters: 12(Long)
2026-01-12T09:43:10.864+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.U.findCompaniesByUserId          : <==      Total: 2
2026-01-12T09:43:10.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@971065f]
2026-01-12T09:43:10.902+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:10.914+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ApiResponse(success=true, message=조회 성공, data=[CompanyDto(companyId=1, companyCode=2C4PSB, companyNa (truncated)...]
2026-01-12T09:43:10.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:11.997+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-12T09:43:12.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-12T09:43:12.011+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/revision-requests
2026-01-12T09:43:12.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-12T09:43:12.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:12.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-12T09:43:12.066+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-12T09:43:12.085+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=1000
2026-01-12T09:43:12.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/pending-approvals
2026-01-12T09:43:12.092+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/status
2026-01-12T09:43:12.094+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/pending
2026-01-12T09:43:12.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:12.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/tax/monthly-summary
2026-01-12T09:43:12.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=1000
2026-01-12T09:43:12.110+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:12.111+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:12.111+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:12.112+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:12.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:12.184+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:12.205+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:12.205+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:12.206+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:12.212+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:12.213+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:12.215+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:12.216+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:12.216+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:12.217+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:12.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:12.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:12.297+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:12.343+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:12.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:12.362+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:12.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:12.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:12.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:12.382+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:12.383+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:12.400+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:12.384+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:12.384+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:12.385+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:12.400+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:12.400+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:12.401+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62bd6649] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:12.402+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:12.449+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7edf2687] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:12.408+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:12.410+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:12.410+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:12.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:12.452+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:12.466+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:12.469+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1402324615 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:12.475+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@646134158 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:12.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:12.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:12.491+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:12.492+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:12.494+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:12.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:12.505+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:12.510+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ffd671c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:12.511+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d28e2a7] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:12.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@274f07a0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:12.515+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:12.516+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:12.516+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76c9f4b9] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:12.570+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1522342184 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:12.572+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:12.601+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:12.601+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1431548984 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:12.601+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@144312397 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:12.607+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7edf2687]
2026-01-12T09:43:12.623+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:12.625+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:12.628+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:12.673+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:12.677+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:12.677+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1847082642 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:12.683+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:12.684+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62bd6649]
2026-01-12T09:43:12.697+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:12.685+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:12.685+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:12.685+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:12.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:12.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:12.717+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:12.726+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:12.750+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:12.762+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:12.789+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:12.813+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d28e2a7]
2026-01-12T09:43:12.815+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76c9f4b9]
2026-01-12T09:43:12.816+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@274f07a0]
2026-01-12T09:43:12.823+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:12.830+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000
2026-01-12T09:43:12.848+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:12.850+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@66951b7d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:12.850+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:12.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:12.856+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:12.860+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:12.861+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000
2026-01-12T09:43:12.871+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:12.874+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000", parameters={masked}
2026-01-12T09:43:12.878+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2023217157 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:12.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:12.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:12.889+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:12.891+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2885f884] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:12.891+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:12.892+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1805083213 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:12.893+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:12.894+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:12.896+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:12.914+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:12.924+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:12.927+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:12.947+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:12.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:12.939+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2ffd671c]
2026-01-12T09:43:12.946+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:12.948+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:12.951+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@66951b7d]
2026-01-12T09:43:12.948+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:12.949+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:12.949+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:12.951+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:12.956+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:12.961+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:12.962+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:12.965+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:12.965+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:12.967+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:12.967+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:12.979+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:12.968+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:12.976+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:12.976+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:12.977+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:12.979+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:12.984+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:12.985+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:12.990+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:12.994+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:12.994+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2885f884]
2026-01-12T09:43:13.007+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:12.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a84856e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:12.996+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:12.997+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.004+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:13.006+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:13.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b8d2885] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1950573646 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:13.011+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.013+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.013+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:13.014+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:13.014+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@751543464 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:13.015+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:13.017+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4f9bcbdc] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.019+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.021+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:13.024+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:13.024+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:13.029+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:13.030+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1096559711 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:13.030+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3611b102] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:13.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:13.032+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:13.033+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:13.034+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@953567664 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:13.036+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.036+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.039+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:13.041+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:13.042+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:13.042+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a84856e]
2026-01-12T09:43:13.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:13.048+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:13.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b8d2885]
2026-01-12T09:43:13.049+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.050+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:13.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.055+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.056+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2929906] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.057+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50a3f253] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.057+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4f9bcbdc]
2026-01-12T09:43:13.058+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:13.063+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.058+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c3a520] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1203387368 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:13.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1103658205 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:13.078+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:13.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@498955996 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:13.062+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.063+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:13.082+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:13.078+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:13.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:13.082+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:13.082+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:13.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3611b102]
2026-01-12T09:43:13.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.097+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:13.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:13.117+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:13.118+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:13.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:13.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:13.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:13.148+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.157+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.163+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@389440a0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:13.175+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2079198029 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:13.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:13.176+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:13.176+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2929906]
2026-01-12T09:43:13.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50a3f253]
2026-01-12T09:43:13.185+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:13.188+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.191+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.193+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:13.194+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5272bee0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.197+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.202+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:13.208+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1771328001 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:13.213+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c3a520]
2026-01-12T09:43:13.215+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:13.215+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:13.217+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.221+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@389440a0]
2026-01-12T09:43:13.222+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:13.223+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@bafedaf] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.224+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.225+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1537474440 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:13.225+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:13.225+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:13.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:13.238+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:13.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5272bee0]
2026-01-12T09:43:13.244+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:13.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:13.248+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@bafedaf]
2026-01-12T09:43:13.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.251+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14727df1] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.260+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@53865390 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:13.265+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:13.272+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:13.290+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:13.294+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14727df1]
2026-01-12T09:43:13.295+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.295+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4568150c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.296+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@525264351 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:13.296+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:13.297+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:13.300+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:13.301+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4568150c]
2026-01-12T09:43:13.303+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.305+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b43515d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.307+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1317465420 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:13.309+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:13.310+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:13.313+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:13.316+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b43515d]
2026-01-12T09:43:13.318+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.331+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:13.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000
2026-01-12T09:43:13.373+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:13.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000
2026-01-12T09:43:13.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000", parameters={masked}
2026-01-12T09:43:13.383+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:13.385+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.401+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4441a24a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.409+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:13.410+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:13.414+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:13.416+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:13.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:13.417+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:13.419+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:13.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:13.431+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:13.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:13.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:13.432+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:13.433+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:13.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:13.434+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:13.435+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2011549873 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:13.436+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:13.439+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:13.441+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:13.448+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:13.446+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:13.447+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.447+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:13.447+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:13.448+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:13.450+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.449+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:13.449+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:13.449+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.449+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:13.450+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:13.450+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46fef4a9] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.452+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.455+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.456+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.457+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.458+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1873257363 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:13.461+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:13.462+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.463+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.463+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@27858d6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.465+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.465+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:13.465+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4441a24a]
2026-01-12T09:43:13.469+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:13.465+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.466+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.467+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1826126414 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:13.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:13.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:13.522+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46fef4a9]
2026-01-12T09:43:13.523+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.468+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.469+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.473+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@357e6e75] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.475+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19c4bcc4] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.479+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:13.524+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:13.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@312b2022] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13b7c496] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1796158017 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:13.528+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@270834213 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:13.532+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.573+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:13.604+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@27858d6]
2026-01-12T09:43:13.576+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1763020907 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:13.605+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.577+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1276083551 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:13.578+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:13.578+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:13.587+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:13.605+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:13.606+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:13.606+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:13.607+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:13.649+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:13.699+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:13.737+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:13.755+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.756+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:13.773+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:13.776+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:13.777+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:13.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:13.816+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:13.816+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:13.817+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:13.819+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:13.822+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@312b2022]
2026-01-12T09:43:13.822+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13b7c496]
2026-01-12T09:43:13.827+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.822+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.824+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:13.826+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19c4bcc4]
2026-01-12T09:43:13.827+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@357e6e75]
2026-01-12T09:43:13.827+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.827+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f00048d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.828+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e8d451] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.828+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:13.829+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.829+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.830+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2459a65c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.830+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@935466367 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:13.835+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:13.832+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1268158138 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:13.839+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:13.832+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:13.834+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:13.835+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:13.835+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@166155573 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:13.838+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:13.842+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:13.842+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:13.844+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.844+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:13.845+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.856+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:13.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.863+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:13.869+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:13.871+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:13.882+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f00048d]
2026-01-12T09:43:13.882+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.885+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:13.893+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:13.895+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.897+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:13.899+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d37ae52] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.900+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:13.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:13.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:13.902+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e8d451]
2026-01-12T09:43:13.902+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@658274324 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:13.903+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:13.903+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:13.910+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:13.910+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.910+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:13.915+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:13.919+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:13.922+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:13.922+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:13.927+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:13.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:13.940+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2459a65c]
2026-01-12T09:43:13.941+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.941+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.948+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:13.954+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:13.956+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:13.956+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.957+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:13.960+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:13.962+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@194590d6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:13.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:13.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.002+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.003+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:14.004+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1883746020 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:14.005+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d37ae52]
2026-01-12T09:43:14.005+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f5c1f07] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.011+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@139a58fa] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.018+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1431408954 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:14.011+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:14.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:14.016+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:14.017+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@404631474 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:14.018+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:14.030+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:14.019+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:14.019+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:14.019+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:14.036+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:14.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:14.033+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:14.038+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:14.039+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.045+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@164a71c9] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.050+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1782515817 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:14.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:14.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:14.056+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:14.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:14.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f5c1f07]
2026-01-12T09:43:14.062+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:14.062+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@194590d6]
2026-01-12T09:43:14.062+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@139a58fa]
2026-01-12T09:43:14.064+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:14.064+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:14.067+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:14.069+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.070+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:14.074+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:14.075+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:14.075+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@54be243c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.076+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:14.076+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:14.076+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:14.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1640553821 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:14.079+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:14.082+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:14.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:14.092+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:14.102+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:14.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:14.102+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@164a71c9]
2026-01-12T09:43:14.111+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:14.111+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.112+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.113+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@54b38634] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.113+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@161e5225] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.114+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@288518482 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:14.115+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1367630830 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:14.115+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:14.160+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:14.119+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:14.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:14.138+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:14.176+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:14.156+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:14.163+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:14.176+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@54be243c]
2026-01-12T09:43:14.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:14.184+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:14.184+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:14.185+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.195+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f05fa8f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.185+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:14.199+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:14.194+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:14.197+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@448767639 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:14.200+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:14.209+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@54b38634]
2026-01-12T09:43:14.248+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:14.263+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@161e5225]
2026-01-12T09:43:14.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:14.251+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:14.256+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:14.259+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:14.264+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:14.265+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:14.265+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:14.266+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:14.269+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:14.270+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:14.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:14.271+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:14.274+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:14.284+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.285+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21946bd3] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.286+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@245b13f0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.287+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@495632825 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:14.296+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:14.298+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:14.288+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1688555845 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:14.300+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:14.307+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:14.308+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:14.310+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f05fa8f]
2026-01-12T09:43:14.312+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:14.312+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.317+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3af0e70e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.316+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:14.322+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:14.324+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@630908771 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:14.325+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:14.326+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@21946bd3]
2026-01-12T09:43:14.329+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:14.330+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:14.331+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:14.333+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:14.335+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:14.336+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:14.339+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:14.340+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@245b13f0]
2026-01-12T09:43:14.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:14.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:14.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:14.351+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:14.353+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:14.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:14.355+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6649c974] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@555960187 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:14.375+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:14.375+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:14.375+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3af0e70e]
2026-01-12T09:43:14.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:14.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:14.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:14.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:14.410+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:14.416+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6649c974]
2026-01-12T09:43:14.416+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:14.418+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19686304] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:14.419+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@826415924 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:14.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:14.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:14.438+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:14.439+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19686304]
2026-01-12T09:43:14.440+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:14.441+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:14.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:20.938+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:20.941+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:20.943+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:20.945+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:20.947+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:20.949+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:21.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:21.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:21.407+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:21.424+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:21.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:21.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:21.433+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:21.434+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:21.435+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:21.452+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:21.453+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:21.454+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:21.460+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:21.460+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:21.460+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:21.467+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:21.461+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:21.462+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:21.466+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:21.466+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:21.468+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:21.468+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:21.468+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:21.468+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:21.474+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:21.474+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:21.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d6d3b83] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:21.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.481+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.482+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.482+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@258f3560] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:21.483+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.486+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.488+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.490+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.491+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@420508731 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:21.502+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:21.493+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:21.494+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:21.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:21.502+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:21.505+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ee6f2ab] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:21.506+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@703ca9e2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:21.507+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@49027cf0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:21.507+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3150d620] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:21.510+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:21.521+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@412845784 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:21.529+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:21.532+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1150686723 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:21.533+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@34630940 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:21.533+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1360996554 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:21.533+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@640540972 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:21.545+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:21.546+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:21.546+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:21.546+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:21.546+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:21.554+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:21.555+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:21.556+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:21.557+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:21.561+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:21.572+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d6d3b83]
2026-01-12T09:43:21.575+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:21.592+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:21.592+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@258f3560]
2026-01-12T09:43:21.594+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:21.595+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:21.596+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:21.596+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:21.598+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:21.603+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:21.608+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:21.609+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:21.623+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:21.628+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@703ca9e2]
2026-01-12T09:43:21.630+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@49027cf0]
2026-01-12T09:43:21.630+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ee6f2ab]
2026-01-12T09:43:21.631+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3150d620]
2026-01-12T09:43:21.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:21.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:21.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:21.647+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:21.649+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:21.650+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:21.650+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c1b52c0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:21.650+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:21.651+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:21.657+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:21.659+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@950544729 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:21.659+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:21.665+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:21.725+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:21.680+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:21.685+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:21.731+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:21.734+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:21.706+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:21.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:21.735+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:21.740+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:21.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:21.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:21.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:21.747+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:21.748+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.751+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.748+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:21.750+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:21.756+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:21.758+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:21.761+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.762+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15cf0f83] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:21.763+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.805+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:21.868+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.822+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:21.860+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@386348058 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:21.868+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c1b52c0]
2026-01-12T09:43:21.869+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:21.880+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:21.880+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:21.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:21.886+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:21.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3fe35f52] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:21.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@98eb380] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:21.885+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:21.891+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:21.891+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@461810319 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:21.906+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:21.907+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:21.892+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1966532050 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:21.909+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:21.913+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:21.929+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:21.951+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:21.954+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:21.959+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:22.014+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:22.018+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3fe35f52]
2026-01-12T09:43:22.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.018+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@98eb380]
2026-01-12T09:43:22.018+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15cf0f83]
2026-01-12T09:43:22.023+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:22.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:22.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:22.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:22.033+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.029+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:22.033+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:22.073+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:22.074+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:22.076+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:22.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:22.087+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.088+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:22.089+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:22.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:22.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:22.091+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4f99578] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.091+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:22.091+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:22.092+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:22.092+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1582544544 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:22.093+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.095+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.095+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:22.097+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:22.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:22.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:22.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:22.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2368d5c2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19bf495b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.111+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:22.113+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1447050170 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:22.114+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.115+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:22.116+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.117+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:22.117+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.122+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:22.122+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@54cf7216] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.123+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4f99578]
2026-01-12T09:43:22.123+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@840162103 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:22.123+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.123+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:22.124+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b3dfa05] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.128+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:22.128+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1134611392 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:22.129+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:22.130+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1071906174 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:22.130+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:22.131+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:22.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:22.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19bf495b]
2026-01-12T09:43:22.137+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:22.138+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:22.147+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:22.147+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:22.148+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@54cf7216]
2026-01-12T09:43:22.148+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.149+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b3dfa05]
2026-01-12T09:43:22.151+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.157+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.164+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:22.165+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:22.165+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:22.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:22.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2368d5c2]
2026-01-12T09:43:22.169+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:22.175+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:22.183+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:22.192+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:22.192+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:22.204+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:22.206+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:22.207+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:22.223+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:22.211+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.215+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:22.221+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:22.226+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:22.228+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.228+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:22.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:22.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:22.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:22.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:22.234+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:22.232+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:22.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:22.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3daf6a88] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.235+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.241+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1078580799 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:22.244+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.247+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.247+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:22.248+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.252+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5aa9a691] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.256+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1191050123 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:22.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.251+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:22.251+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@395b50d8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:22.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@72f22342] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.260+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:22.261+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@245144623 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:22.261+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:22.262+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:22.274+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@184190546 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:22.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:22.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:22.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:22.279+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5aa9a691]
2026-01-12T09:43:22.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3daf6a88]
2026-01-12T09:43:22.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:22.296+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.297+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.301+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e3787c5] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.303+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:22.310+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:22.311+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1228746684 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:22.312+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@72f22342]
2026-01-12T09:43:22.313+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.314+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:22.317+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.326+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:22.327+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:22.330+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:22.335+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:22.336+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.348+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@395b50d8]
2026-01-12T09:43:22.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e3787c5]
2026-01-12T09:43:22.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:22.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:22.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:22.392+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:22.402+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:22.406+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:22.409+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:22.410+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:22.413+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.414+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:22.419+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.423+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c3d13e4] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@687981822 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:22.440+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:22.445+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:22.502+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:22.506+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c3d13e4]
2026-01-12T09:43:22.507+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:22.508+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@41d540f0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:22.509+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@630446365 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:22.514+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:22.515+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:22.522+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:22.523+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@41d540f0]
2026-01-12T09:43:22.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:22.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:22.526+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.598+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:28.602+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:28.605+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:28.609+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:28.611+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:28.612+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:28.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:28.609+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:28.609+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:28.610+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:28.610+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:28.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:28.614+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:28.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:28.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:28.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:28.623+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:28.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:28.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:28.618+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:28.622+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:28.627+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:28.623+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:28.624+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:28.624+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:28.625+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.626+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:28.628+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:28.630+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:28.631+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.632+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:28.633+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:28.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@29592931] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.642+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.644+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.645+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.647+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.656+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.657+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@343ab5c8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.648+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.649+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7931e2ae] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.650+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c2f29ba] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.653+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.663+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1779352544 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:28.665+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@921782057 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:28.665+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1971883405 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:28.666+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1064c19b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.668+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2142832836 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:28.666+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.666+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:28.666+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:28.667+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:28.669+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:28.671+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c37d63a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.672+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1636228556 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:28.673+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:28.674+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:28.674+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:28.675+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:28.675+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:28.677+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1157421406 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:28.678+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:28.678+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:28.680+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7931e2ae]
2026-01-12T09:43:28.679+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:28.679+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:28.681+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.680+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:28.680+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:28.680+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@343ab5c8]
2026-01-12T09:43:28.681+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@29592931]
2026-01-12T09:43:28.681+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c2f29ba]
2026-01-12T09:43:28.681+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:28.682+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:28.683+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.684+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.684+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.685+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.685+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4be697b8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.687+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:28.688+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:28.689+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:28.691+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:28.691+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@392629149 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:28.692+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000
2026-01-12T09:43:28.693+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.694+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c37d63a]
2026-01-12T09:43:28.698+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1064c19b]
2026-01-12T09:43:28.698+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:28.699+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.699+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:28.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:28.708+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.709+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.710+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:28.712+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:28.713+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:28.714+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000
2026-01-12T09:43:28.715+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:28.715+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:28.721+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:28.724+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:28.726+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000", parameters={masked}
2026-01-12T09:43:28.727+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:28.727+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.729+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.732+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:28.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:28.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:28.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:28.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:28.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:28.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4be697b8]
2026-01-12T09:43:28.748+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.751+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.752+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.755+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:28.755+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:28.757+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.759+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.759+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57a25fe] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.760+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a7d2966] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.764+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1218910686 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:28.761+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:28.762+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:28.763+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:28.764+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e50d25a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.764+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@704052056 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:28.768+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:28.765+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:28.765+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:28.777+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:28.765+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:28.766+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.767+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2119574473 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:28.775+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:28.777+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:28.777+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:28.777+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:28.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:28.781+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:28.783+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.783+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:28.787+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:28.789+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.790+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.790+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:28.791+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.794+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:28.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:28.796+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:28.796+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:28.796+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b8ae76d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.798+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.798+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a7d2966]
2026-01-12T09:43:28.798+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:28.798+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e50d25a]
2026-01-12T09:43:28.799+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57a25fe]
2026-01-12T09:43:28.799+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3dfa117e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.799+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@11794476 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:28.800+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.800+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:28.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.802+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@713354673 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:28.802+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:28.802+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@38de13b2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.805+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.806+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:28.806+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:28.807+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:28.808+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:28.808+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@457915350 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:28.809+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:28.810+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.813+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.814+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:28.814+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:28.824+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:28.815+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.827+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:28.827+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@bf603f3] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.829+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:28.830+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:28.830+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:28.837+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1934440955 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:28.839+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b8ae76d]
2026-01-12T09:43:28.843+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@38de13b2]
2026-01-12T09:43:28.843+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:28.845+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:28.846+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:28.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.848+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4d6decc1] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.857+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@98968925 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:28.849+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:28.849+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3dfa117e]
2026-01-12T09:43:28.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:28.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:28.858+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:28.858+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:28.859+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.866+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:28.861+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.865+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:28.865+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.866+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:28.879+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@bf603f3]
2026-01-12T09:43:28.868+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.878+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@397017ee] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.883+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.887+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@392098760 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:28.891+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31e021ed] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.892+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:28.893+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@179455417 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:28.895+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:28.895+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:28.898+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:28.900+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:28.900+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4d6decc1]
2026-01-12T09:43:28.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.902+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:28.902+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@b7afb49] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.905+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@397017ee]
2026-01-12T09:43:28.905+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@693306627 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:28.906+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.907+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:28.907+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:28.908+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:28.908+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:28.910+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.911+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31e021ed]
2026-01-12T09:43:28.914+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.917+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:28.917+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:28.917+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@b7afb49]
2026-01-12T09:43:28.918+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.921+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.922+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5309356b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.923+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@267730160 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:28.924+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:28.926+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:28.931+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:28.931+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5309356b]
2026-01-12T09:43:28.931+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.932+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b5c23a7] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.932+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1634005962 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:28.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:28.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:28.935+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:28.935+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b5c23a7]
2026-01-12T09:43:28.936+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.937+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f3759b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.938+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@430452569 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:28.939+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:28.940+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:28.943+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:28.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f3759b]
2026-01-12T09:43:28.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:28.946+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:28.947+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:28.949+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000
2026-01-12T09:43:28.955+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:28.958+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000
2026-01-12T09:43:28.959+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000", parameters={masked}
2026-01-12T09:43:28.959+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:28.960+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.961+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6117170f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.961+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@872501821 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:28.961+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:28.962+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:28.965+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:28.965+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6117170f]
2026-01-12T09:43:28.965+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c07e33d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1978738397 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:28.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:28.967+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:28.972+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:28.972+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c07e33d]
2026-01-12T09:43:28.972+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.973+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@417a7acf] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.974+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1383557078 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:28.974+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:28.977+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:28.982+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:28.983+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@417a7acf]
2026-01-12T09:43:28.988+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:28.990+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1db71b84] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:28.996+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@260683519 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:28.998+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:28.999+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:29.002+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:29.002+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:29.006+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:29.002+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:29.009+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:29.009+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:29.009+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:29.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:29.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:29.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:29.011+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:29.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:29.017+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:29.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:29.019+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:29.019+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a7aa832] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.019+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:29.029+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1911426257 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:29.024+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:29.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:29.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:29.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:29.029+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1db71b84]
2026-01-12T09:43:29.030+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:29.030+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:29.030+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:29.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:29.032+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.037+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:29.041+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:29.042+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:29.049+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.045+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.045+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b8c617d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.047+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:29.048+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.052+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:29.052+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.058+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@239215795 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:29.059+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e2b1da9] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a7aa832]
2026-01-12T09:43:29.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:29.063+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.064+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1628373635 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:29.064+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2fae0bfe] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.065+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.065+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59221b06] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.067+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.067+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:29.067+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:29.067+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@321069289 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:29.068+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:29.068+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@822657146 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:29.069+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@778711a3] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.075+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:29.085+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@596025208 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:29.075+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:29.081+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:29.087+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:29.091+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:29.092+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:29.092+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:29.094+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:29.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:29.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:29.102+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e2b1da9]
2026-01-12T09:43:29.108+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b8c617d]
2026-01-12T09:43:29.110+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:29.111+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.112+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.112+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:29.114+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:29.114+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@344720e1] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.115+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:29.115+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.116+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@174666662 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:29.124+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:29.116+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:29.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:29.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:29.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:29.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:29.127+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:29.127+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.127+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2fae0bfe]
2026-01-12T09:43:29.129+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@778711a3]
2026-01-12T09:43:29.131+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:29.131+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59221b06]
2026-01-12T09:43:29.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1586b5d2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:29.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2023372797 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:29.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:29.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@344720e1]
2026-01-12T09:43:29.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:29.135+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:29.135+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31c01848] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.135+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:29.135+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:29.136+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.142+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:29.142+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.144+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.143+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2122653146 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:29.143+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:29.144+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a022670] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.147+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:29.149+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:29.150+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:29.150+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.152+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@927947257 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:29.158+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:29.159+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:29.161+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:29.162+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.162+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:29.164+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:29.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:29.165+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:29.165+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1586b5d2]
2026-01-12T09:43:29.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:29.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:29.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:29.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:29.168+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20d88f11] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.168+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.168+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@31c01848]
2026-01-12T09:43:29.168+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:29.169+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:29.170+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@430842755 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:29.173+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:29.173+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:29.173+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:29.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a022670]
2026-01-12T09:43:29.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.175+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:29.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:29.184+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:29.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.180+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.182+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.191+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:29.192+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:29.192+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.194+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:29.196+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@67bcd089] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.197+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:29.197+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20d88f11]
2026-01-12T09:43:29.198+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@782f252c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.200+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.206+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1215335565 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:29.201+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@575211548 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:29.204+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:29.205+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.207+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:29.207+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:29.209+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:29.210+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:29.213+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:29.215+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.214+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:29.214+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.222+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.224+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.226+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c9e4e9b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1674202114 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:29.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:29.232+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:29.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:29.235+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@782f252c]
2026-01-12T09:43:29.234+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:29.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@67bcd089]
2026-01-12T09:43:29.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.245+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:29.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:29.248+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.251+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.266+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:29.266+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c9e4e9b]
2026-01-12T09:43:29.267+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.267+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a8612c4] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.268+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@882014105 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:29.272+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:29.274+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:29.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:29.277+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a8612c4]
2026-01-12T09:43:29.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:29.279+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.490+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:29.490+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:29.491+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:29.493+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:29.491+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:29.493+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:29.493+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:29.494+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:29.495+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:29.495+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:29.496+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:29.498+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:29.498+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:29.498+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:29.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:29.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:29.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:29.503+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:29.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:29.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.501+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.506+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.506+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:29.507+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.508+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.508+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.509+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.509+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.510+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.511+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:29.513+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7bcfc83e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.513+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2baa3894] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.513+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@61f706bd] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.513+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.518+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59fae2a5] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.514+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1036997819 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:29.515+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1954818020 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:29.517+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1098844020 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:29.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@281622711 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:29.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:29.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:29.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:29.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:29.526+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:29.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:29.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:29.528+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:29.531+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:29.531+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7bcfc83e]
2026-01-12T09:43:29.536+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.532+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:29.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:29.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:29.542+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:29.545+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2baa3894]
2026-01-12T09:43:29.545+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@61f706bd]
2026-01-12T09:43:29.545+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59fae2a5]
2026-01-12T09:43:29.547+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.548+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.549+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.549+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:29.551+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:29.551+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:29.551+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6694a0e6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:29.557+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.558+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:29.559+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1760921947 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:29.562+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:29.564+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:29.569+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:29.571+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6694a0e6]
2026-01-12T09:43:29.572+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:29.573+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:29.574+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.145+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=10
2026-01-12T09:43:32.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/my-approvals
2026-01-12T09:43:32.149+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=10
2026-01-12T09:43:32.149+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/my-approvals
2026-01-12T09:43:32.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:32.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:32.327+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=10
2026-01-12T09:43:32.343+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:32.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:32.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/my-approvals
2026-01-12T09:43:32.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:32.348+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:32.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:32.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:32.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/my-approvals
2026-01-12T09:43:32.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:32.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=10
2026-01-12T09:43:32.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:32.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/my-approvals
2026-01-12T09:43:32.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:32.351+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=10", parameters={masked}
2026-01-12T09:43:32.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/my-approvals", parameters={}
2026-01-12T09:43:32.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d5399e6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:32.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMyApprovals()
2026-01-12T09:43:32.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@211050ee] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3470cde8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45fe519] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@540030315 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:32.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@723890340 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:32.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1985387880 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:32.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1246363964 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:32.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:32.368+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] .i.b.m.E.selectMyApprovedReportsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status IN ('APPROVED', 'REJECTED') AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:32.368+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:32.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:32.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:32.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] .i.b.m.E.selectMyApprovedReportsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:32.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:32.384+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:32.412+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:32.412+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:32.412+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:32.419+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d5399e6]
2026-01-12T09:43:32.439+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] .i.b.m.E.selectMyApprovedReportsByUserId : <==      Total: 0
2026-01-12T09:43:32.442+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@211050ee]
2026-01-12T09:43:32.442+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3470cde8]
2026-01-12T09:43:32.442+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45fe519]
2026-01-12T09:43:32.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.444+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.444+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:32.456+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:32.457+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a6cc5ce] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.458+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=내 결재 문서 조회 성공, data=[])]
2026-01-12T09:43:32.461+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.462+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.462+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1620457870 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:32.463+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.463+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:32.464+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:32.484+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:32.490+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:32.490+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/my-approvals
2026-01-12T09:43:32.504+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:32.508+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:32.508+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/my-approvals
2026-01-12T09:43:32.509+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:32.511+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:32.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/my-approvals
2026-01-12T09:43:32.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:32.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:32.513+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:32.513+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/my-approvals", parameters={}
2026-01-12T09:43:32.513+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:32.513+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.514+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMyApprovals()
2026-01-12T09:43:32.514+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:32.516+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f553483] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.523+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@682cd339] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.526+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a6cc5ce]
2026-01-12T09:43:32.528+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1006975007 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:32.534+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@825746031 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:32.534+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@420298cc] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:32.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:32.536+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1932647068 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:32.538+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@101fcd9f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.541+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:32.543+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:32.544+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] .i.b.m.E.selectMyApprovedReportsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status IN ('APPROVED', 'REJECTED') AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:32.547+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] .i.b.m.E.selectMyApprovedReportsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:32.549+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:32.549+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@767173798 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:32.549+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:32.549+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@682cd339]
2026-01-12T09:43:32.550+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:32.550+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f553483]
2026-01-12T09:43:32.551+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.552+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] .i.b.m.E.selectMyApprovedReportsByUserId : <==      Total: 0
2026-01-12T09:43:32.555+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:32.556+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.558+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:32.558+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@420298cc]
2026-01-12T09:43:32.558+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:32.559+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.559+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.560+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.565+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:32.565+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:32.575+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=내 결재 문서 조회 성공, data=[])]
2026-01-12T09:43:32.581+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:32.582+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:32.584+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:32.585+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.590+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:32.590+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:32.591+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@101fcd9f]
2026-01-12T09:43:32.595+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:32.606+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:32.611+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:32.612+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:32.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b0f222d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.615+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1577865659 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:32.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@68bf326d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70d53990] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:32.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@217815148 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:32.618+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:32.618+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:32.628+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@369273437 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:32.629+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:32.629+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:32.630+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:32.630+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:32.631+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2b0f222d]
2026-01-12T09:43:32.632+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74ca62f4] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:32.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:32.640+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@637941770 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:32.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@68bf326d]
2026-01-12T09:43:32.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70d53990]
2026-01-12T09:43:32.644+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:32.645+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.646+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.647+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:32.647+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:32.648+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:32.657+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.659+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.673+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:32.683+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:32.690+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74ca62f4]
2026-01-12T09:43:32.691+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:32.700+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.700+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:32.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4606c7f6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:32.702+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1643958272 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:32.702+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:32.708+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:32.709+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.709+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:32.709+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@112317c3] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.710+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@270816910 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:32.711+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:32.713+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:32.714+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:32.715+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4606c7f6]
2026-01-12T09:43:32.716+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.717+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35729494] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.718+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:32.719+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1161551035 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:32.720+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@112317c3]
2026-01-12T09:43:32.723+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:32.727+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.728+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:32.729+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:32.730+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:32.742+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:32.744+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:32.747+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:32.747+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35729494]
2026-01-12T09:43:32.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:32.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:32.752+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:32.755+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.756+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.761+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@635b92e3] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.762+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=10
2026-01-12T09:43:32.765+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1530997002 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:32.766+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:32.768+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:32.773+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=10
2026-01-12T09:43:32.775+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:32.778+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=10", parameters={masked}
2026-01-12T09:43:32.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:32.781+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.781+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:32.783+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c2b497d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.783+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@635b92e3]
2026-01-12T09:43:32.784+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@868991273 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:32.784+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:32.785+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:32.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:32.796+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:32.797+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:32.845+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:32.866+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c2b497d]
2026-01-12T09:43:32.875+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:32.885+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2987941e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:32.912+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@803295474 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:32.929+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:32.931+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:32.949+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:32.987+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2987941e]
2026-01-12T09:43:32.987+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:33.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@784a2567] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:33.074+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1836607764 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:33.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:33.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:33.107+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:33.116+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:33.117+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:33.123+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:33.124+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:33.125+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:33.125+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@784a2567]
2026-01-12T09:43:33.125+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:33.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:33.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d01371d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:33.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ab21e4e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:33.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1408920930 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:33.128+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:33.129+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1574348682 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:33.129+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:33.130+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:33.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:33.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:33.135+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ab21e4e]
2026-01-12T09:43:33.135+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:33.136+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bdd246f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:33.136+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:33.137+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@24577844 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:33.142+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d01371d]
2026-01-12T09:43:33.142+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:33.143+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:33.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:33.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:33.148+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:33.158+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:33.162+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:33.163+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:33.163+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:33.164+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6bdd246f]
2026-01-12T09:43:33.165+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:33.165+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:33.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:33.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@582df777] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:33.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:33.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1515277889 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:33.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f6573c7] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:33.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:33.168+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1902039561 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:33.168+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:33.168+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:33.173+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:33.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:33.178+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@582df777]
2026-01-12T09:43:33.183+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:33.183+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:33.184+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55aecd2a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:33.185+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f6573c7]
2026-01-12T09:43:33.185+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1653546663 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:33.188+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:33.189+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:33.186+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:33.194+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:33.195+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:33.213+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:33.213+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55aecd2a]
2026-01-12T09:43:33.214+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:33.214+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:33.215+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:35.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:35.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:35.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:35.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:35.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:35.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:35.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:35.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:35.354+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.355+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:35.355+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:35.356+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:35.356+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:35.356+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:35.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:35.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:35.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:35.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:35.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:35.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:35.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:35.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:35.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.362+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:35.367+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:35.362+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:35.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:35.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:35.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.367+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.371+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.372+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.372+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.373+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35724039] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@492cb570] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ece21f0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.382+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.385+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@519616873 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:35.394+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.394+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@173766596 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:35.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@becffb2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:35.396+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f3ab739] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.397+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f62c553] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.397+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1534470702 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:35.397+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:35.399+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:35.401+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1415968975 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:35.402+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:35.402+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@787420077 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:35.406+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1699801442 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.407+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:35.407+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:35.409+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:35.409+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:35.409+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:35.410+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:35.412+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:35.413+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35724039]
2026-01-12T09:43:35.415+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:35.417+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:35.417+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:35.418+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:35.418+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.419+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@492cb570]
2026-01-12T09:43:35.424+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ece21f0]
2026-01-12T09:43:35.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:35.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:35.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:35.428+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@becffb2]
2026-01-12T09:43:35.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:35.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f3ab739]
2026-01-12T09:43:35.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:35.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:35.431+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.431+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f62c553]
2026-01-12T09:43:35.433+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000
2026-01-12T09:43:35.433+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.436+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.446+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:35.439+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@73ece689] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.445+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.447+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.447+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:35.448+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:35.452+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:35.459+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@837559277 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:35.459+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:35.461+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:35.462+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000
2026-01-12T09:43:35.464+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:35.466+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:35.467+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:35.468+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.481+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:35.474+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:35.480+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000", parameters={masked}
2026-01-12T09:43:35.480+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:35.481+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:35.483+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:35.484+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.491+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:35.493+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:35.494+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:35.496+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:35.497+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:35.498+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.498+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.498+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@73ece689]
2026-01-12T09:43:35.498+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:35.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.498+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:35.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:35.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@22a09e6e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:35.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.501+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.505+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@500419667 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.505+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:35.506+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@441483ac] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.507+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.510+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.511+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:35.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:35.513+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@467468658 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:35.515+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:35.518+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.522+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.523+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:35.524+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.524+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:35.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74bc32ee] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d6c4d00] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.526+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:35.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.528+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:35.529+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:35.529+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@671257700 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:35.529+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@218036915 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:35.529+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:35.530+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.530+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@22a09e6e]
2026-01-12T09:43:35.531+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:35.531+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:35.532+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:35.532+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44ccc2a7] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.533+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.534+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:35.534+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:35.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:35.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:35.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4d7b14b6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@826709580 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:35.540+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@441483ac]
2026-01-12T09:43:35.540+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.541+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1804509337 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.541+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:35.541+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:35.544+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:35.542+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.543+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.543+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:35.543+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:35.544+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74bc32ee]
2026-01-12T09:43:35.545+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:35.546+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:35.546+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.547+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d6c4d00]
2026-01-12T09:43:35.547+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:35.547+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.548+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.548+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3df8c0f2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.550+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.550+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44ccc2a7]
2026-01-12T09:43:35.551+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:35.553+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@101707355 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:35.555+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:35.555+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:35.555+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:35.557+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.557+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:35.558+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.560+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:35.563+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4d7b14b6]
2026-01-12T09:43:35.565+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:35.565+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.567+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:35.573+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:35.573+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.574+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.579+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:35.580+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62c24e0d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.584+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:35.590+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:35.591+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2005481543 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.591+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.591+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3df8c0f2]
2026-01-12T09:43:35.591+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:35.592+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74c226c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.592+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.593+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:35.594+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1988171051 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:35.594+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43885526] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.595+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:35.597+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@727054759 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:35.599+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:35.600+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:35.600+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:35.600+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62c24e0d]
2026-01-12T09:43:35.604+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:35.604+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.606+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@636c92bb] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.607+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@330177277 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.608+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:35.611+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:35.611+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74c226c]
2026-01-12T09:43:35.611+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:35.612+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.612+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:35.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:35.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43885526]
2026-01-12T09:43:35.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.614+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.614+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:35.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:35.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@636c92bb]
2026-01-12T09:43:35.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.618+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a6305df] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.622+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@756917090 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.624+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:35.628+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:35.632+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:35.633+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a6305df]
2026-01-12T09:43:35.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39354aea] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.635+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@197852654 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.635+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:35.635+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:35.638+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:35.638+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39354aea]
2026-01-12T09:43:35.639+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.639+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c12e4b4] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@803441606 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:35.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:35.643+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:35.644+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c12e4b4]
2026-01-12T09:43:35.645+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.646+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:35.647+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.649+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000
2026-01-12T09:43:35.660+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:35.662+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000
2026-01-12T09:43:35.665+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000", parameters={masked}
2026-01-12T09:43:35.665+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:35.668+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.668+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e9d6cde] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.671+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@731074443 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:35.675+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:35.676+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:35.693+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:35.693+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:35.694+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:35.695+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.695+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:35.695+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:35.696+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:35.696+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:35.697+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:35.698+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.699+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e9d6cde]
2026-01-12T09:43:35.699+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:35.699+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:35.699+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:35.699+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:35.700+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.700+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.702+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@682b39f2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:35.704+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1834308533 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:35.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:35.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:35.704+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:35.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:35.705+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:35.704+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:35.704+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:35.704+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:35.708+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:35.705+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:35.706+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6d96fa80] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.706+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:35.707+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:35.708+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.724+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.709+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.710+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@984893177 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.728+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:35.711+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.722+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:35.723+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.726+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.731+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.728+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.730+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:35.730+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.731+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@682b39f2]
2026-01-12T09:43:35.731+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d04b44c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.732+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.738+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1278a26] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.732+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.737+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2012105101 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:35.740+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@345633710 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:35.741+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ce208a1] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.742+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:35.743+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@734a71ba] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.743+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b21414a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.743+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:35.744+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:35.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1812722546 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:35.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6d96fa80]
2026-01-12T09:43:35.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1568512621 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:35.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2062812533 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:35.747+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:35.748+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:35.748+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:35.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:35.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:35.760+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:35.760+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:35.761+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:35.761+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:35.761+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:35.762+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:35.764+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.767+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1278a26]
2026-01-12T09:43:35.768+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1d04b44c]
2026-01-12T09:43:35.776+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.778+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2362b8a5] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:35.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:35.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@514416725 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:35.782+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:35.782+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:35.783+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:35.786+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:35.788+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.790+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:35.793+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ce208a1]
2026-01-12T09:43:35.793+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b21414a]
2026-01-12T09:43:35.793+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@734a71ba]
2026-01-12T09:43:35.794+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:35.796+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:35.798+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:35.804+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.806+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.806+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.811+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:35.806+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:35.811+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:35.811+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3cc5afe7] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.811+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:35.811+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:35.815+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:35.813+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:35.814+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.814+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2108654116 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:35.815+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:35.815+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.817+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:35.818+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.830+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b18ac78] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.821+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:35.821+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:35.824+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2362b8a5]
2026-01-12T09:43:35.827+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.828+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.831+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1508081734 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:35.833+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:35.843+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:35.833+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:35.833+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.834+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.842+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.845+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:35.846+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:35.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:35.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:35.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:35.848+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:35.848+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.849+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:35.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64dc590] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3cc5afe7]
2026-01-12T09:43:35.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:35.852+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:35.854+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:35.856+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:35.859+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1626658935 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:35.860+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.860+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b18ac78]
2026-01-12T09:43:35.860+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.861+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.862+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:35.862+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:35.862+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43fe4ac8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.864+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.864+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.865+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.866+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:35.868+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:35.868+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1389723591 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:35.868+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:35.873+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.875+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.876+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:35.876+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:35.877+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.883+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:35.880+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75317c6f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.880+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5af59715] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.880+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:35.895+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1909057702 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:35.896+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1911160763 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:35.900+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.900+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:35.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:35.903+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:35.908+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:35.909+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:35.910+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:35.910+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64dc590]
2026-01-12T09:43:35.911+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43fe4ac8]
2026-01-12T09:43:35.914+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.916+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.917+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.917+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:35.922+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5af59715]
2026-01-12T09:43:35.923+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.917+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4319ec3a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.921+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:35.922+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@234a0488] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.924+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:35.926+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@419519523 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.927+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.927+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@315863587 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:35.929+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.930+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:35.934+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:35.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:35.956+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:35.948+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:35.951+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75317c6f]
2026-01-12T09:43:35.960+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:35.962+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:35.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:35.977+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:35.977+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:35.980+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4319ec3a]
2026-01-12T09:43:35.981+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@234a0488]
2026-01-12T09:43:35.989+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.989+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:35.990+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@347b9560] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.992+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b23d233] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:35.993+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@948951017 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:35.993+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@415163803 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:36.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:36.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:35.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:36.062+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:36.123+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:36.123+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:36.125+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b23d233]
2026-01-12T09:43:36.125+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@347b9560]
2026-01-12T09:43:36.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:36.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:36.127+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:36.128+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:36.131+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:36.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:36.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:36.234+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:36.235+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:36.236+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:36.306+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:36.294+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:36.301+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:36.308+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:36.329+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:36.331+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:36.332+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:36.306+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:36.307+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:36.308+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:36.335+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:36.335+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:36.340+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:36.341+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:36.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:36.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:36.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:36.343+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:36.343+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1481313e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:36.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:36.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@146445327 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:36.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:36.345+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:36.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:36.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:36.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:36.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:36.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:36.348+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:36.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:36.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:36.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@444cdba1] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:36.351+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@bd40ff] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:36.351+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:36.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1688974643 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:36.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a5ad362] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:36.362+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:36.362+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2085350684 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:36.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:36.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:36.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:36.368+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:36.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1481313e]
2026-01-12T09:43:36.375+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:36.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:36.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1023719128 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:36.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:36.382+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:36.384+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:36.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@444cdba1]
2026-01-12T09:43:36.396+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:36.397+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:36.399+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:36.410+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@40babf77] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:36.410+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a5ad362]
2026-01-12T09:43:36.411+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1644819730 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:36.412+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:36.414+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:36.416+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:36.418+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:36.419+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@bd40ff]
2026-01-12T09:43:36.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:36.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:36.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:36.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:36.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:36.442+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:36.446+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@40babf77]
2026-01-12T09:43:36.446+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:36.449+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:36.450+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.575+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:37.578+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:37.579+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:37.579+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:37.584+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:37.593+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:37.580+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:37.580+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:37.596+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:37.581+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:37.583+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:37.585+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:37.594+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:37.596+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:37.599+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:37.600+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:37.600+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:37.600+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:37.601+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:37.601+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:37.607+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.601+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:37.602+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:37.606+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:37.606+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:37.607+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:37.609+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.609+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:37.609+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:37.610+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:37.610+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:37.610+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:37.611+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.612+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.612+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@606d3900] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.614+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.614+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@768a3d24] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.615+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4fdd2a89] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.615+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.621+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@687634033 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:37.621+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@233532446 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:37.622+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.623+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@263248757 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:37.626+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:37.624+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.627+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:37.625+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78a68a76] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.626+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:37.626+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:37.626+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7263d805] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.631+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:37.627+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@72f06e06] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.629+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:37.629+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1449688562 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:37.630+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:37.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:37.633+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@847070677 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:37.633+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4fdd2a89]
2026-01-12T09:43:37.633+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:37.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1758078833 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:37.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@768a3d24]
2026-01-12T09:43:37.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:37.635+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.636+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:37.639+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:37.640+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:37.640+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:37.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:37.643+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@606d3900]
2026-01-12T09:43:37.642+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:37.642+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:37.643+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:37.645+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.648+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.649+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78a68a76]
2026-01-12T09:43:37.650+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:37.653+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:37.660+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7263d805]
2026-01-12T09:43:37.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@52c17fbf] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.662+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.665+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@876451592 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:37.667+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:37.667+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:37.670+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.673+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:37.677+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:37.678+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:37.683+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:37.693+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@72f06e06]
2026-01-12T09:43:37.684+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:37.684+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:37.691+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:37.694+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.694+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:37.696+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:37.700+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:37.695+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:37.695+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@52c17fbf]
2026-01-12T09:43:37.696+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:37.700+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:37.710+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.711+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.715+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.722+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.715+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:37.716+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:37.729+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.730+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.717+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:37.726+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51153e43] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.729+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.731+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.739+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b945b1f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:37.743+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1204372172 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:37.744+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:37.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1275129246 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:37.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:37.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:37.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:37.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:37.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:37.747+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:37.747+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.747+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.750+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@b7a1b30] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.753+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:37.758+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@720083085 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:37.762+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:37.762+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:37.764+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:37.764+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:37.765+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51153e43]
2026-01-12T09:43:37.765+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b945b1f]
2026-01-12T09:43:37.778+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.767+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:37.773+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:37.777+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:37.789+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:37.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:37.808+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.800+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:37.812+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.817+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:37.830+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:37.831+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:37.838+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:37.834+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.834+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@b7a1b30]
2026-01-12T09:43:37.838+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:37.843+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:37.844+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.845+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.846+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:37.846+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:37.846+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@29dd6d3f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:37.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:37.850+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:37.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1007234676 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:37.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.856+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:37.858+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.865+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:37.865+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:37.874+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.875+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.880+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62bb4e7c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.877+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:37.890+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:37.878+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:37.879+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.885+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1398966006 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:37.891+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:37.893+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.894+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:37.894+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:37.894+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43bc5055] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.895+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:37.896+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:37.896+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.897+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1634189686 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:37.898+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@29dd6d3f]
2026-01-12T09:43:37.900+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.900+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:37.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:37.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.905+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@62bb4e7c]
2026-01-12T09:43:37.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.906+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.903+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:37.905+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cc8d141] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.906+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c759238] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.906+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:37.907+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@515832690 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:37.908+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2025724414 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:37.909+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:37.910+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.911+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:37.912+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:37.913+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:37.915+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:37.916+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:37.921+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:37.922+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:37.924+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43bc5055]
2026-01-12T09:43:37.925+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:37.925+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:37.925+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:37.926+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.926+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c759238]
2026-01-12T09:43:37.926+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5cc8d141]
2026-01-12T09:43:37.927+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:37.927+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:37.928+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.928+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:37.929+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.929+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:37.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:37.929+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.932+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:37.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.935+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:37.937+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:37.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c050b0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:37.947+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1920601690 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:37.947+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:37.953+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:37.963+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:37.993+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:37.998+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:37.998+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:37.979+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:37.979+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:38.000+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:38.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:38.016+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:38.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:38.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:38.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:38.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:38.029+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:38.032+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:38.047+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:38.054+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:38.055+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:38.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:38.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16b74deb] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:38.052+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6c050b0]
2026-01-12T09:43:38.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:38.068+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:38.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:38.064+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@771402124 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:38.066+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:38.068+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a954dca] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:38.070+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:38.070+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:38.074+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:38.074+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@602991008 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:38.078+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:38.079+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:38.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:38.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:38.081+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:38.089+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:38.089+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@61719474] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:38.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@407136230 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:38.094+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:38.097+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:38.097+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:38.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:38.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a954dca]
2026-01-12T09:43:38.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16b74deb]
2026-01-12T09:43:38.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:38.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:38.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:38.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:38.105+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:38.110+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:38.111+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:38.113+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@61719474]
2026-01-12T09:43:38.117+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:38.119+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a51b7d2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:38.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1475237592 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:38.127+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:38.127+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:38.130+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:38.131+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a51b7d2]
2026-01-12T09:43:38.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:38.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:38.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:38.144+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:38.148+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:38.149+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:38.149+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:38.150+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:38.160+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:38.162+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:38.162+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:38.163+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@609f87c2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:38.163+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@402676404 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:38.164+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:38.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:38.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:38.176+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@609f87c2]
2026-01-12T09:43:38.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:38.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@73568954] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:38.178+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1877713259 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:38.178+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:38.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:38.183+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:38.184+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@73568954]
2026-01-12T09:43:38.185+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:38.185+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:38.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:38.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:38.938+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/my-approvals
2026-01-12T09:43:38.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:38.939+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:38.940+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/my-approvals
2026-01-12T09:43:38.935+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=10
2026-01-12T09:43:38.940+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:38.940+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:38.940+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/my-approvals
2026-01-12T09:43:38.941+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:38.942+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:38.943+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:38.943+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/my-approvals", parameters={}
2026-01-12T09:43:38.943+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:38.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=10
2026-01-12T09:43:38.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:38.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMyApprovals()
2026-01-12T09:43:38.945+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:38.945+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=10", parameters={masked}
2026-01-12T09:43:38.948+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:38.948+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:38.949+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:38.949+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:38.950+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@370ca61] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:38.950+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2edb09ef] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:38.950+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39bb4b2d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:38.951+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:38.960+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@785458888 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:38.961+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10563497] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:38.963+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1446394256 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:38.964+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:38.965+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] .i.b.m.E.selectMyApprovedReportsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status IN ('APPROVED', 'REJECTED') AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:38.965+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1188645153 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:38.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1853549342 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:38.967+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:38.969+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] .i.b.m.E.selectMyApprovedReportsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:38.976+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:38.977+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:38.981+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:38.982+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:38.985+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:38.987+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] .i.b.m.E.selectMyApprovedReportsByUserId : <==      Total: 0
2026-01-12T09:43:38.992+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@370ca61]
2026-01-12T09:43:38.992+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2edb09ef]
2026-01-12T09:43:38.992+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:38.993+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:38.993+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:38.993+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=내 결재 문서 조회 성공, data=[])]
2026-01-12T09:43:38.994+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:38.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:39.001+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39bb4b2d]
2026-01-12T09:43:38.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:38.997+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.005+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:39.009+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/my-approvals
2026-01-12T09:43:39.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.011+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10563497]
2026-01-12T09:43:39.018+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:39.021+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/my-approvals
2026-01-12T09:43:39.023+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:39.023+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.024+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:39.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:39.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/my-approvals
2026-01-12T09:43:39.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@9c097b1] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.029+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2004233929 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:39.032+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:39.033+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:39.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:39.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/my-approvals", parameters={}
2026-01-12T09:43:39.029+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:39.034+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.043+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMyApprovals()
2026-01-12T09:43:39.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:39.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55e69556] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:39.047+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:39.049+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@389cfa59] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.050+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:39.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@9c097b1]
2026-01-12T09:43:39.053+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1021143082 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:39.058+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:39.059+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@649200540 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:39.059+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.059+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] .i.b.m.E.selectMyApprovedReportsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status IN ('APPROVED', 'REJECTED') AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:39.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:39.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79ac4a7b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] .i.b.m.E.selectMyApprovedReportsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:39.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@475d9bf7] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.062+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:39.063+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1960589280 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:39.065+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:39.067+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:39.069+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@325532866 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:39.070+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:39.071+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] .i.b.m.E.selectMyApprovedReportsByUserId : <==      Total: 0
2026-01-12T09:43:39.075+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55e69556]
2026-01-12T09:43:39.074+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:39.075+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@389cfa59]
2026-01-12T09:43:39.075+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.076+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:39.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:39.079+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:39.078+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=내 결재 문서 조회 성공, data=[])]
2026-01-12T09:43:39.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79ac4a7b]
2026-01-12T09:43:39.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.092+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.093+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@149864bc] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.094+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@268180422 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:39.096+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:39.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:39.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:39.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@475d9bf7]
2026-01-12T09:43:39.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:39.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:39.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:39.102+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:39.102+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.107+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:39.108+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:39.110+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.117+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:39.118+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2580a89f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.122+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:39.123+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:39.124+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1965771512 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:39.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:39.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@149864bc]
2026-01-12T09:43:39.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:39.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:39.127+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.128+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:39.130+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:39.130+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a0ec684] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@769974525 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:39.131+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:39.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:39.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4dd13a98] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2580a89f]
2026-01-12T09:43:39.136+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:39.138+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2055859159 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:39.139+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.141+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:39.145+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:39.150+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:39.152+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:39.155+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:39.157+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7a0ec684]
2026-01-12T09:43:39.161+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.161+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a9c3739] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.163+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:39.164+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:39.165+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@103475720 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:39.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:39.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4dd13a98]
2026-01-12T09:43:39.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:39.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:39.168+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.173+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:39.193+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:39.194+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:39.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.247+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:39.247+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1fa87bdb] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a9c3739]
2026-01-12T09:43:39.255+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1492340051 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:39.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.258+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:39.258+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1824080] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.260+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:39.261+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1783405174 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:39.261+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:39.262+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:39.266+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:39.270+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1fa87bdb]
2026-01-12T09:43:39.272+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:39.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.277+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1824080]
2026-01-12T09:43:39.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:39.279+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:39.295+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.309+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:39.310+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=10
2026-01-12T09:43:39.316+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:39.317+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:39.317+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:39.322+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=10
2026-01-12T09:43:39.322+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:39.327+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=10", parameters={masked}
2026-01-12T09:43:39.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:39.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:39.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.330+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1345e3aa] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.330+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.331+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@206024356 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:39.331+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46b34633] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.332+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1695390177 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:39.332+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:39.331+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:39.343+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:39.334+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:39.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:39.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:39.355+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46b34633]
2026-01-12T09:43:39.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1345e3aa]
2026-01-12T09:43:39.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f51a711] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:39.362+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1670376470 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:39.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:39.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:39.382+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:39.391+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f51a711]
2026-01-12T09:43:39.391+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.392+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e6383a8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.392+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1547225178 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:39.394+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:39.397+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:39.401+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:39.404+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e6383a8]
2026-01-12T09:43:39.405+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.406+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@fd8af92] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.406+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2111046402 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:39.409+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:39.411+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:39.415+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:39.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@fd8af92]
2026-01-12T09:43:39.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.428+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c607543] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@915337570 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:39.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:39.432+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:39.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:39.445+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c607543]
2026-01-12T09:43:39.445+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.446+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f184895] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.446+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1345186392 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:39.447+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:39.448+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:39.449+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:39.450+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f184895]
2026-01-12T09:43:39.451+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.452+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@321e469] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.455+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1854953592 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:39.457+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:39.458+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:39.460+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:39.460+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@321e469]
2026-01-12T09:43:39.461+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.461+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:39.462+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.639+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:39.640+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:39.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:39.642+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:39.644+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:39.650+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.651+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c462b4f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.656+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@67327845 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:39.657+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:39.658+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:39.678+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:39.694+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5c462b4f]
2026-01-12T09:43:39.699+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:39.702+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:39.708+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:39.711+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:39.715+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:39.716+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:39.717+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:39.718+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:39.718+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@242f4132] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:39.727+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@764777055 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:39.728+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:39.730+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:39.734+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:39.735+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@242f4132]
2026-01-12T09:43:39.739+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:39.740+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:39.741+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:42.729+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:42.737+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:42.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:42.738+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:42.739+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:42.739+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:42.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:42.735+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:42.736+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:42.737+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:42.744+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:42.739+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:42.740+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:42.742+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:42.742+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:42.744+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:42.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:42.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:42.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:42.747+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:42.755+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:42.751+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:42.751+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:42.751+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:42.753+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.754+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:42.755+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:42.756+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:42.757+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.756+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.756+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:42.756+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.757+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:42.757+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:42.758+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.758+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39d0fc00] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.758+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.759+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f394b08] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.759+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.760+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.763+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.773+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@40c15b72] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.763+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3be8b205] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.768+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.771+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@822755211 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:42.772+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.774+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@851262182 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:42.777+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@828516380 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:42.778+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:42.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@817634168 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:42.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:42.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:42.781+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@47716884] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.782+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:42.782+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:42.783+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3bca2b00] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.783+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:42.784+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:42.785+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:42.794+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1220939301 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:42.794+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:42.794+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@633059707 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:42.794+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:42.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:42.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@39d0fc00]
2026-01-12T09:43:42.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:42.796+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:42.796+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:42.797+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f394b08]
2026-01-12T09:43:42.797+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:42.797+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:42.797+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3be8b205]
2026-01-12T09:43:42.798+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:42.798+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@40c15b72]
2026-01-12T09:43:42.798+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:42.799+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:42.799+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:42.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:42.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:42.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:42.802+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:42.802+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:42.802+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:42.802+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@47716884]
2026-01-12T09:43:42.805+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:42.806+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:42.806+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:42.807+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3bca2b00]
2026-01-12T09:43:42.819+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.809+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:42.810+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:42.812+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:42.821+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f7ce43f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.823+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:42.826+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:42.828+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:42.830+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1328850992 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:42.831+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:42.833+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:42.835+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:42.835+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:42.836+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:42.837+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:42.839+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:42.842+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:42.842+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:42.844+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:42.846+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:42.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:42.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:42.848+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.848+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:42.849+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.849+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.849+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:42.850+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.857+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.859+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@846b1c8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25ecf60f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.854+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.860+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@71835141 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:42.861+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@419957163 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:42.861+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:42.862+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.863+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:42.864+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:42.865+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2f7ce43f]
2026-01-12T09:43:42.865+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.866+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:42.866+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:42.867+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:42.868+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:42.867+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8b5988a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.870+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:42.876+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:42.877+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:42.890+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@846b1c8]
2026-01-12T09:43:42.878+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1707394688 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:42.878+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25ecf60f]
2026-01-12T09:43:42.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:42.891+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:42.892+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:42.893+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:42.894+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:42.894+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:42.895+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:42.895+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:42.896+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:42.896+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:42.898+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:42.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:42.917+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:42.917+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:42.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:42.903+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:42.924+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:42.922+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:42.924+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:42.925+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.929+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.928+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:42.928+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:42.930+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.930+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.931+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:42.931+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:42.931+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@27bc427f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.932+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.932+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:42.934+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8b5988a]
2026-01-12T09:43:42.934+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1378282765 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:42.937+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:42.935+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.936+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.937+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:42.941+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:42.942+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c99c820] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.943+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.943+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:42.946+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1174940157 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:42.947+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.949+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:42.957+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:42.961+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:42.957+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5663b4ec] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@248947711 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:42.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:42.967+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:42.973+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@27bc427f]
2026-01-12T09:43:42.977+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:42.971+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:42.972+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:42.980+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@fed9ba6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:42.981+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:42.984+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1250398110 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:42.983+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:42.984+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:42.989+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:42.986+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:42.991+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:42.993+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:42.997+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:43.034+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:43.034+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:43.040+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.041+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c99c820]
2026-01-12T09:43:43.042+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@fed9ba6]
2026-01-12T09:43:43.042+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5663b4ec]
2026-01-12T09:43:43.042+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:43.043+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:43.043+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:43.043+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:43.043+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@566decfd] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:43.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:43.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:43.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:43.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1911773793 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:43.045+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:43.045+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:43.047+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:43.048+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:43.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:43.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:43.052+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:43.055+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:43.063+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:43.072+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:43.065+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:43.068+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:43.073+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:43.074+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:43.075+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:43.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:43.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:43.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:43.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:43.078+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@566decfd]
2026-01-12T09:43:43.081+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.081+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:43.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.081+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:43.082+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:43.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.084+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:43.084+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.085+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:43.085+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.086+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ee2ecc] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:43.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:43.093+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:43.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45cce973] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:43.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@221515187 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:43.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:43.106+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:43.094+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@68133509 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:43.094+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:43.110+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50726a6a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:43.096+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:43.110+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:43.112+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@417804615 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:43.114+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:43.116+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:43.116+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:43.116+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:43.122+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:43.122+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:43.118+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:43.125+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.128+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.130+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:43.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:43.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45cce973]
2026-01-12T09:43:43.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:43.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:43.141+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3970de6a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:43.144+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:43.144+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50726a6a]
2026-01-12T09:43:43.144+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ee2ecc]
2026-01-12T09:43:43.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@75886717 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:43.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:43.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:43.147+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:43.150+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1cbfb0b5] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:43.147+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:43.148+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:43.148+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:43.154+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1758684576 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:43.157+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:43.157+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:43.160+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:43.165+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:43.169+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:43.171+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:43.172+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3970de6a]
2026-01-12T09:43:43.173+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1cbfb0b5]
2026-01-12T09:43:43.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:43.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:43.175+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:43.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:43.178+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:43.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:43.185+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:43.288+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:43.306+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:43.311+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:43.314+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:43.326+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.339+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:43.341+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:43.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3aea7e1d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:43.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2020912065 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:43.343+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:43.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:43.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:43.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3aea7e1d]
2026-01-12T09:43:43.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:43.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@54a3bc0e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:43.348+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1037052433 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:43.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:43.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:43.352+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:43.355+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@54a3bc0e]
2026-01-12T09:43:43.355+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:43.356+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:43.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.281+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:44.281+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:44.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:44.284+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:44.284+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:44.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:44.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:44.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.284+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:44.291+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:44.291+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.284+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:44.285+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:44.288+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:44.289+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:44.291+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:44.292+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.294+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:44.295+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:44.292+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:44.292+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:44.293+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:44.293+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:44.293+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:44.298+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.298+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:44.298+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:44.299+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:44.299+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:44.301+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:44.299+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.300+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.300+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.301+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.301+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:44.303+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.306+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f3d0765] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.307+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.313+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50c7c77d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.307+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7808d1a5] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.311+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.312+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.321+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.312+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.315+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1750830315 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:44.319+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.326+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.327+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1595341069 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:44.327+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1834402339 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.327+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:44.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c1771eb] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@58c93bb6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.329+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:44.333+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1768815480 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:44.329+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:44.329+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51843fc8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.330+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:44.334+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@674541659 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:44.334+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:44.334+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:44.334+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 12(Long)
2026-01-12T09:43:44.337+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:44.341+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:44.341+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@66868276 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:44.341+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:44.341+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:44.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:44.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:44.345+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:44.345+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f3d0765]
2026-01-12T09:43:44.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50c7c77d]
2026-01-12T09:43:44.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7808d1a5]
2026-01-12T09:43:44.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:44.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:44.348+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c1771eb]
2026-01-12T09:43:44.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:44.351+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:44.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:44.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:44.351+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@58c93bb6]
2026-01-12T09:43:44.351+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:44.352+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:44.355+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51843fc8]
2026-01-12T09:43:44.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:44.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000
2026-01-12T09:43:44.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:44.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75f3daa7] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:44.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:44.373+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:44.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:44.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@609065019 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:44.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000
2026-01-12T09:43:44.367+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:44.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000", parameters={masked}
2026-01-12T09:43:44.370+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.375+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:44.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:44.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:44.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:44.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:44.375+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.375+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:44.375+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:44.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:44.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:44.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:44.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16731f08] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:44.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:44.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20901b10] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@701435938 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:44.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1676809298 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:44.382+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:44.382+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:44.383+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:44.384+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.382+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.383+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.383+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:44.383+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:44.385+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.391+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.391+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64da3ee2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.385+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42ac9e0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.387+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.389+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:44.392+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@170003206 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:44.393+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:44.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:44.392+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1302349479 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:44.397+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:44.392+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5fb4f89b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.398+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:44.398+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1047515584 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:44.399+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:44.400+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:44.417+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:44.417+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:44.418+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:44.418+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75f3daa7]
2026-01-12T09:43:44.418+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@16731f08]
2026-01-12T09:43:44.418+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@20901b10]
2026-01-12T09:43:44.419+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.419+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:44.420+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:44.423+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:44.424+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:44.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42ac9e0]
2026-01-12T09:43:44.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64da3ee2]
2026-01-12T09:43:44.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5fb4f89b]
2026-01-12T09:43:44.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@9668a72] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:44.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.428+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@123948809 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:44.433+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:44.433+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:44.434+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:44.435+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:44.445+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.448+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.448+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.449+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:44.451+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:44.454+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:44.463+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:44.467+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:44.474+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:44.473+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:44.475+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:44.475+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:44.475+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:44.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:44.477+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.477+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.477+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@9668a72]
2026-01-12T09:43:44.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@18be8143] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.479+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2070194208 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:44.479+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44d7c98d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.479+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@d89e823] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.480+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:44.480+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2036334207 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.481+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@136685691 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:44.482+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:44.482+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:44.482+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:44.484+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:44.486+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:44.489+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:44.490+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@18be8143]
2026-01-12T09:43:44.497+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:44.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:44.501+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:44.502+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@44d7c98d]
2026-01-12T09:43:44.502+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@d89e823]
2026-01-12T09:43:44.507+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.510+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.510+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.522+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@529daa2f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.523+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64e00ad] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.524+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@679250512 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.526+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1153706167 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:44.526+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:44.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:44.528+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:44.529+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:44.531+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:44.531+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:44.531+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@529daa2f]
2026-01-12T09:43:44.532+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64e00ad]
2026-01-12T09:43:44.532+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.532+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.533+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ce3e8b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.533+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:44.534+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@977088719 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.534+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:44.534+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.540+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:44.545+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:44.548+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ce3e8b]
2026-01-12T09:43:44.548+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.549+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@693fe73a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.549+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@502380272 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.550+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:44.550+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:44.552+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:44.556+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@693fe73a]
2026-01-12T09:43:44.556+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.557+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@40569d4b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.557+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1455862860 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.558+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:44.558+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:44.560+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:44.561+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@40569d4b]
2026-01-12T09:43:44.562+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.563+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:44.564+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.566+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000
2026-01-12T09:43:44.627+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:44.627+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:44.630+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:44.632+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:44.765+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:44.767+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:44.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.640+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses
2026-01-12T09:43:44.773+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.688+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:44.762+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:44.766+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:44.772+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:44.775+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:44.773+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000
2026-01-12T09:43:44.774+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.774+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:44.775+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:44.775+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:44.777+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.778+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000", parameters={masked}
2026-01-12T09:43:44.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.778+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:44.778+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:44.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:44.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:44.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:44.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:44.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:44.781+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:44.781+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:44.798+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.800+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@738d8101] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.813+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.813+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.814+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1ee61ce5] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.814+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1407540475 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:44.815+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.815+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.816+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@522b5956] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.817+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.817+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1599202445 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.817+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:44.818+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.818+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.820+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1883965708 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:44.820+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.820+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:44.821+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@65740f18] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.821+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:44.822+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e3e0e54] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.822+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:44.823+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2cc09eb6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.824+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:44.825+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1349255290 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:44.826+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1710480342 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:44.827+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:44.828+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2130130695 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:44.828+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:44.829+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:44.829+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:44.830+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:44.831+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:44.832+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@738d8101]
2026-01-12T09:43:44.833+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:44.833+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:44.833+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:44.834+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:44.835+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1ee61ce5]
2026-01-12T09:43:44.836+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.838+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@522b5956]
2026-01-12T09:43:44.840+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.841+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:44.841+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.843+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ffeeed1] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.844+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:44.844+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.844+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1632748287 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:44.847+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.848+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:44.850+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:44.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:44.851+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:44.859+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:44.862+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e3e0e54]
2026-01-12T09:43:44.863+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:44.863+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:44.863+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@65740f18]
2026-01-12T09:43:44.863+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2cc09eb6]
2026-01-12T09:43:44.864+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.866+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.864+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:44.864+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4ffeeed1]
2026-01-12T09:43:44.865+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.865+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:44.866+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:44.867+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@234e49e8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.867+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:44.868+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.868+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:44.872+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:44.873+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.876+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@190006809 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:44.876+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:44.878+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ec27af6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.883+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1718787993 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.889+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:44.879+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:44.879+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:44.882+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:44.882+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:44.893+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:44.894+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:44.895+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.897+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:44.897+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:44.904+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.899+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.902+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:44.905+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:44.906+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.906+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78c4c02] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.907+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:44.907+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:44.908+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.910+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:44.911+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1809080617 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:44.912+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:44.913+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:44.913+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:44.913+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5300f980] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.914+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5ec27af6]
2026-01-12T09:43:44.914+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:44.914+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@234e49e8]
2026-01-12T09:43:44.915+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.915+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.915+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@730379099 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:44.915+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.917+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 12(Long), 1(Long)
2026-01-12T09:43:44.918+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.918+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.920+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.921+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:44.921+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1981a3ea] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.925+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:44.926+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 0
2026-01-12T09:43:44.927+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.927+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.929+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:44.929+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1423540198 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.930+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78c4c02]
2026-01-12T09:43:44.930+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.931+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46144aec] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@423b7757] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:44.934+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.937+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:44.942+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@816411115 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:44.945+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:44.949+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:44.943+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@921896606 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:44.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:44.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[])]
2026-01-12T09:43:44.945+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:44.946+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:44.951+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:44.957+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.961+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:44.961+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5300f980]
2026-01-12T09:43:44.964+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:44.964+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:44.972+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:44.973+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.974+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@46144aec]
2026-01-12T09:43:44.974+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:44.974+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:44.975+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:44.976+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.977+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1981a3ea]
2026-01-12T09:43:44.978+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.980+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.980+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:44.980+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:44.982+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.982+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:44.983+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@423b7757]
2026-01-12T09:43:44.984+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7054608a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.984+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.989+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:44.990+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:44.991+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1692275609 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:44.992+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@112a2757] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:44.992+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:44.993+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:44.993+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@246426106 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:44.994+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:44.998+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:44.998+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:45.006+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:45.006+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 28
2026-01-12T09:43:45.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7054608a]
2026-01-12T09:43:45.011+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:45.011+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@702c9d40] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:45.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@590341119 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:45.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:45.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:45.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:45.012+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@112a2757]
2026-01-12T09:43:45.013+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:45.013+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@630b7ef1] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:45.014+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@593231192 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:45.014+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:45.014+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:45.014+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@702c9d40]
2026-01-12T09:43:45.015+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:45.015+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:45.016+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@776b14a2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:45.017+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1664700818 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:45.017+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:45.017+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:45.018+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 12(Long)
2026-01-12T09:43:45.018+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@630b7ef1]
2026-01-12T09:43:45.018+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:45.021+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:45.021+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:45.022+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@776b14a2]
2026-01-12T09:43:45.022+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:45.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:45.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:45.034+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:45.095+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/status
2026-01-12T09:43:45.095+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/pending
2026-01-12T09:43:45.097+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/status
2026-01-12T09:43:45.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/status
2026-01-12T09:43:45.096+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:45.096+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:45.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/summary/by-category
2026-01-12T09:43:45.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/pending
2026-01-12T09:43:45.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/status", parameters={}
2026-01-12T09:43:45.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/expenses/tax/monthly-summary
2026-01-12T09:43:45.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/summary/by-category?status%5B%5D=APPROVED
2026-01-12T09:43:45.102+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/pending
2026-01-12T09:43:45.103+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxStatus(String, String)
2026-01-12T09:43:45.104+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/monthly-summary
2026-01-12T09:43:45.104+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/summary/by-category?status%5B%5D=APPROVED", parameters={masked}
2026-01-12T09:43:45.104+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/pending", parameters={}
2026-01-12T09:43:45.104+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:45.104+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/monthly-summary", parameters={}
2026-01-12T09:43:45.104+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getCategorySummary(String, String, String[], Boolean)
2026-01-12T09:43:45.105+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxPendingReports(String, String)
2026-01-12T09:43:45.105+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxStatus(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:45.105+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMonthlyTaxSummary(String, String)
2026-01-12T09:43:45.106+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:45.107+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:45.109+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:45.110+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:45.110+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getCategorySummary(java.lang.String,java.lang.String,java.lang.String[],java.lang.Boolean); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:45.111+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getTaxPendingReports(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:45.111+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@489b26b8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:45.112+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public com.innersignature.backend.dto.ApiResponse com.innersignature.backend.controller.ExpenseController.getMonthlyTaxSummary(java.lang.String,java.lang.String); target is of class [com.innersignature.backend.controller.ExpenseController]
2026-01-12T09:43:45.113+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:45.114+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:45.114+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1089615636 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:45.115+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==>  Preparing: SELECT COUNT(*) AS totalCount, SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN 1 ELSE 0 END) AS pendingCount, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, CASE WHEN COUNT(*) > 0 THEN CAST(SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*) ELSE 0.0 END AS completionRate, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN (tax_processed = 0 OR tax_processed IS NULL) THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS pendingAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ?
2026-01-12T09:43:45.114+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:45.114+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@23dcf17c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:45.115+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@61a1e162] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:45.118+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : ==> Parameters: 1(Long)
2026-01-12T09:43:45.125+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1331f833] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:45.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1712666320 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:45.126+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@529735596 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:45.127+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1122099892 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:45.128+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:45.129+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.status = 'APPROVED' AND (r.tax_processed = 0 OR r.tax_processed IS NULL) AND r.company_id = ? ORDER BY r.report_date DESC, r.expense_report_id DESC
2026-01-12T09:43:45.129+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==>  Preparing: SELECT DATE_FORMAT(report_date, '%Y-%m') AS yearMonth, SUM(CASE WHEN tax_processed = 1 THEN 1 ELSE 0 END) AS completedCount, COALESCE(SUM(COALESCE(actual_paid_amount, total_amount)), 0) AS totalAmount, COALESCE(SUM(CASE WHEN tax_processed = 1 THEN COALESCE(actual_paid_amount, total_amount) ELSE 0 END), 0) AS completedAmount FROM expense_report_tb WHERE status = 'APPROVED' AND company_id = ? GROUP BY DATE_FORMAT(report_date, '%Y-%m') ORDER BY yearMonth ASC
2026-01-12T09:43:45.130+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.ExpenseMapper.selectTaxStatus    : <==      Total: 1
2026-01-12T09:43:45.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 12(Long)
2026-01-12T09:43:45.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : ==> Parameters: 1(Long)
2026-01-12T09:43:45.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : ==> Parameters: 1(Long)
2026-01-12T09:43:45.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@489b26b8]
2026-01-12T09:43:45.137+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:45.139+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 자료 수집 현황 통계 조회 성공, data=TaxStatusDto(totalCount=19, pendingCoun (truncated)...]
2026-01-12T09:43:45.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:45.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectTaxPendingReports        : <==      Total: 19
2026-01-12T09:43:45.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectMonthlyTaxSummary        : <==      Total: 2
2026-01-12T09:43:45.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@23dcf17c]
2026-01-12T09:43:45.141+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@61a1e162]
2026-01-12T09:43:45.141+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:45.141+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1331f833]
2026-01-12T09:43:45.141+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:45.142+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:45.144+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:45.144+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무처리 대기 건 조회 성공, data=[ExpenseReportDto(expenseReportId=39, drafte (truncated)...]
2026-01-12T09:43:45.144+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7e344220] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:45.145+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=월별 집계 조회 성공, data=[MonthlyTaxSummaryDto(yearMonth=2025-12, complet (truncated)...]
2026-01-12T09:43:45.145+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:45.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@984025995 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:45.148+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:45.158+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==>  Preparing: SELECT d.category AS category, COALESCE(SUM(COALESCE(d.actual_paid_amount, d.amount)), 0) AS totalAmount, COUNT(*) AS itemCount, COUNT(DISTINCT d.expense_report_id) AS reportCount FROM expense_detail_tb d JOIN expense_report_tb r ON d.expense_report_id = r.expense_report_id WHERE r.company_id = ? AND r.status IN ( ? ) GROUP BY d.category ORDER BY totalAmount DESC
2026-01-12T09:43:45.162+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : ==> Parameters: 1(Long), APPROVED(String)
2026-01-12T09:43:45.169+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectCategorySummary          : <==      Total: 6
2026-01-12T09:43:45.174+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7e344220]
2026-01-12T09:43:45.175+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:45.175+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=카테고리별 요약 조회 성공, data=[CategorySummaryDto(category=식대, totalAmount= (truncated)...]
2026-01-12T09:43:45.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:47.464+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/logout
2026-01-12T09:43:47.468+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing POST /api/logout
2026-01-12T09:43:47.470+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 12, role: TAX_ACCOUNTANT, companyId: 1, uri: /api/logout
2026-01-12T09:43:47.475+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured POST /api/logout
2026-01-12T09:43:47.475+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : POST "/api/logout", parameters={}
2026-01-12T09:43:47.477+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#logout(String, RefreshTokenRequest)
2026-01-12T09:43:47.529+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [UserController.RefreshTokenRequest(refreshToken=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxMiIsInVzZXJuYW1lIjo (truncated)...]
2026-01-12T09:43:47.583+09:00  INFO 21060 --- [http-nio-8080-exec-3] SECURITY                                 : LOGOUT userId=12
2026-01-12T09:43:47.593+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:47.594+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=로그아웃되었습니다., data=null)]
2026-01-12T09:43:47.595+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:50.420+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing POST /api/login
2026-01-12T09:43:50.420+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-12T09:43:50.420+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured POST /api/login
2026-01-12T09:43:50.421+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : POST "/api/login", parameters={}
2026-01-12T09:43:50.421+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#login(LoginRequest)
2026-01-12T09:43:50.422+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [UserController.LoginRequest(username=test_user1, password=1234)]
2026-01-12T09:43:50.422+09:00  INFO 21060 --- [http-nio-8080-exec-1] c.i.backend.controller.UserController    : 로그인 시도 - username: test_user1
2026-01-12T09:43:50.422+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:50.422+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@da34c42] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:50.424+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@316221122 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:50.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.findByUsername   : ==>  Preparing: SELECT * FROM user_tb WHERE username = ?
2026-01-12T09:43:50.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.findByUsername   : ==> Parameters: test_user1(String)
2026-01-12T09:43:50.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.findByUsername   : <==      Total: 1
2026-01-12T09:43:50.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@da34c42]
2026-01-12T09:43:50.511+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:50.511+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3bcaf963] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:50.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1931968414 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:50.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==>  Preparing: SELECT uc.user_company_id AS userCompanyId, uc.user_id AS userId, uc.company_id AS companyId, uc.role, uc.position, uc.is_active AS isActive, uc.is_primary AS isPrimary, uc.is_approver AS isApprover, uc.approval_status AS approvalStatus, uc.created_at AS createdAt, uc.updated_at AS updatedAt, u.korean_name AS koreanName, u.username, u.email, c.company_name AS companyName, c.company_code AS companyCode FROM user_company_tb uc INNER JOIN user_tb u ON uc.user_id = u.user_id INNER JOIN company_tb c ON uc.company_id = c.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' ORDER BY uc.is_primary DESC, uc.created_at DESC
2026-01-12T09:43:50.513+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : ==> Parameters: 2(Long)
2026-01-12T09:43:50.515+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.UserMapper.findUserCompanies     : <==      Total: 2
2026-01-12T09:43:50.515+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3bcaf963]
2026-01-12T09:43:50.516+09:00  INFO 21060 --- [http-nio-8080-exec-1] c.i.backend.controller.UserController    : 로그인 성공 - userId: 2, role: USER, companyId: 1
2026-01-12T09:43:50.516+09:00  INFO 21060 --- [http-nio-8080-exec-1] SECURITY                                 : LOGIN_SUCCESS userId=2 username=test_user1 role=USER
2026-01-12T09:43:50.518+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:50.518+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=로그인 성공, data={user=UserDto(userId=2, username=test_user1, password (truncated)...]
2026-01-12T09:43:50.520+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:50.879+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/companies
2026-01-12T09:43:50.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/companies
2026-01-12T09:43:50.881+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/companies
2026-01-12T09:43:50.882+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/companies", parameters={}
2026-01-12T09:43:50.883+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.CompanyController#getMyCompanies()
2026-01-12T09:43:50.883+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:50.883+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15d6066a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:50.886+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@581397177 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:50.887+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.U.findCompaniesByUserId          : ==>  Preparing: SELECT c.company_id AS companyId, c.company_code AS companyCode, c.company_name AS companyName, c.business_reg_no AS businessRegNo, c.representative_name AS representativeName, c.created_by AS createdBy, c.is_active AS isActive, c.created_at AS createdAt, c.updated_at AS updatedAt FROM company_tb c INNER JOIN user_company_tb uc ON c.company_id = uc.company_id WHERE uc.user_id = ? AND uc.approval_status = 'APPROVED' AND c.is_active = 1 ORDER BY uc.is_primary DESC, c.created_at DESC
2026-01-12T09:43:50.896+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.U.findCompaniesByUserId          : ==> Parameters: 2(Long)
2026-01-12T09:43:50.901+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.U.findCompaniesByUserId          : <==      Total: 2
2026-01-12T09:43:50.902+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15d6066a]
2026-01-12T09:43:50.907+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:50.910+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ApiResponse(success=true, message=조회 성공, data=[CompanyDto(companyId=1, companyCode=2C4PSB, companyNa (truncated)...]
2026-01-12T09:43:50.911+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:50.932+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:50.932+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:50.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:50.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:50.933+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:50.937+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:50.948+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:50.958+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:50.960+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:50.962+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:50.962+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:50.965+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:50.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:43:50.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:50.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:50.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:50.971+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&drafterName=test_user1", parameters={masked}
2026-01-12T09:43:50.967+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:50.968+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:50.972+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:50.973+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:50.976+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@772ea5fd] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:50.975+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@131b882b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:50.977+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:50.978+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@44352022 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:50.979+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@313f9bd6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:50.980+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:50.980+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@699298264 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:50.983+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:43:50.983+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:50.984+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 2(Long)
2026-01-12T09:43:50.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:50.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@472109881 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:50.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:43:50.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@772ea5fd]
2026-01-12T09:43:50.996+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:50.997+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@131b882b]
2026-01-12T09:43:50.997+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:50.997+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:50.997+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:50.998+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:50.998+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71ef5ae4] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:50.999+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:50.999+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1048239650 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.007+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:51.007+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.009+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.011+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:51.013+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@313f9bd6]
2026-01-12T09:43:51.014+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.015+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:51.016+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.017+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:51.017+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1be4986b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.024+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:51.024+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2128217581 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.024+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.024+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3cb3139b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71ef5ae4]
2026-01-12T09:43:51.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1144503304 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:51.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:43:51.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 2(Long)
2026-01-12T09:43:51.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.029+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1be4986b]
2026-01-12T09:43:51.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:51.034+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.037+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:51.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@687c8ef7] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.047+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:51.048+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:51.049+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:51.049+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1474585683 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.049+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3cb3139b]
2026-01-12T09:43:51.049+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:51.050+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.052+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.056+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.056+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:51.056+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3100ca02] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.057+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.058+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@976461500 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:51.066+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:43:51.067+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.072+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@687c8ef7]
2026-01-12T09:43:51.073+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.073+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:43:51.074+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10ecd807] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.074+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3100ca02]
2026-01-12T09:43:51.075+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@476833755 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.076+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.076+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.076+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@188c0782] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.076+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@795577931 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.078+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10ecd807]
2026-01-12T09:43:51.082+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.082+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.082+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@180b026e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@188c0782]
2026-01-12T09:43:51.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.084+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1537047435 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.084+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:43:51.084+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.086+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.095+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:51.097+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:51.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:51.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:51.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:51.106+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.107+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77e5c53d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.108+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@159894931 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.110+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:51.117+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:43:51.129+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:43:51.129+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.131+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@77e5c53d]
2026-01-12T09:43:51.131+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@180b026e]
2026-01-12T09:43:51.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69521db4] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.139+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a15ff57] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@818405774 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.141+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1442660375 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.142+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.145+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.147+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.151+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.151+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.151+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@69521db4]
2026-01-12T09:43:51.158+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a15ff57]
2026-01-12T09:43:51.158+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.159+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.160+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:43:51.160+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e7fbdc5] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.161+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2072315930 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.161+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.163+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.178+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:51.182+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:51.182+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.183+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:51.184+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e7fbdc5]
2026-01-12T09:43:51.185+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:51.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:51.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63d2feeb] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.192+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1884354241 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.194+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.193+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b865d0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.195+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.198+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1110566058 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:51.198+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:51.199+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.200+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:43:51.200+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63d2feeb]
2026-01-12T09:43:51.201+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.204+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6963abdb] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.206+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1196835102 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.206+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:43:51.207+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.207+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b865d0]
2026-01-12T09:43:51.207+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.208+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.208+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74c324b4] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.208+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@689619283 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:43:51.209+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.209+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.209+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.210+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6963abdb]
2026-01-12T09:43:51.211+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.212+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.212+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:51.212+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74c324b4]
2026-01-12T09:43:51.213+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.213+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.214+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:43:51.216+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.217+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.221+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:43:51.228+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.228+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&drafterName=test_user1", parameters={masked}
2026-01-12T09:43:51.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:51.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43a6c09d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1824985679 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43a6c09d]
2026-01-12T09:43:51.234+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.235+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51aae8d0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.238+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@620591184 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.238+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.239+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51aae8d0]
2026-01-12T09:43:51.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e65813a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.244+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1745815630 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.244+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e65813a]
2026-01-12T09:43:51.251+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.253+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@358e26e1] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.254+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2006977851 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.256+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.261+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.261+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@358e26e1]
2026-01-12T09:43:51.264+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.264+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3ecca81b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.266+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2058430477 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.269+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.272+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.279+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.279+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3ecca81b]
2026-01-12T09:43:51.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@18c7d1b6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.281+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2033014074 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.281+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.283+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.287+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.288+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@18c7d1b6]
2026-01-12T09:43:51.289+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.289+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a89940d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.290+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2095424651 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.290+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.290+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.293+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.293+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a89940d]
2026-01-12T09:43:51.295+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.295+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@426c7b4b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.296+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1423161079 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.298+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.299+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.302+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.303+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@426c7b4b]
2026-01-12T09:43:51.304+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.304+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f1e4cf0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.306+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1577703035 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:51.306+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.306+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.309+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.310+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f1e4cf0]
2026-01-12T09:43:51.312+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.312+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:51.313+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.317+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.324+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:43:51.327+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&drafterName=test_user1", parameters={masked}
2026-01-12T09:43:51.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:51.329+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.329+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@713faafb] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.331+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@403897715 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.331+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.332+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.334+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.335+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@713faafb]
2026-01-12T09:43:51.335+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.336+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5aaaae80] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.338+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@443261725 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.338+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.339+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.341+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.341+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5aaaae80]
2026-01-12T09:43:51.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3606a89b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@970444405 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.343+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:51.351+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:51.353+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:51.354+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:51.356+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:51.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4767a2b9] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3606a89b]
2026-01-12T09:43:51.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1535846918 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:51.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2608d8f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:43:51.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@27377448 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:43:51.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4767a2b9]
2026-01-12T09:43:51.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d51c2c7] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@668586430 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2608d8f]
2026-01-12T09:43:51.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6708bfff] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1627540068 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.367+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.367+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.368+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d51c2c7]
2026-01-12T09:43:51.369+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.370+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:43:51.370+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.371+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.373+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6708bfff]
2026-01-12T09:43:51.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:51.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78298333] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:51.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1526480014 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:51.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:51.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:51.383+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.385+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@606efa5] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.387+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@329733891 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.387+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.388+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:51.390+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78298333]
2026-01-12T09:43:51.394+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:43:51.394+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@735eaa0e] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.397+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1197117261 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.398+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.398+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:43:51.398+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.399+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@606efa5]
2026-01-12T09:43:51.399+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.400+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@60ed4fab] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.401+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.401+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1361575892 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.402+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@735eaa0e]
2026-01-12T09:43:51.402+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.403+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.403+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.403+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@259880d0] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.405+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@588271799 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.406+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.406+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.407+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.407+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@60ed4fab]
2026-01-12T09:43:51.408+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.408+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:43:51.409+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.409+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.424+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@259880d0]
2026-01-12T09:43:51.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4238eb5c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.431+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1856778271 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.432+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.432+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.434+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.434+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4238eb5c]
2026-01-12T09:43:51.435+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.435+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:51.439+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.445+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:43:51.446+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.447+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&drafterName=test_user1", parameters={masked}
2026-01-12T09:43:51.447+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:51.449+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.452+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79fecb0a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.454+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@429020522 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.456+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.457+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.459+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.460+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@79fecb0a]
2026-01-12T09:43:51.460+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.461+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@27727888] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.461+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@677069303 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.462+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.463+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.465+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.465+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@27727888]
2026-01-12T09:43:51.465+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.466+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5af0e78d] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.466+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1861382755 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.467+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.470+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.475+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.475+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5af0e78d]
2026-01-12T09:43:51.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74118c4a] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@696304074 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.477+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.479+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.480+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@74118c4a]
2026-01-12T09:43:51.480+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.481+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6ee7de89] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.482+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@376208579 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.482+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.483+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.490+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.492+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6ee7de89]
2026-01-12T09:43:51.492+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.493+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@b9c52c8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.494+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1541392036 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.495+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.497+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.501+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.501+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@b9c52c8]
2026-01-12T09:43:51.503+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.504+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c35a820] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.505+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@358002556 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.505+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.506+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.509+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.510+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7c35a820]
2026-01-12T09:43:51.510+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.511+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1f8d6f0c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.511+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1319673973 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.515+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.517+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1f8d6f0c]
2026-01-12T09:43:51.518+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.518+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13cdc2c2] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.519+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1741433528 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:43:51.520+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.521+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.523+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.526+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13cdc2c2]
2026-01-12T09:43:51.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:51.529+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.531+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.533+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:43:51.534+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&drafterName=test_user1", parameters={masked}
2026-01-12T09:43:51.535+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:51.538+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.539+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57a5a8df] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.539+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1932416635 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.540+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.540+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.542+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.547+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57a5a8df]
2026-01-12T09:43:51.548+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.548+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c80ed49] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.549+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1452886870 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.549+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.550+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.551+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.552+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c80ed49]
2026-01-12T09:43:51.554+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.554+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e13e459] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.555+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1968353399 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.555+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.557+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.561+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.562+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e13e459]
2026-01-12T09:43:51.562+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.562+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14e6dff3] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.562+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1435947034 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.563+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.563+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.565+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.566+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@14e6dff3]
2026-01-12T09:43:51.567+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.567+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@301c2d15] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.568+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@312960418 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.570+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.571+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.576+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.577+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@301c2d15]
2026-01-12T09:43:51.577+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.577+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ce6edaa] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.578+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@767759270 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.578+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.579+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.583+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.583+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ce6edaa]
2026-01-12T09:43:51.584+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.584+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@66dfa5b8] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.584+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@757043060 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.585+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.585+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.588+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.588+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@66dfa5b8]
2026-01-12T09:43:51.589+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.590+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1b597b34] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.590+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@11599746 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.591+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.591+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.594+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.594+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1b597b34]
2026-01-12T09:43:51.595+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.595+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6ef487da] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.596+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1042596331 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:51.596+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.596+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.598+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.598+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6ef487da]
2026-01-12T09:43:51.599+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.599+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:51.600+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.605+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.607+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:43:51.609+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.609+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&drafterName=test_user1", parameters={masked}
2026-01-12T09:43:51.610+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:51.611+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.612+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d6ffe3f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.615+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1447926062 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.615+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.615+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d6ffe3f]
2026-01-12T09:43:51.618+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.620+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@24318878] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.622+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@991510915 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.622+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.622+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.628+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.628+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@24318878]
2026-01-12T09:43:51.629+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.630+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f402293] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.631+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1201280331 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.631+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.632+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.635+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.637+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f402293]
2026-01-12T09:43:51.639+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.640+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e382a99] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1610794359 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.642+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.643+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.644+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.645+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@e382a99]
2026-01-12T09:43:51.645+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.646+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@33941ea6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.646+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2084017839 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.647+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.648+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.651+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.651+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@33941ea6]
2026-01-12T09:43:51.651+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.651+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50b47623] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.653+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1128670141 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.654+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.656+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.659+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.660+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50b47623]
2026-01-12T09:43:51.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4fc90302] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1019179446 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.662+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.663+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.663+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4fc90302]
2026-01-12T09:43:51.664+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.664+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f0fb0f6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.665+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1750691590 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.665+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.665+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.668+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.670+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f0fb0f6]
2026-01-12T09:43:51.671+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.672+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5671fe86] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.672+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1147894974 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:51.672+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.673+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.675+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.675+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5671fe86]
2026-01-12T09:43:51.676+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.676+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:51.677+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:51.679+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.681+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:43:51.681+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=1000&drafterName=test_user1
2026-01-12T09:43:51.682+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=1000&drafterName=test_user1", parameters={masked}
2026-01-12T09:43:51.683+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:43:51.684+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.687+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@73e60c57] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.689+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@169869346 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.690+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.691+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.693+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.693+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@73e60c57]
2026-01-12T09:43:51.695+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.695+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5868d34c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.697+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@464517282 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.697+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.698+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.699+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.701+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5868d34c]
2026-01-12T09:43:51.711+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.711+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@369ce43f] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.712+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@686859027 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.713+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.714+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.718+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.721+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@369ce43f]
2026-01-12T09:43:51.721+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.721+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b9a9cdf] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.723+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@720773775 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.723+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.723+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.726+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.726+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b9a9cdf]
2026-01-12T09:43:51.727+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.728+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a522454] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.729+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@352398245 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.730+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.730+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a522454]
2026-01-12T09:43:51.734+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.735+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@167428da] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.735+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1026543300 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.737+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:43:51.738+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:43:51.741+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:43:51.742+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@167428da]
2026-01-12T09:43:51.744+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.744+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b53f52b] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.744+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1549148771 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.747+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.747+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b53f52b]
2026-01-12T09:43:51.748+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.748+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4248ea43] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@918992268 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:43:51.750+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:43:51.752+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:43:51.753+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4248ea43]
2026-01-12T09:43:51.754+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:51.754+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@202feb25] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:51.755+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@623904657 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:51.755+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:51.755+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:51.757+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:51.758+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@202feb25]
2026-01-12T09:43:51.758+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:51.759+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:43:51.760+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:59.606+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/users/me/signatures
2026-01-12T09:43:59.607+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/38
2026-01-12T09:43:59.607+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/38
2026-01-12T09:43:59.608+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/users/me/signatures
2026-01-12T09:43:59.608+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:43:59.608+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:43:59.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/users/me/signatures
2026-01-12T09:43:59.613+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:43:59.615+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/38
2026-01-12T09:43:59.615+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:43:59.615+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:43:59.615+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/users/me/signatures
2026-01-12T09:43:59.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:43:59.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/38
2026-01-12T09:43:59.616+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:43:59.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/users/me/signatures
2026-01-12T09:43:59.619+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/users/me/signatures", parameters={}
2026-01-12T09:43:59.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:43:59.622+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:43:59.617+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/38
2026-01-12T09:43:59.618+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:43:59.621+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#getMySignatures()
2026-01-12T09:43:59.623+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.624+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/38", parameters={}
2026-01-12T09:43:59.624+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.626+09:00  INFO 21060 --- [http-nio-8080-exec-8] c.i.backend.controller.UserController    : 내 서명/도장 목록 조회 요청 - userId: 2, companyId: 1
2026-01-12T09:43:59.626+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43b186ed] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.627+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseDetail(Long)
2026-01-12T09:43:59.627+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5fcbe394] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.628+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.629+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.632+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@278c81e7] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.632+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55048914] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.634+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1761156163 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:59.640+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:43:59.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 2(Long)
2026-01-12T09:43:59.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@996598768 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:59.641+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@488985399 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:59.643+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:43:59.643+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.U.findByUserId                   : ==>  Preparing: SELECT * FROM user_signature_tb WHERE user_id = ? AND company_id = ? ORDER BY is_default DESC, created_at DESC
2026-01-12T09:43:59.646+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:43:59.646+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@459502929 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:59.647+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.U.findByUserId                   : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:43:59.647+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:43:59.647+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseReportById        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ?
2026-01-12T09:43:59.648+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43b186ed]
2026-01-12T09:43:59.650+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseReportById        : ==> Parameters: 38(Long), 1(Long)
2026-01-12T09:43:59.654+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:59.656+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:43:59.659+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:43:59.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:59.663+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.U.findByUserId                   : <==      Total: 1
2026-01-12T09:43:59.665+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5fcbe394]
2026-01-12T09:43:59.676+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseReportById        : <==      Total: 1
2026-01-12T09:43:59.683+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@278c81e7]
2026-01-12T09:43:59.687+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.687+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55048914]
2026-01-12T09:43:59.689+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:59.689+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e780077] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.690+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.692+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@277463438 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:43:59.692+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@640d7fd6] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.693+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:59.694+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@561732975 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:59.694+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=서명/도장 목록 조회 성공, data=[UserSignatureDto(signatureId=3, userId=2, si (truncated)...]
2026-01-12T09:43:59.694+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:59.694+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : ==>  Preparing: SELECT expense_detail_id, expense_report_id, category, merchant_name, description, amount, actual_paid_amount, payment_method, payment_req_date, card_number, is_pre_approval, note, is_tax_deductible, non_deductible_reason, company_id FROM expense_detail_tb WHERE expense_report_id = ? AND company_id = ?
2026-01-12T09:43:59.725+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:59.740+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : ==> Parameters: 38(Long), 1(Long)
2026-01-12T09:43:59.744+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/users/me/signatures
2026-01-12T09:43:59.759+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/users/me/signatures
2026-01-12T09:43:59.760+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:59.760+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : <==      Total: 1
2026-01-12T09:43:59.764+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/users/me/signatures
2026-01-12T09:43:59.766+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e780077]
2026-01-12T09:43:59.766+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@640d7fd6]
2026-01-12T09:43:59.766+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/users/me/signatures", parameters={}
2026-01-12T09:43:59.769+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:59.778+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#getMySignatures()
2026-01-12T09:43:59.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:43:59.779+09:00  INFO 21060 --- [http-nio-8080-exec-5] c.i.backend.controller.UserController    : 내 서명/도장 목록 조회 요청 - userId: 2, companyId: 1
2026-01-12T09:43:59.783+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:59.784+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.786+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.789+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3ea98160] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.788+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c05f0ac] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.793+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1761203523 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:59.794+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1968815716 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:43:59.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.U.findByUserId                   : ==>  Preparing: SELECT * FROM user_signature_tb WHERE user_id = ? AND company_id = ? ORDER BY is_default DESC, created_at DESC
2026-01-12T09:43:59.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-12T09:43:59.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.U.findByUserId                   : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:43:59.796+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 38(Long), 1(Long)
2026-01-12T09:43:59.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.U.findByUserId                   : <==      Total: 1
2026-01-12T09:43:59.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : <==      Total: 1
2026-01-12T09:43:59.804+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c05f0ac]
2026-01-12T09:43:59.807+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3ea98160]
2026-01-12T09:43:59.808+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:59.810+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.811+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=서명/도장 목록 조회 성공, data=[UserSignatureDto(signatureId=3, userId=2, si (truncated)...]
2026-01-12T09:43:59.812+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3478c8b1] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.815+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:59.817+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@311247024 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:59.823+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseReportId : ==>  Preparing: SELECT r.*, u.korean_name AS uploadedByName FROM receipt_tb r JOIN user_tb u ON r.uploaded_by = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ? ORDER BY r.uploaded_at DESC
2026-01-12T09:43:59.824+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseReportId : ==> Parameters: 38(Long), 1(Long)
2026-01-12T09:43:59.832+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseReportId : <==      Total: 1
2026-01-12T09:43:59.834+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3478c8b1]
2026-01-12T09:43:59.840+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.844+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c678a92] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.845+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2116613871 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:43:59.846+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:43:59.846+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:43:59.862+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:43:59.864+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@c678a92]
2026-01-12T09:43:59.865+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:43:59.883+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=상세 조회 성공, data=ExpenseReportDto(expenseReportId=38, drafterId=2, r (truncated)...]
2026-01-12T09:43:59.892+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:43:59.903+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/38
2026-01-12T09:43:59.910+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/38
2026-01-12T09:43:59.911+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/38
2026-01-12T09:43:59.911+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/38", parameters={}
2026-01-12T09:43:59.912+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseDetail(Long)
2026-01-12T09:43:59.924+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.925+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@bfa920c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.926+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1423124117 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:59.928+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseReportById        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ?
2026-01-12T09:43:59.929+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseReportById        : ==> Parameters: 38(Long), 1(Long)
2026-01-12T09:43:59.971+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseReportById        : <==      Total: 1
2026-01-12T09:43:59.972+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@bfa920c]
2026-01-12T09:43:59.972+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:43:59.975+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1a2bc79c] was not registered for synchronization because synchronization is not active
2026-01-12T09:43:59.976+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1168006183 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:43:59.978+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetails           : ==>  Preparing: SELECT expense_detail_id, expense_report_id, category, merchant_name, description, amount, actual_paid_amount, payment_method, payment_req_date, card_number, is_pre_approval, note, is_tax_deductible, non_deductible_reason, company_id FROM expense_detail_tb WHERE expense_report_id = ? AND company_id = ?
2026-01-12T09:43:59.984+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetails           : ==> Parameters: 38(Long), 1(Long)
2026-01-12T09:43:59.998+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetails           : <==      Total: 1
2026-01-12T09:43:59.999+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1a2bc79c]
2026-01-12T09:43:59.999+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:00.001+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c9209af] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:00.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1757494406 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:00.014+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-12T09:44:00.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 38(Long), 1(Long)
2026-01-12T09:44:00.043+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectApprovalLines            : <==      Total: 1
2026-01-12T09:44:00.045+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c9209af]
2026-01-12T09:44:00.048+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:00.050+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76f8acf6] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:00.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1251679479 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:00.056+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] .i.b.m.E.selectReceiptsByExpenseReportId : ==>  Preparing: SELECT r.*, u.korean_name AS uploadedByName FROM receipt_tb r JOIN user_tb u ON r.uploaded_by = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ? ORDER BY r.uploaded_at DESC
2026-01-12T09:44:00.058+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] .i.b.m.E.selectReceiptsByExpenseReportId : ==> Parameters: 38(Long), 1(Long)
2026-01-12T09:44:00.063+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] .i.b.m.E.selectReceiptsByExpenseReportId : <==      Total: 1
2026-01-12T09:44:00.064+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@76f8acf6]
2026-01-12T09:44:00.065+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:00.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d16244a] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:00.078+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@247111682 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:00.079+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:00.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:00.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:00.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3d16244a]
2026-01-12T09:44:00.091+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:00.092+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=상세 조회 성공, data=ExpenseReportDto(expenseReportId=38, drafterId=2, r (truncated)...]
2026-01-12T09:44:00.093+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:00.958+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:44:00.958+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:00.959+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/my-approvals
2026-01-12T09:44:00.961+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:00.959+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=10
2026-01-12T09:44:00.961+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:44:00.962+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/my-approvals
2026-01-12T09:44:00.962+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:00.968+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:00.965+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:44:00.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:44:00.966+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/my-approvals
2026-01-12T09:44:00.987+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:00.988+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=10
2026-01-12T09:44:00.988+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:44:00.989+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/my-approvals", parameters={}
2026-01-12T09:44:00.989+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:00.990+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=10", parameters={masked}
2026-01-12T09:44:00.990+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:44:00.991+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMyApprovals()
2026-01-12T09:44:00.991+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57ed3c0c] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:00.992+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:44:00.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:00.992+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:00.993+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:00.995+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ef63ffc] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:00.996+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2dcb4175] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:00.996+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@253fe401] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.006+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@321400587 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:01.007+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@693876667 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:44:01.007+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@98434666 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.007+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1166609047 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:44:01.009+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.009+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] .i.b.m.E.selectMyApprovedReportsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status IN ('APPROVED', 'REJECTED') AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.010+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.011+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.013+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] .i.b.m.E.selectMyApprovedReportsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:01.013+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 2(Long)
2026-01-12T09:44:01.014+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:01.021+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.021+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:44:01.022+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] .i.b.m.E.selectMyApprovedReportsByUserId : <==      Total: 2
2026-01-12T09:44:01.023+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:01.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@ef63ffc]
2026-01-12T09:44:01.025+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2dcb4175]
2026-01-12T09:44:01.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@253fe401]
2026-01-12T09:44:01.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@57ed3c0c]
2026-01-12T09:44:01.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.026+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1eb2de81] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:44:01.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ba15fc8] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a5304e] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.029+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@159349794 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:01.029+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.030+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1116864508 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:44:01.032+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@208485447 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:44:01.032+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.033+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.034+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.034+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.035+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.041+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:44:01.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ba15fc8]
2026-01-12T09:44:01.048+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1eb2de81]
2026-01-12T09:44:01.049+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:44:01.050+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4a5304e]
2026-01-12T09:44:01.050+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.050+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:44:01.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.051+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32a33c53] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.056+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a1cad10] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.057+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:44:01.057+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:01.058+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1133345488 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:44:01.058+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1381115396 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:01.058+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:44:01.059+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:01.059+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.059+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:01.067+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:01.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:01.061+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 12(Long), 8(Long)
2026-01-12T09:44:01.076+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a13da7f] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.077+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:01.079+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1889852829 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.079+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:01.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.080+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:01.082+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 2
2026-01-12T09:44:01.082+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:01.083+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 2(Long)
2026-01-12T09:44:01.084+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:01.084+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@32a33c53]
2026-01-12T09:44:01.084+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a1cad10]
2026-01-12T09:44:01.087+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.085+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.085+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.089+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@11a1b6a4] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:44:01.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6238166a] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@23f3cc53] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.090+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@787148205 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:01.091+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a13da7f]
2026-01-12T09:44:01.092+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@144256474 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:44:01.096+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.098+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@95158458 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:01.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.099+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:44:01.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.100+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.101+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.111+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:01.123+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:44:01.130+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.132+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:44:01.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@11a1b6a4]
2026-01-12T09:44:01.133+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:44:01.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.138+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@23f3cc53]
2026-01-12T09:44:01.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:44:01.134+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:01.139+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3b538105] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.140+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:44:01.142+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6238166a]
2026-01-12T09:44:01.144+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=내 결재 문서 조회 성공, data=[ExpenseReportDto(expenseReportId=12, drafterI (truncated)...]
2026-01-12T09:44:01.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@660276317 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:01.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.146+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.147+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.147+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:01.148+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e0abbc3] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.149+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@56ccaaa5] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.156+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/my-approvals
2026-01-12T09:44:01.161+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:01.162+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@177661239 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:01.164+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2124701165 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:01.165+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/my-approvals
2026-01-12T09:44:01.165+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.166+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/my-approvals
2026-01-12T09:44:01.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.167+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:01.173+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 2(Long)
2026-01-12T09:44:01.175+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/my-approvals", parameters={}
2026-01-12T09:44:01.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3b538105]
2026-01-12T09:44:01.178+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMyApprovals()
2026-01-12T09:44:01.178+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.181+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:44:01.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f3cbd24] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.181+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.181+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@455ddf94] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.182+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e0abbc3]
2026-01-12T09:44:01.183+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1220559471 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:01.185+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@56ccaaa5]
2026-01-12T09:44:01.192+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.189+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1189005059 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:01.193+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:01.193+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] .i.b.m.E.selectMyApprovedReportsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status IN ('APPROVED', 'REJECTED') AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.194+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:44:01.196+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:01.196+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.198+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] .i.b.m.E.selectMyApprovedReportsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:01.199+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.223+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:01.226+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] .i.b.m.E.selectMyApprovedReportsByUserId : <==      Total: 2
2026-01-12T09:44:01.226+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:01.226+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:01.228+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@455ddf94]
2026-01-12T09:44:01.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:01.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f3cbd24]
2026-01-12T09:44:01.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:01.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@513ce15c] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.232+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:01.232+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@41818b42] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.232+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2050373008 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1272892363 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:01.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19c53d2] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2135154340 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:01.234+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.234+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.237+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.237+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.237+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:01.237+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@513ce15c]
2026-01-12T09:44:01.237+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@41818b42]
2026-01-12T09:44:01.238+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.238+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.239+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@53ec648f] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.239+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f6f5e5] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.240+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1701599663 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.240+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1298183458 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:01.241+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:01.241+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:01.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 12(Long), 8(Long)
2026-01-12T09:44:01.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:01.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:01.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@19c53d2]
2026-01-12T09:44:01.244+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.245+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 2
2026-01-12T09:44:01.245+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ad899a8] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.245+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@53ec648f]
2026-01-12T09:44:01.245+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:01.245+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@423184354 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:01.245+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.245+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@f6f5e5]
2026-01-12T09:44:01.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@640fc4b9] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.248+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1425476779 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.248+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48fdaa3b] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2131961628 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:01.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.251+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7ad899a8]
2026-01-12T09:44:01.253+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.255+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:01.255+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.258+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.258+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@640fc4b9]
2026-01-12T09:44:01.259+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48fdaa3b]
2026-01-12T09:44:01.260+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:01.265+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.265+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.267+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=내 결재 문서 조회 성공, data=[ExpenseReportDto(expenseReportId=12, drafterI (truncated)...]
2026-01-12T09:44:01.267+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:01.268+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:44:01.269+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.273+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:01.273+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:01.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:01.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.283+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=10
2026-01-12T09:44:01.284+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4eb8186e] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.289+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:44:01.289+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1107317127 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:01.290+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=10
2026-01-12T09:44:01.290+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.290+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=10", parameters={masked}
2026-01-12T09:44:01.291+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:01.291+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:44:01.293+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.296+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3b8617ca] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.297+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:01.299+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1717569658 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.299+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4eb8186e]
2026-01-12T09:44:01.300+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.300+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.300+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.300+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26c69196] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.305+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@674465352 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:01.305+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.305+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.309+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.309+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.310+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3b8617ca]
2026-01-12T09:44:01.310+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26c69196]
2026-01-12T09:44:01.310+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.311+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.311+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@49ee2d11] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.319+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:01.322+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1121803169 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.323+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.329+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.331+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:01.340+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:01.341+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:01.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:01.345+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:01.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@49ee2d11]
2026-01-12T09:44:01.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8107092] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@630851230 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:44:01.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@cb7bfad] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.348+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.348+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@873045391 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:01.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:01.356+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:01.356+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:01.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@8107092]
2026-01-12T09:44:01.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2bb101a5] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@539914401 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:44:01.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:01.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@cb7bfad]
2026-01-12T09:44:01.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d9a6958] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1281489809 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2bb101a5]
2026-01-12T09:44:01.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:01.371+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.371+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.372+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7d9a6958]
2026-01-12T09:44:01.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26883a3c] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.387+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@150357788 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.389+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:01.392+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:01.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:01.397+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26883a3c]
2026-01-12T09:44:01.397+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.398+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@183424bc] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.399+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2131403868 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.399+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:01.406+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:01.410+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:01.411+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@183424bc]
2026-01-12T09:44:01.412+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.412+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4abe1dc1] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.413+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1930871278 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.413+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.413+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.415+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.415+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4abe1dc1]
2026-01-12T09:44:01.417+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.417+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6a49b442] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.420+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1352924383 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.423+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:01.424+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:01.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:01.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6a49b442]
2026-01-12T09:44:01.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@690bc7ac] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.428+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1321702763 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.428+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.431+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@690bc7ac]
2026-01-12T09:44:01.432+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.432+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:44:01.433+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.650+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:01.651+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:01.652+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:01.652+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:01.653+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:01.653+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.653+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70036e1e] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.654+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1424462403 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.655+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.657+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:01.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:01.661+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@70036e1e]
2026-01-12T09:44:01.662+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.663+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c2ea05a] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.663+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1203132511 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:01.663+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.664+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.666+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.666+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2c2ea05a]
2026-01-12T09:44:01.666+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.667+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:01.667+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:01.675+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:01.677+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:01.678+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:01.679+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:01.679+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:01.681+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.681+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e20aeaf] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.684+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@574256682 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:44:01.684+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:01.686+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:01.690+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:01.690+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e20aeaf]
2026-01-12T09:44:01.691+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:01.692+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@d45ebbb] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:01.692+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@231372143 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:44:01.693+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:01.693+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:01.695+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:01.695+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@d45ebbb]
2026-01-12T09:44:01.697+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:01.697+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:01.698+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:05.207+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses?page=2&size=10
2026-01-12T09:44:05.210+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=2&size=10
2026-01-12T09:44:05.212+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:44:05.212+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=2&size=10
2026-01-12T09:44:05.213+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=2&size=10", parameters={masked}
2026-01-12T09:44:05.214+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:44:05.215+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.215+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7fc5a871] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.219+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2023282968 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.220+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:05.221+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:05.223+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:05.224+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7fc5a871]
2026-01-12T09:44:05.225+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.225+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78085ca2] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.226+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@566521289 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.226+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:05.227+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:05.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:05.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78085ca2]
2026-01-12T09:44:05.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@52c6bd82] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1754334772 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:05.232+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:05.237+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:05.240+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@52c6bd82]
2026-01-12T09:44:05.241+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@24da84dd] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1125582697 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:05.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:05.244+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:05.245+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@24da84dd]
2026-01-12T09:44:05.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.246+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5eed6ed] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.247+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1977767649 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.248+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:05.248+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:05.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:05.251+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5eed6ed]
2026-01-12T09:44:05.254+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.255+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15b570e5] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.256+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1713341696 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:05.259+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:05.262+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:05.262+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15b570e5]
2026-01-12T09:44:05.264+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.264+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26e40fc1] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.264+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@417886624 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.264+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:05.265+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:05.267+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:05.267+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26e40fc1]
2026-01-12T09:44:05.267+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.268+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f168c6e] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.270+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1762270282 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.271+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:05.272+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:05.275+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:05.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6f168c6e]
2026-01-12T09:44:05.277+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.277+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e5cc7c4] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1173507485 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:05.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:05.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:05.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1e5cc7c4]
2026-01-12T09:44:05.281+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:05.281+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:44:05.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:05.356+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:05.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:05.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:05.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:05.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:05.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1ab414b6] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@614452113 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:05.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:05.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:05.367+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1ab414b6]
2026-01-12T09:44:05.370+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.370+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7fc8fe35] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.371+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1172522206 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:05.372+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:05.372+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:05.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:05.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7fc8fe35]
2026-01-12T09:44:05.375+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:05.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:05.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:05.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:05.393+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:05.394+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:05.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:05.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:05.396+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.396+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@167822b4] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.398+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1614205352 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:05.399+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:05.401+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:05.404+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:05.404+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@167822b4]
2026-01-12T09:44:05.405+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:05.406+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@68370f9c] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:05.407+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@604346914 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:05.408+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:05.409+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:05.411+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:05.411+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@68370f9c]
2026-01-12T09:44:05.412+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:05.412+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:05.413+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:06.471+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=10
2026-01-12T09:44:06.472+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:44:06.473+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=10
2026-01-12T09:44:06.473+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=10", parameters={masked}
2026-01-12T09:44:06.473+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:44:06.474+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.474+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2aacfe42] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1776867441 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:06.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:06.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:06.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:06.479+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2aacfe42]
2026-01-12T09:44:06.479+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.479+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1efc19a] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.479+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@667323180 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:06.480+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:06.480+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:06.483+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:06.483+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1efc19a]
2026-01-12T09:44:06.484+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.484+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@27d47c74] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.484+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1489541637 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:06.485+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:06.489+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:06.492+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:06.492+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@27d47c74]
2026-01-12T09:44:06.495+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.495+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@543e551a] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.497+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1343071285 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:06.497+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:06.498+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:06.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:06.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@543e551a]
2026-01-12T09:44:06.501+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.501+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@200f5ae4] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.505+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@113204602 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:06.507+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:06.509+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:06.512+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:06.514+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@200f5ae4]
2026-01-12T09:44:06.514+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.515+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f07cb7e] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.515+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1694858752 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:06.515+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:06.517+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:06.520+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:06.520+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3f07cb7e]
2026-01-12T09:44:06.521+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.522+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5127272b] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.522+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1358580298 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:06.523+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:06.523+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:06.525+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:06.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5127272b]
2026-01-12T09:44:06.527+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.528+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6a42aca7] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.528+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@37015739 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:06.528+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:06.529+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:06.531+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:06.531+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6a42aca7]
2026-01-12T09:44:06.532+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.532+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10967916] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.533+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1867434039 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:06.533+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:06.533+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:06.536+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:06.537+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@10967916]
2026-01-12T09:44:06.539+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:06.539+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:44:06.540+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:06.714+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:06.714+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:06.715+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:06.715+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:06.715+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:06.715+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.716+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b16ea31] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.718+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1568359491 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:06.718+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:06.721+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:06.724+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:06.724+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7b16ea31]
2026-01-12T09:44:06.724+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.724+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a9cfad] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.725+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@529356978 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:06.725+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:06.725+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:06.727+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:06.727+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2a9cfad]
2026-01-12T09:44:06.728+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:06.728+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:06.729+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:06.730+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:06.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:06.733+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:06.734+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:06.734+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:06.734+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.735+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@118af4f5] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.739+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1634576067 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:44:06.740+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:06.742+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:06.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:06.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@118af4f5]
2026-01-12T09:44:06.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:06.745+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b698767] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:06.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1124020321 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:44:06.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:06.746+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:06.748+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:06.748+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b698767]
2026-01-12T09:44:06.748+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:06.749+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:06.750+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:08.241+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:08.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:44:08.244+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:08.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/3
2026-01-12T09:44:08.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/3
2026-01-12T09:44:08.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/users/me/signatures
2026-01-12T09:44:08.244+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:44:08.245+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:08.247+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:08.247+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:44:08.247+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/users/me/signatures
2026-01-12T09:44:08.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:08.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:44:08.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/3
2026-01-12T09:44:08.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/users/me/signatures
2026-01-12T09:44:08.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:44:08.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/users/me/signatures", parameters={}
2026-01-12T09:44:08.251+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6ea9a83b] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.252+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/3
2026-01-12T09:44:08.256+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.256+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#getMySignatures()
2026-01-12T09:44:08.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/3
2026-01-12T09:44:08.259+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@623425bf] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.259+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@733384294 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:08.259+09:00  INFO 21060 --- [http-nio-8080-exec-4] c.i.backend.controller.UserController    : 내 서명/도장 목록 조회 요청 - userId: 2, companyId: 1
2026-01-12T09:44:08.260+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/3", parameters={}
2026-01-12T09:44:08.260+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:08.260+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.261+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseDetail(Long)
2026-01-12T09:44:08.261+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1312863828 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:08.263+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:08.264+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e2822ce] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.264+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.266+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:44:08.267+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c66c6de] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.270+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 2(Long)
2026-01-12T09:44:08.273+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1098613702 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:08.274+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 2
2026-01-12T09:44:08.275+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.U.findByUserId                   : ==>  Preparing: SELECT * FROM user_signature_tb WHERE user_id = ? AND company_id = ? ORDER BY is_default DESC, created_at DESC
2026-01-12T09:44:08.275+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6ea9a83b]
2026-01-12T09:44:08.275+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1543364567 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:08.275+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:44:08.275+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.U.findByUserId                   : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:08.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseReportById        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ?
2026-01-12T09:44:08.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@623425bf]
2026-01-12T09:44:08.277+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6734b021] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseReportById        : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:08.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:08.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2133012286 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:08.283+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:44:08.284+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:08.285+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:08.286+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:08.287+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.U.findByUserId                   : <==      Total: 1
2026-01-12T09:44:08.294+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6e2822ce]
2026-01-12T09:44:08.293+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseReportById        : <==      Total: 1
2026-01-12T09:44:08.295+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:08.295+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3c66c6de]
2026-01-12T09:44:08.295+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=서명/도장 목록 조회 성공, data=[UserSignatureDto(signatureId=3, userId=2, si (truncated)...]
2026-01-12T09:44:08.296+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:08.296+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.297+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6734b021]
2026-01-12T09:44:08.297+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:08.298+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1871f3f9] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.299+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:08.300+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/users/me/signatures
2026-01-12T09:44:08.302+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@559861984 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:08.303+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=3, drafterId=2 (truncated)...]
2026-01-12T09:44:08.305+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : ==>  Preparing: SELECT expense_detail_id, expense_report_id, category, merchant_name, description, amount, actual_paid_amount, payment_method, payment_req_date, card_number, is_pre_approval, note, is_tax_deductible, non_deductible_reason, company_id FROM expense_detail_tb WHERE expense_report_id = ? AND company_id = ?
2026-01-12T09:44:08.305+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/users/me/signatures
2026-01-12T09:44:08.306+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:08.309+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:08.310+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/users/me/signatures
2026-01-12T09:44:08.311+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/users/me/signatures", parameters={}
2026-01-12T09:44:08.315+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#getMySignatures()
2026-01-12T09:44:08.316+09:00  INFO 21060 --- [http-nio-8080-exec-5] c.i.backend.controller.UserController    : 내 서명/도장 목록 조회 요청 - userId: 2, companyId: 1
2026-01-12T09:44:08.317+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectExpenseDetails           : <==      Total: 1
2026-01-12T09:44:08.317+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.317+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1871f3f9]
2026-01-12T09:44:08.318+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@220f32a2] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.318+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.319+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1913950864 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:08.319+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a379495] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.321+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1305369105 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:08.320+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.U.findByUserId                   : ==>  Preparing: SELECT * FROM user_signature_tb WHERE user_id = ? AND company_id = ? ORDER BY is_default DESC, created_at DESC
2026-01-12T09:44:08.321+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-12T09:44:08.322+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.U.findByUserId                   : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:08.323+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:08.325+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.U.findByUserId                   : <==      Total: 1
2026-01-12T09:44:08.325+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectApprovalLines            : <==      Total: 4
2026-01-12T09:44:08.325+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@220f32a2]
2026-01-12T09:44:08.326+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5a379495]
2026-01-12T09:44:08.326+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:08.327+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.327+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=서명/도장 목록 조회 성공, data=[UserSignatureDto(signatureId=3, userId=2, si (truncated)...]
2026-01-12T09:44:08.327+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4bfacad3] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@755989509 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:08.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:08.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseReportId : ==>  Preparing: SELECT r.*, u.korean_name AS uploadedByName FROM receipt_tb r JOIN user_tb u ON r.uploaded_by = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ? ORDER BY r.uploaded_at DESC
2026-01-12T09:44:08.329+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseReportId : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:08.332+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] .i.b.m.E.selectReceiptsByExpenseReportId : <==      Total: 0
2026-01-12T09:44:08.334+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4bfacad3]
2026-01-12T09:44:08.338+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.340+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a223920] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@395564773 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:08.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:08.343+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:08.345+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:08.345+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a223920]
2026-01-12T09:44:08.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:08.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=상세 조회 성공, data=ExpenseReportDto(expenseReportId=3, drafterId=2, re (truncated)...]
2026-01-12T09:44:08.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:08.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/3
2026-01-12T09:44:08.357+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/3
2026-01-12T09:44:08.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/3
2026-01-12T09:44:08.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/3", parameters={}
2026-01-12T09:44:08.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseDetail(Long)
2026-01-12T09:44:08.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@38a364a1] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@459203690 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:08.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseReportById        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ?
2026-01-12T09:44:08.368+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseReportById        : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:08.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseReportById        : <==      Total: 1
2026-01-12T09:44:08.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@38a364a1]
2026-01-12T09:44:08.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.376+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@12603476] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@826658039 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:08.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetails           : ==>  Preparing: SELECT expense_detail_id, expense_report_id, category, merchant_name, description, amount, actual_paid_amount, payment_method, payment_req_date, card_number, is_pre_approval, note, is_tax_deductible, non_deductible_reason, company_id FROM expense_detail_tb WHERE expense_report_id = ? AND company_id = ?
2026-01-12T09:44:08.378+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetails           : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:08.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectExpenseDetails           : <==      Total: 1
2026-01-12T09:44:08.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@12603476]
2026-01-12T09:44:08.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1b18ba55] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@139001540 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:08.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-12T09:44:08.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:08.383+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.m.E.selectApprovalLines            : <==      Total: 4
2026-01-12T09:44:08.384+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1b18ba55]
2026-01-12T09:44:08.384+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.384+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6ac46caa] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.388+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@886090165 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:08.388+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] .i.b.m.E.selectReceiptsByExpenseReportId : ==>  Preparing: SELECT r.*, u.korean_name AS uploadedByName FROM receipt_tb r JOIN user_tb u ON r.uploaded_by = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ? ORDER BY r.uploaded_at DESC
2026-01-12T09:44:08.389+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] .i.b.m.E.selectReceiptsByExpenseReportId : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:08.391+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] .i.b.m.E.selectReceiptsByExpenseReportId : <==      Total: 0
2026-01-12T09:44:08.391+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6ac46caa]
2026-01-12T09:44:08.391+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:08.391+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4124a6c6] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:08.391+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@139207540 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:08.392+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:08.392+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:08.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:08.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4124a6c6]
2026-01-12T09:44:08.395+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:08.396+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=상세 조회 성공, data=ExpenseReportDto(expenseReportId=3, drafterId=2, re (truncated)...]
2026-01-12T09:44:08.396+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:12.844+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /api/expenses/3/approve
2026-01-12T09:44:12.848+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing POST /api/expenses/3/approve
2026-01-12T09:44:12.850+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/3/approve
2026-01-12T09:44:12.850+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured POST /api/expenses/3/approve
2026-01-12T09:44:12.850+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : POST "/api/expenses/3/approve", parameters={}
2026-01-12T09:44:12.850+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#approveExpense(Long, ApprovalLineDto)
2026-01-12T09:44:12.856+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [ApprovalLineDto(approvalLineId=null, expenseReportId=null, approverId=2, stepOrder=null, status=null (truncated)...]
2026-01-12T09:44:12.927+09:00  INFO 21060 --- [http-nio-8080-exec-2] c.i.b.controller.ExpenseController       : 결재 승인 요청 - expenseId: 3, approverId: 2
2026-01-12T09:44:12.940+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:12.941+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c585b98]
2026-01-12T09:44:12.943+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@85255754 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will be managed by Spring
2026-01-12T09:44:12.943+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-12T09:44:12.944+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:12.946+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectApprovalLines            : <==      Total: 4
2026-01-12T09:44:12.947+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c585b98]
2026-01-12T09:44:12.948+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c585b98] from current transaction
2026-01-12T09:44:12.948+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.updateApprovalLine             : ==>  Preparing: UPDATE approval_line_tb SET status = 'APPROVED', signature_data = ?, approval_date = NOW() WHERE expense_report_id = ? AND approver_id = ? AND company_id = ?
2026-01-12T09:44:12.950+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.updateApprovalLine             : ==> Parameters: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAADICAYAAADFjnuPAAAQAElEQVR4AeydTchUZRvHD+/CRYiJihYl6ULFhbisLMqFtooWESEhrty0MOhDcpGrMFqkQS3auNIIknARrjKoKIRwFW0CiSxRUVJcuJCH4n39nd7r6Z7zzMwzH2fOnI9fdHl/f/2uc/5zzz3nmfnPwsLCfzUZeA14DXgN1O8a+E/mfxKQgAQkUEsCCnQt3eKkJCCBZQl0oIIC3QEnu0QJSKCZBBToZvrNWUtAAh0goEB3wMkusYsEXHMbCCjQbfCia5CABFpJQIFupVtdlAQk0AYCCnQbvOgaxiVgfQk0goAC3Qg3OUkJSKCLBBToLnrdNUtAAo0goEA3wk3VTtLRJCCBehBQoOvhB2chAQlIYAkBBXoJEjMkIAEJ1IOAAj2uH6wvAQlIoCICCnRFoB1GAhKQwLgEFOhxiVlfAhKQQEUEShboimbtMBKQgAQ6QECB7oCTXaIEJNBMAgp0M/3mrCUggZIJ1LE7BbqOXnFOEpCABO4TUKDvQ/B/CUhAAnUkoEDX0SvOSQJ1I+B85kJAgZ4LdgeVgAQksDwBBXp5RtaQgAQkMBcCCvRcsDtouwi4GgnMhoACPRuu9nqfwO+//56l9t133+XpCO9XydPUIY6lcdKDjHrYcuXUYTzs1KlTGUY8NeqEDerPfAnMg4ACPQ/qLRkTUXv33XczbO/evdmWLVuyFStWLBrp1KJOhNSNcuIYacLUyNu4ceNiv5SRhxFPLfIIwxgPO3jwYIYRTy3qEdIXIca6EHTW2RKXuYyGEVCgG+awqqeLOCFSCBuGcCFiGHFEDGNHSt0+85s6i35v3LgxUj/UHanikEr0gbGudM2slzQGE9Y8pBuLJDA1AQV6aoTt6yDECUHCQpAQJcpGXfFjjz2WV922bVtG/Nlnn80w4mGPPPJIRnnkE2JRHuHjjz+e1ztw4EDeF/n96pEfdYmPYvkkR/iHtcMAgwm78JTPCF1YRQJjEVCgx8LV3sqIDzvGdGdM3qAVI6xPPfVUhmAePXo0w06ePJmdP38+u3Tp0qItLCxkP//8c56mDEvLf/vtt7w88gmxtA7x77//Pq/HGKSxfvXIj7rERzHmmNZjDIy1IfCDGJAPoxDslB1lmgSmJaBAT0twyvbzao6wfPjhh9m+ffvys112ggj0oPk89NBDuQiHkCGs33zzTYaQIc4Ygpbuagf1Vcd8hDiMdWCsjfWGgJMmnzUOWgNc4QhPdtmIN3mD6psvgWEEFOhhdFpShkBgCAeiETu9t99+Ozt79mzfVSJWiBHCi0D98ccfuUCTj/Vt1OJM1gwPRDp27sTJo6y4dHgjzvBGrIM5cfIou3DhQrGZaQn0EFCge3C0K3HmzJn8qQVEAUOgEYZBq0RoEGSEh50jIelB9bucDyvEGUawwmC13O46Fe7du3fnT77gly6zdO2DCdRboAfP25IBBBAAbnh2bPv378+f+x1QNc9euXJlvjMOoUFkEJ680H9GJoBgwy521zAkb7kOwl/xArpcfcu7RUCBbom/udF567zcjY5oYCEmt2/fzgUaQWkJirkvA77xgsfOmji82V1jlBcnif94YV2zZk3+XHmx3HQ3CSjQDfc7N3Y87tXv+GLnzp25ALOz4ywZwcBCMBq+/NpPHzHmxQ/e+ACD/7fffpv7BcFOF3H37t1coHmh7efPtK7xWhMoZXIKdCkYq++ED5hCmIt/MIEoIAgI8sWLF/sKQfUzdsSUwK5du3K/INjssHl2Oy3nhZd3RFiab7xbBBTohvmbt8HsrviAqZ8wc7OzQ0OgG7a0zk6XHTbPbn/66af5H+GkINhFr1+/Pt9VI9ppmfH2E1CgG+BjbkyEmQ/+CEmn02bHzE4MYeZmT8uMN4fAyy+/nH399df5zjqd9Z07d3KB3rNnT/5UTlrW1LjzHo2AAj0ap7nU+uijj/LHsNgxI8zpJBDlw4cP53+hhzAXzzLTusabQwC/8u4HnxZfbHlhZkfN9dCcFTnTaQgo0NPQm1Fbji44X37rrbfyr+NMh0lv4GPHji15S5zWNd5cAviZ4yqOPYovvgg13+5H2NwVOvNRCCjQo1CqsA47ZcQZkU6HjV0VOyviaZnxlhFIlsOxRxxfpULNt/vxOYQincBqYVSBrolTudFeeuml/KwxndJzzz2X8TQGosyuKi0z3h0C+J4dNV9QFau+evVqfibNtRN5hu0ioEDXwJ/smjlX/PLLL3tmw87p3LlzPXkmuksAkeYLqgiDAu+0sEgbtouAAj0nf7LrQZjjyYx0GnyVJ+KcvqVNy7sdd/W8m0opnD59Ok0abxEBBbpiZyLM/PEBO2YEujj8hg0bMr7KU3EukjEdBHi6o7iL5rqKcsP2EFCgK/QlNxHCzKNSxWG54ThjvHLlSrHItASWEPAFfAmSVmYo0BW5NcS5OFwIM09nsDMqlo+ZtnpHCDzzzDM9K33vvfd60ibaQUCBrsCP/cR57dq1iz8PpTBX4ISWDVHcQf/9998tW6HLgYACDYUZGuLMn+imQ6xbty67fv16/gOqab5xCYxKgHdeaV2f5EhptCfeKYGeh9v4QBCRjrG5sa5duxZJQwlMTIBrKRpzjWGRNmwHAQV6hn7kw8DizoYPAmc4pF13iMCmTZt6Vnv58uWetInmE1CgZ+jD4vOpiHPx7HCGw9u1BCTQcAL/CnTDF1K36bNzxmJeCLMfBgYNwzIIpNdXGf3ZR/0IKNAz8sknn3zS0/M777zTkzYhgWkIFM+bOY9mEzBNn7atHwEFegY+4eY5e/bsYs/86bY3zyIOIyUQ8Ly5B2JrEwr0DFzLh4Npt6+88kqaNC6BqQl89dVXPX14fNaDozUJBXoGrky/Y4O3nnyx/gyGscsOE/jss896Vq9A9+BoTUKBLtmVHG+kXXrjpDSMl0GAZ+v5Lujo68UXXxz6yzpRz7B5BBTokn1WPN4ofmdCycPZXYcI8OKPOBevsVdffbVDFLq1VAW6ZH9zE6Vd+uFgSsP4OAS4ljguC+v3TYg+Wz8O0ebV7YRAc4FzcffbfZTtMm6q6JPz54gb1pRAzabF9cP1umrVqoxrlnhYcaqIs0doRSrtSndGoLnweWuISHPh7927N9u+fXu2efPmjDj5qZGHbd26Nb9RiKdGXW6cEydOZPRL//zhwC+//LJ4hezcuTMjL4w6YVEp0hGm+RE3bC+B8DvXEtclRvzevXsDF80Lv19POxBPqwo6IdDsNNKjBm4KRPPXX3/N+LCFOCKbGnkYz5tGfdJh1OVGOnLkSP7DndxYCDi/thxXCL8xSF7Yjh07crGnLj91hRFPjTyMPMKwhx9+ONu4cWPenv4oD6NOMR51CNO2UZcQS9uRDkvbRB3CKCeORZpxSBMOakv5ckZ7LOoRD+NFcd++fTlv2JMuGnUjjzhG+vnnn19kRzr6J6QORhwjnlrKnXzqYGk8OBCm6yeNURejHeMTX79+fT4n8lgP11lcOxFy3YaxW+an0BBnRDrqGLaXQCcEOr2wudjn5c5hu6Ll5nTr1q0M8ecm5kWCMIy2xXjUIUzbRl1CLG1HOuyfNjeyKI8wyotpxiGPcFBbypcz2mNRj3gYL4r8ARAhgkZYNOpGHnGMNM8N02ekiYeRhxXT5GEpd9JpvYgHF8J0/aQx2mHUZz7E79y5Q1GPIbz85iBCvLCwkH9nOHGsuNHoaWiilQQ6IdDhOS5+LnRugG3btkV2JSFjr169OuM3B3mRIF00JpLmUY8Xl7BiOvIjHFY+qIx8LPpIw2I+aYw6hBjxflYsI93Poi1lESfER2EIU9j777+fRTx8GfUIKSPE6AcjfujQoYw4RjqMdBh5ER81LM472qX5xPFtaviZ64FjMNowNuthd0y8X5u0vfFuEOiUQIdLuQHOnTuXEXIjhFHOjYORx42Dvfbaa3ld6ochBHFDsdPhxqIefWC0Jy+1mzdvZvzmYLRLy4hHP8Qx6jFOWDEd+REOKx9URj4WfaRhMZ80Rh1CjHg/K5aR7mfRlrKIEwZnQnwQ9sYbbywKLYwpT416kaYfjPTx48cXhZ10GOVh5EV81LA472iX5hPHt6nhX66Hixcv5vNibNbDtaNJIAh0UqBZPCLMTcHNE8YNxI2DkRc32wcffLBEoA8cOJD/Igr9RH8//fQT0UWjLGwx04gEJCCBEQl0VqBH5DNWNT5QjAb+gUqQMJSABCYloEBPSq5POz4A6pNtlgQkIIGJCMxMoCeaTYMbFcW53yf0DV6eU5eABOZAQIEuCTqPTaVd8el8mjYuAQlIYFwCCvS4xAbUL+6g/UR+ACizJVB7AvWZoAJdki/4w4noyic3goShBCQwDQEFehp6/29b3D3zLO7/iwwkIAEJTExAgZ4Y3b8Nf/zxx38T92N+QHgfgv+3lYDrqpCAAl0C7OJ3bPgBYQlQ7UICEsgU6BIuguIRhx8QlgDVLiQgAQXaa0ACZRKwLwmUScAddAk0izvoErq0CwlIQALuoMu4BooCzWN2ZfRrHxKQQLcJuIMuwf/plyQpzkOAWiQBCYxFQIEeC5eVJSABCVRHQIGujrUjSUACEhiLgAI9Fq7+ldPH6jiPxvrXHJZrmQQkIIFeAgp0L4+JUg8++OBE7WwkAQlIYBgBBXoYnRHLHn300Z6axa8e7Sk0IQEJSGBEAk0R6BGXM59qr7/+es/Ap0+fzjzm6EFiQgISmICAAj0BtH5N0sfr2EGfOnWqXzXzJCABCYxMQIEeGdXwiidPnuypwPdDX7hwoSfPhAQk0EECUyxZgZ4CXtqUJzmOHj2aZmW7d+/2qKOHiAkJSGAcAgr0OLSWqYtAv/DCCz21POrowWFCAhIYg4ACPQasUap+8cUXWXoezVGHHxiOQs463STgqocRUKCH0ZmwjPPoVKT37NnjUceELG0mgS4TUKBn4H3Oo9PfJWQH7VHHDEDbpQRaTkCBnpGDEeh0F+1Rx4xAt7vbSlfHRqLSAR1sWQIK9LKIJquAOBdF+sknn5ysM1tJoGQCZ86cydg07N27N8NWrFiRbdmyJbeSh7K7KQgo0FPAW64pT3Vw3BH1/vzzz/xmiLShBKogwM6YI7YQZMR4//79uUDzR1VYzIO6aTryDedDQIGeMXc+MGQnHcNw8XOjRNpwcgJltESQwugv4mmIz1KjLNJpnDzSgyzKB41Du2FltA9DcKkfRj67YvK5vrDYGW/fvj07ePDgoiAzxjDbtGnTsGLLKiSgQFcAm500Rx4xFDcRN1SkDcshEGKFOCFIGCIVb93ZOYatX78+27hxY/6WPi1HzCIdIX2kRn6k0zh5pAdZlDOHHTt29IwdbSgj3q+c9mGsjXph5LMrJp/1Y3GN/fXXXyMB5hplQ0E4UgMrzZyAAj1zxFn+XDQXfgyFkHAjEUae4XgEYMcLHUKEOK1atWpR8MijDEOkqIulI9y5cye7ceNGmpXHRxWzvPIU/9y7d29o6+XKhzYeUsiRGxuGxy55vgAAB6pJREFUQ4cOZVyTly5dyhYWFnIjnr7bG9KNRRURUKArAh03RgyHYMz0+egYqCUhvDDEF0Fm58iLHGlEeBxBY4e4du3abOfOnRmChG8w8levXp31+29YGfUpx6I98TDKsUgTUm/Dhg1ZjNuvPPIIMdphK1euJLms0TdifP78+VyAEWLi5B0/fjxfO/0t25EV5kZAga4QfYhBDIngPPHEE/4RSwC5H8IEQ3QRX0R4zZo1PbtjyrI+/yF4MMYQIQxBCmOHiEgRXr9+Pbt48WK+i0zLb968uShm1A2jTZQRD0vLyRulTtS7cuVKxtik6YcwLO2HMizKbt++nc8x0oRpP9TFyIMBQt0Hl1kNIKBAV+gkdiu8rUxvmFu3bmVPP/10Nkh0Kpxe5UMhxFgIceyM2R0TJ59jirt37y6ZGyzhiAAhRAgSggdfjHyMOmG0WdLRBBn0EzZB89KaxBwIWSNhaZ3bUS0IdFSg58eemwgBYbcXs+AsNAQp8toUIsIYgsuOmLX2OzMe9iIFr9gZI8ixawwRbhMv1yKBIKBAB4kKQ0T6888/zxCddFgEbPPmzfmz0sPEKm1TxzhzZy0Yu+Ew0uyIKR92ZgwfhBdDjNPdMXnsFuu4buckgbIJKNBlEx2xv127dmU//PBD/kFN2uTq1av5cQe7zBA2wq1bt+bnsOxAw958883F51sRPwwBxE6cOJERsnNFEImHxfOyxbJiG9oVjTZhlDEmxpx4ROyBBx7IX2DIw6ibri+Nr1u3Ll8/osu7ihBjdsfkYYpxSsx41wj0E+iuMZjbetOdYr9JIG5hly9fzj9MDJEl/Pjjj3MRRgjDEErsyJEjuXgj7og9eWHxvGyxrNiGdkWjTRhlMS7zYQ3DHlOL9SLGiPC1a9fyD+kQYo4vFGMIahL4l4AC/S+LucRCtBAsnk2dyyRmMCjrQnQR3+LOmHzKZzCsXUqgVQQU6Jq4E8Hi2VSEmh1m3XeTzI85E2IIMcb8OTMmZB3kUV4TzE6j7QRatj4FumYORfTYYcaukxA7fPhwhthRhhFnx40IIoYYcepipEMoiadGPhZ5ESfEIj9C+sNIU45FmhBjPhjzrxlSpyOBxhJQoGvuOnaf2LFjx3KBRoQxxJAdN2KNKGLEqYuRZmmERSMfi/yIE2KRHyH9YaQp1yQggWoIKNDVcHYUCdSAgFNoGgEFumkec74SkEBnCCjQnXG1C5WABJpGQIFumsec76wI2K8EakdAga6dS5yQBCQggX8IKND/cPBfCUhAArUjoEDXziX1nJCzkoAEqiegQFfP3BElIAEJjERAgR4Jk5UkIAEJVE9AgS6DuX1IQAISmAEBBXoGUO1SAhKQQBkEFOgyKNqHBCQggRkQqECgZzBru5SABCTQAQIKdAec7BIlIIFmElCgm+k3Zy0BCVRAYN5DKNDz9oDjS0ACEhhAQIEeAMZsCUhAAvMmoEDP2wOOL4GmEnDeMyegQM8csQNIQAISmIyAAj0ZN1tJQAISmDkBBXrmiB2gmwRctQSmJ6BAT8/QHiQgAQnMhIACPROsdioBCUhgegIK9PQM7WF8AraQgARGIKBAjwDJKhKQgATmQUCBngd1x5SABCQwAgEFegRIVVdxPAlIQAIQUKChoElAAhKoIQEFuoZOcUoSkIAEINA8gWbWmgQkIIEOEFCgO+BklygBCTSTgALdTL85awlIoHkExp6xAj02MhtIQAISqIaAAl0NZ0eRgAQkMDYBBXpsZDaQgARmQcA+lxJQoJcyMUcCEpBALQgo0LVwg5OQgAQksJSAAr2UiTkSqB8BZ9RJAgp0J93uoiUggSYQUKCb4CXnKAEJdJKAAt1Jt7dt0a5HAu0koEC306+uSgISaAEBBboFTnQJEpBAOwko0O30a7oq4xKQQEMJKNANdZzTloAE2k9AgW6/j12hBCTQUAKdF+iG+s1pS0ACHSCgQHfAyS5RAhJoJgEFupl+c9YSkEAHCAwX6A4AcIkSkIAE6kpAga6rZ5yXBCTQeQIKdOcvAQFIoJUEWrEoBboVbnQREpBAGwko0G30qmuSgARaQUCBboUbXYQExiNg7WYQUKCb4SdnKQEJdJCAAt1Bp7tkCUigGQQU6Gb4yVlWScCxJFATAgp0TRzhNCQgAQkUCSjQRSKmJSABCdSEgAJdE0c0ZxrOVAISqIqAAl0VaceRgAQkMCYBBXpMYFaXgAQkUBUBBbpc0vYmAQlIoDQCCnRpKO1IAhKQQLkEFOhyedqbBCQggdIIVCrQpc3ajiQgAQl0gIAC3QEnu0QJSKCZBBToZvrNWUtAApUSmM9gCvR8uDuqBCQggWUJKNDLIrKCBCQggfkQUKDnw91RJdAmAq5lRgQU6BmBtVsJSEAC0xJQoKclaHsJSEACMyKgQM8IrN1KIAgYSmBSAgr0pORsJwEJSGDGBBToGQO2ewlIQAKTElCgJyVnu3II2IsEJDCQgAI9EI0FEpCABOZLQIGeL39Hl4AEJDCQgAI9EE0dCpyDBCTQZQIKdJe979olIIFaE1Cga+0eJycBCXSZQJMFust+c+0SkEAHCCjQHXCyS5SABJpJQIFupt+ctQQk0GQCI85dgR4RlNUkIAEJVE3gfwAAAP//cMv4UwAAAAZJREFUAwBfTHvYGE/65QAAAABJRU5ErkJggg==(String), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:12.967+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.updateApprovalLine             : <==    Updates: 1
2026-01-12T09:44:12.967+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c585b98]
2026-01-12T09:44:12.971+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c585b98] from current transaction
2026-01-12T09:44:12.972+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-12T09:44:12.972+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:12.975+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectApprovalLines            : <==      Total: 4
2026-01-12T09:44:12.976+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c585b98]
2026-01-12T09:44:12.977+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c585b98]
2026-01-12T09:44:12.977+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c585b98]
2026-01-12T09:44:12.978+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1c585b98]
2026-01-12T09:44:12.988+09:00  INFO 21060 --- [http-nio-8080-exec-2] c.i.b.controller.ExpenseController       : 결재 승인 완료 - expenseId: 3
2026-01-12T09:44:12.991+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:12.991+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=결제 승인 완료, data=null)]
2026-01-12T09:44:12.994+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:12.998+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/3
2026-01-12T09:44:13.000+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/3
2026-01-12T09:44:13.001+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/3
2026-01-12T09:44:13.001+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/3", parameters={}
2026-01-12T09:44:13.009+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseDetail(Long)
2026-01-12T09:44:13.009+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:13.009+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@30a8fc30] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:13.013+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1040192280 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:13.015+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseReportById        : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ?
2026-01-12T09:44:13.015+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseReportById        : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:13.017+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseReportById        : <==      Total: 1
2026-01-12T09:44:13.024+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@30a8fc30]
2026-01-12T09:44:13.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:13.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@72b7e6cf] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:13.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1722356602 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:13.027+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseDetails           : ==>  Preparing: SELECT expense_detail_id, expense_report_id, category, merchant_name, description, amount, actual_paid_amount, payment_method, payment_req_date, card_number, is_pre_approval, note, is_tax_deductible, non_deductible_reason, company_id FROM expense_detail_tb WHERE expense_report_id = ? AND company_id = ?
2026-01-12T09:44:13.028+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseDetails           : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:13.030+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseDetails           : <==      Total: 1
2026-01-12T09:44:13.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@72b7e6cf]
2026-01-12T09:44:13.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:13.031+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13d40c84] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:13.032+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1578631599 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:13.032+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectApprovalLines            : ==>  Preparing: SELECT al.*, u.korean_name AS approverName, uc.position AS approverPosition FROM approval_line_tb al JOIN user_tb u ON al.approver_id = u.user_id JOIN user_company_tb uc ON al.approver_id = uc.user_id AND al.company_id = uc.company_id WHERE al.expense_report_id = ? AND al.company_id = ? ORDER BY al.step_order ASC
2026-01-12T09:44:13.033+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectApprovalLines            : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:13.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectApprovalLines            : <==      Total: 4
2026-01-12T09:44:13.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@13d40c84]
2026-01-12T09:44:13.044+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:13.045+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@520aadc5] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:13.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1636379436 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:13.046+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] .i.b.m.E.selectReceiptsByExpenseReportId : ==>  Preparing: SELECT r.*, u.korean_name AS uploadedByName FROM receipt_tb r JOIN user_tb u ON r.uploaded_by = u.user_id WHERE r.expense_report_id = ? AND r.company_id = ? ORDER BY r.uploaded_at DESC
2026-01-12T09:44:13.048+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] .i.b.m.E.selectReceiptsByExpenseReportId : ==> Parameters: 3(Long), 1(Long)
2026-01-12T09:44:13.049+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] .i.b.m.E.selectReceiptsByExpenseReportId : <==      Total: 0
2026-01-12T09:44:13.050+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@520aadc5]
2026-01-12T09:44:13.050+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:13.058+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@280fddad] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:13.059+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@804006380 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:13.059+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:13.060+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:13.062+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:13.062+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@280fddad]
2026-01-12T09:44:13.064+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:13.065+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=상세 조회 성공, data=ExpenseReportDto(expenseReportId=3, drafterId=2, re (truncated)...]
2026-01-12T09:44:13.066+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.171+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:44:15.171+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:15.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:44:15.173+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/my-approvals
2026-01-12T09:44:15.173+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=10
2026-01-12T09:44:15.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:15.177+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:44:15.178+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/my-approvals
2026-01-12T09:44:15.178+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:44:15.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:15.179+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:44:15.180+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/my-approvals
2026-01-12T09:44:15.180+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=10
2026-01-12T09:44:15.180+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:15.180+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:44:15.180+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/my-approvals", parameters={}
2026-01-12T09:44:15.180+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=10", parameters={masked}
2026-01-12T09:44:15.181+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:15.181+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.182+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMyApprovals()
2026-01-12T09:44:15.182+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:44:15.182+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.183+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.182+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f3893ad] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.182+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.183+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d3c3770] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.183+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71e627ed] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.183+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@da310cf] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.189+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@73327562 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:15.189+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2046273350 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:15.189+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@233006144 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:44:15.189+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@331042580 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:15.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] .i.b.m.E.selectMyApprovedReportsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status IN ('APPROVED', 'REJECTED') AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.190+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.191+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.193+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 2(Long)
2026-01-12T09:44:15.194+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] .i.b.m.E.selectMyApprovedReportsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:15.195+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:15.195+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.197+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:44:15.198+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] .i.b.m.E.selectMyApprovedReportsByUserId : <==      Total: 3
2026-01-12T09:44:15.199+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.199+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 1
2026-01-12T09:44:15.200+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7f3893ad]
2026-01-12T09:44:15.200+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5d3c3770]
2026-01-12T09:44:15.201+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@da310cf]
2026-01-12T09:44:15.203+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@71e627ed]
2026-01-12T09:44:15.204+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.204+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.205+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.205+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.205+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6fc7f889] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.206+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:44:15.206+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3748365e] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.206+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@37fe1a71] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.206+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@700507502 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:15.207+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.210+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@635205326 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:15.211+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@75733005 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:44:15.211+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.213+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.211+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:44:15.212+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.213+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.225+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.222+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:44:15.224+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.227+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:44:15.228+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:44:15.228+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.229+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:44:15.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6fc7f889]
2026-01-12T09:44:15.230+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@37fe1a71]
2026-01-12T09:44:15.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.231+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3748365e]
2026-01-12T09:44:15.232+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.232+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@589110c5] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.232+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4db3edd4] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=2, drafterId=2 (truncated)...]
2026-01-12T09:44:15.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@146979054 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:15.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@db219ed] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.234+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.234+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2076058819 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:15.236+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:15.238+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:15.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@376593634 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:15.233+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:15.242+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 12(Long), 8(Long), 3(Long)
2026-01-12T09:44:15.243+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 2(Long)
2026-01-12T09:44:15.247+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:15.249+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:15.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:15.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:15.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:15.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 3
2026-01-12T09:44:15.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:44:15.254+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4db3edd4]
2026-01-12T09:44:15.250+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.251+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@589110c5]
2026-01-12T09:44:15.256+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.256+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26486f89] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.256+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.256+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:44:15.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:15.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6badcc8] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@db219ed]
2026-01-12T09:44:15.257+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.258+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.258+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1459479522 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:15.258+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63ee5c7e] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.259+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.259+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2114866335 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:15.260+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.259+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.260+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.270+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/tax/revision-requests
2026-01-12T09:44:15.275+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/tax/revision-requests
2026-01-12T09:44:15.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/tax/revision-requests
2026-01-12T09:44:15.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/tax/revision-requests", parameters={}
2026-01-12T09:44:15.276+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getTaxRevisionRequestsForDrafter()
2026-01-12T09:44:15.277+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.277+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4c4d16b7] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@873821413 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@683383662 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:15.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] b.m.E.selectTaxRevisionRequestsByDrafter : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND r.drafter_id = ? AND r.tax_revision_requested = 1 ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.278+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6badcc8]
2026-01-12T09:44:15.279+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@63ee5c7e]
2026-01-12T09:44:15.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.279+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:15.279+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] b.m.E.selectTaxRevisionRequestsByDrafter : ==> Parameters: 1(Long), 2(Long)
2026-01-12T09:44:15.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.280+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=내 결재 문서 조회 성공, data=[ExpenseReportDto(expenseReportId=12, drafterI (truncated)...]
2026-01-12T09:44:15.281+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b9a77f9] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.281+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1241963864 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:15.282+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:15.283+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:15.302+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/my-approvals
2026-01-12T09:44:15.305+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/my-approvals
2026-01-12T09:44:15.307+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/my-approvals
2026-01-12T09:44:15.310+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/my-approvals", parameters={}
2026-01-12T09:44:15.312+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getMyApprovals()
2026-01-12T09:44:15.313+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.314+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78942fac] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.314+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2050441052 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:15.315+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] .i.b.m.E.selectMyApprovedReportsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status IN ('APPROVED', 'REJECTED') AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.316+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] .i.b.m.E.selectMyApprovedReportsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:15.321+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:15.321+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] b.m.E.selectTaxRevisionRequestsByDrafter : <==      Total: 0
2026-01-12T09:44:15.321+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 1
2026-01-12T09:44:15.322+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b9a77f9]
2026-01-12T09:44:15.322+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4c4d16b7]
2026-01-12T09:44:15.323+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26486f89]
2026-01-12T09:44:15.323+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.323+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.323+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.323+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55524cb1] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.324+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=세무 수정 요청 목록 조회 성공, data=[])]
2026-01-12T09:44:15.324+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43067a0a] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.325+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1577049181 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:15.325+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@999088450 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.325+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.325+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:15.326+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.328+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:15.329+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.336+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] .i.b.m.E.selectMyApprovedReportsByUserId : <==      Total: 3
2026-01-12T09:44:15.338+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@78942fac]
2026-01-12T09:44:15.341+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:15.342+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75f97c81] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.343+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@43067a0a]
2026-01-12T09:44:15.343+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@55524cb1]
2026-01-12T09:44:15.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@751420637 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:15.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.344+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.345+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.345+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=2, drafterId=2 (truncated)...]
2026-01-12T09:44:15.345+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6798012b] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.346+09:00 DEBUG 21060 --- [http-nio-8080-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.347+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@543747757 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:15.349+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:15.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.350+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.351+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@75f97c81]
2026-01-12T09:44:15.356+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:15.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:15.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@423e5c01] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.358+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:15.359+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2082291123 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:15.360+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:15.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:15.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6798012b]
2026-01-12T09:44:15.362+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.361+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.362+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 12(Long), 8(Long), 3(Long)
2026-01-12T09:44:15.362+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b54970a] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.362+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48667479] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.363+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2095207442 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:15.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:15.364+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 3
2026-01-12T09:44:15.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:15.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1902222996 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:44:15.365+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@423e5c01]
2026-01-12T09:44:15.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.366+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.367+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:15.367+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:15.367+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4f18403f] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.371+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b54970a]
2026-01-12T09:44:15.373+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.374+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e650094] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.372+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2138493833 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:15.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1366703765 wrapping com.mysql.cj.jdbc.ConnectionImpl@5681ad29] will not be managed by Spring
2026-01-12T09:44:15.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.377+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.379+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 1
2026-01-12T09:44:15.380+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@48667479]
2026-01-12T09:44:15.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4f18403f]
2026-01-12T09:44:15.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2e650094]
2026-01-12T09:44:15.381+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.382+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1463e8c3] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.383+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.383+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=내 결재 문서 조회 성공, data=[ExpenseReportDto(expenseReportId=12, drafterI (truncated)...]
2026-01-12T09:44:15.387+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@39982506 wrapping com.mysql.cj.jdbc.ConnectionImpl@4fd0eb52] will not be managed by Spring
2026-01-12T09:44:15.388+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:44:15.389+09:00 DEBUG 21060 --- [http-nio-8080-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.389+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.391+09:00 DEBUG 21060 --- [http-nio-8080-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.397+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.411+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses?page=1&size=10
2026-01-12T09:44:15.423+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.424+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses
2026-01-12T09:44:15.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1463e8c3]
2026-01-12T09:44:15.426+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses?page=1&size=10
2026-01-12T09:44:15.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses?page=1&size=10", parameters={masked}
2026-01-12T09:44:15.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=2, drafterId=2 (truncated)...]
2026-01-12T09:44:15.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getExpenseList(int, int, String, String, Long, Long, String[], String, Boolean, String, String, String)
2026-01-12T09:44:15.431+09:00 DEBUG 21060 --- [http-nio-8080-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.433+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.440+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6a25f84c] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1007788560 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:15.446+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.446+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.447+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:15.447+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:15.449+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:15.450+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.453+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:15.456+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6a25f84c]
2026-01-12T09:44:15.457+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.457+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.458+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50f16919] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.458+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@110e90de] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.459+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@357764307 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.459+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1726818357 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:15.459+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.460+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.460+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.461+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:15.463+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.465+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@50f16919]
2026-01-12T09:44:15.465+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 1
2026-01-12T09:44:15.465+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.466+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@110e90de]
2026-01-12T09:44:15.466+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3476cb17] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.467+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.468+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1872020769 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.468+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@393c007b] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.468+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:15.469+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1548877794 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:15.472+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:15.473+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.474+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.476+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@393c007b]
2026-01-12T09:44:15.477+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:15.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3476cb17]
2026-01-12T09:44:15.478+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=2, drafterId=2 (truncated)...]
2026-01-12T09:44:15.479+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.481+09:00 DEBUG 21060 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.481+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f9889ef] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.483+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@1572134776 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.485+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:15.490+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.491+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.491+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:15.492+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:15.493+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:15.493+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:15.494+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.494+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.495+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5f9889ef]
2026-01-12T09:44:15.495+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59692336] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.496+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.497+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@503551992 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:44:15.497+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15a11fe7] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.497+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.498+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@250424141 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:15.499+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:15.500+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:15.504+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:15.504+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 1
2026-01-12T09:44:15.505+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@15a11fe7]
2026-01-12T09:44:15.505+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@59692336]
2026-01-12T09:44:15.505+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.506+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.506+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6429b1ca] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.506+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35d26b42] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.507+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@2045432975 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.508+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@632458845 wrapping com.mysql.cj.jdbc.ConnectionImpl@2752a71f] will not be managed by Spring
2026-01-12T09:44:15.508+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseListWithFilters   : ==>  Preparing: SELECT r.*, u.korean_name AS drafterName, (SELECT MAX(al.approval_date) FROM approval_line_tb al WHERE al.expense_report_id = r.expense_report_id AND al.status = 'APPROVED' AND al.company_id = r.company_id) AS finalApprovalDate, (SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL) AS minPaymentReqDate, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id WHERE r.company_id = ? AND u.korean_name LIKE CONCAT('%', ?, '%') ORDER BY COALESCE((SELECT MIN(d.payment_req_date) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.payment_req_date IS NOT NULL), r.payment_req_date, r.report_date) DESC, r.expense_report_id DESC LIMIT ? OFFSET ?
2026-01-12T09:44:15.508+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.511+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.510+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseListWithFilters   : ==> Parameters: 1(Long), test_user1(String), 2147483647(Integer), 0(Integer)
2026-01-12T09:44:15.555+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseListWithFilters   : <==      Total: 13
2026-01-12T09:44:15.556+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.565+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6429b1ca]
2026-01-12T09:44:15.565+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@35d26b42]
2026-01-12T09:44:15.565+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.570+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.571+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@208a604e] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.571+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=2, drafterId=2 (truncated)...]
2026-01-12T09:44:15.573+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@159654516 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.573+09:00 DEBUG 21060 --- [http-nio-8080-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.577+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.579+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.586+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.590+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@208a604e]
2026-01-12T09:44:15.593+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.594+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@696d4dc8] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.595+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@446093499 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.596+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseDetailsBatch      : ==>  Preparing: SELECT * FROM expense_detail_tb WHERE company_id = ? AND expense_report_id IN ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) ORDER BY expense_report_id, expense_detail_id
2026-01-12T09:44:15.597+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseDetailsBatch      : ==> Parameters: 1(Long), 38(Long), 33(Long), 32(Long), 31(Long), 27(Long), 26(Long), 24(Long), 8(Long), 7(Long), 6(Long), 3(Long), 2(Long), 1(Long)
2026-01-12T09:44:15.600+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.m.E.selectExpenseDetailsBatch      : <==      Total: 13
2026-01-12T09:44:15.606+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@696d4dc8]
2026-01-12T09:44:15.607+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.608+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a4f5fc4] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.609+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@961500744 wrapping com.mysql.cj.jdbc.ConnectionImpl@190b878b] will not be managed by Spring
2026-01-12T09:44:15.620+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.622+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.626+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.627+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3a4f5fc4]
2026-01-12T09:44:15.628+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.628+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=목록 조회 성공, data=PagedResponse(content=[ExpenseReportDto(expenseRepo (truncated)...]
2026-01-12T09:44:15.629+09:00 DEBUG 21060 --- [http-nio-8080-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.763+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:15.764+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:15.764+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:15.765+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:15.765+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:15.765+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.766+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cc31dc2] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.766+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@785158851 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:15.766+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.767+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:15.770+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 1
2026-01-12T09:44:15.771+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7cc31dc2]
2026-01-12T09:44:15.771+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.772+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4c7aa6fd] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.775+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@682856381 wrapping com.mysql.cj.jdbc.ConnectionImpl@4b2dd96c] will not be managed by Spring
2026-01-12T09:44:15.775+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.775+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.777+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.778+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4c7aa6fd]
2026-01-12T09:44:15.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.779+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=2, drafterId=2 (truncated)...]
2026-01-12T09:44:15.780+09:00 DEBUG 21060 --- [http-nio-8080-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:15.781+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing GET /api/expenses/pending-approvals
2026-01-12T09:44:15.783+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/expenses/pending-approvals
2026-01-12T09:44:15.788+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured GET /api/expenses/pending-approvals
2026-01-12T09:44:15.790+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : GET "/api/expenses/pending-approvals", parameters={}
2026-01-12T09:44:15.791+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.ExpenseController#getPendingApprovals()
2026-01-12T09:44:15.791+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.793+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@53423dc5] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.794+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@55502841 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:15.794+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==>  Preparing: SELECT DISTINCT r.*, u.korean_name AS drafterName, (SELECT d.description FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '' ORDER BY d.expense_detail_id ASC LIMIT 1) AS firstDescription, (SELECT COUNT(*) FROM expense_detail_tb d WHERE d.expense_report_id = r.expense_report_id AND d.company_id = r.company_id AND d.description IS NOT NULL AND TRIM(d.description) != '') AS descriptionCount FROM expense_report_tb r JOIN user_tb u ON r.drafter_id = u.user_id JOIN approval_line_tb al ON r.expense_report_id = al.expense_report_id WHERE al.approver_id = ? AND al.status = 'WAIT' AND r.status != 'REJECTED' AND r.company_id = ? ORDER BY r.expense_report_id DESC
2026-01-12T09:44:15.795+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : ==> Parameters: 2(Long), 1(Long)
2026-01-12T09:44:15.798+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.m.E.selectPendingApprovalsByUserId : <==      Total: 1
2026-01-12T09:44:15.799+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@53423dc5]
2026-01-12T09:44:15.800+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Creating a new SqlSession
2026-01-12T09:44:15.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5832d824] was not registered for synchronization because synchronization is not active
2026-01-12T09:44:15.801+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.m.s.t.SpringManagedTransaction         : JDBC Connection [HikariProxyConnection@442268402 wrapping com.mysql.cj.jdbc.ConnectionImpl@6b97d56] will not be managed by Spring
2026-01-12T09:44:15.802+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==>  Preparing: SELECT * FROM user_tb WHERE user_id = ?
2026-01-12T09:44:15.804+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : ==> Parameters: 2(Long)
2026-01-12T09:44:15.812+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] c.i.b.mapper.UserMapper.selectUserById   : <==      Total: 1
2026-01-12T09:44:15.813+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] org.mybatis.spring.SqlSessionUtils       : Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5832d824]
2026-01-12T09:44:15.814+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:15.814+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=미서명 건 조회 성공, data=[ExpenseReportDto(expenseReportId=2, drafterId=2 (truncated)...]
2026-01-12T09:44:15.815+09:00 DEBUG 21060 --- [http-nio-8080-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2026-01-12T09:44:18.415+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing POST /api/logout
2026-01-12T09:44:18.420+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] c.i.b.security.JwtAuthenticationFilter   : JWT 인증 성공 - userId: 2, role: USER, companyId: 1, uri: /api/logout
2026-01-12T09:44:18.425+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Secured POST /api/logout
2026-01-12T09:44:18.427+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : POST "/api/logout", parameters={}
2026-01-12T09:44:18.429+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.innersignature.backend.controller.UserController#logout(String, RefreshTokenRequest)
2026-01-12T09:44:18.430+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [UserController.RefreshTokenRequest(refreshToken=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIyIiwidXNlcm5hbWUiOiJ (truncated)...]
2026-01-12T09:44:18.432+09:00  INFO 21060 --- [http-nio-8080-exec-7] SECURITY                                 : LOGOUT userId=2
2026-01-12T09:44:18.432+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json, application/yaml]
2026-01-12T09:44:18.433+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] m.m.a.RequestResponseBodyMethodProcessor : Writing [ApiResponse(success=true, message=로그아웃되었습니다., data=null)]
2026-01-12T09:44:18.443+09:00 DEBUG 21060 --- [http-nio-8080-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
