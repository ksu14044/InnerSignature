<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.innersignature.backend.mapper.SubscriptionPlanMapper">
    <resultMap id="SubscriptionPlanResultMap" type="com.innersignature.backend.dto.SubscriptionPlanDto">
        <id property="planId" column="plan_id"/>
        <result property="planCode" column="plan_code"/>
        <result property="planName" column="plan_name"/>
        <result property="price" column="price"/>
        <result property="maxUsers" column="max_users"/>
        <result property="featuresJson" column="features"/>
        <result property="isActive" column="is_active"/>
        <result property="createdAt" column="created_at"/>
        <result property="updatedAt" column="updated_at"/>
    </resultMap>

    <select id="findAllActive" resultMap="SubscriptionPlanResultMap">
        SELECT * FROM subscription_plan_tb
        WHERE is_active = 1
        ORDER BY price ASC
    </select>

    <select id="findById" resultMap="SubscriptionPlanResultMap">
        SELECT * FROM subscription_plan_tb
        WHERE plan_id = #{planId}
        LIMIT 1
    </select>

    <select id="findByCode" resultMap="SubscriptionPlanResultMap">
        SELECT * FROM subscription_plan_tb
        WHERE plan_code = #{planCode}
        AND is_active = 1
        LIMIT 1
    </select>
</mapper>
